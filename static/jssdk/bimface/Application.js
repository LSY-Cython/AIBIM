"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var n=[],a=!0,i=!1,o=void 0;try{for(var l,r=e[Symbol.iterator]();!(a=(l=r.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){i=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();!function(){var e=window.Glodon=window.Glodon||{};e.Version="2021-4-29-15-48",function(){function t(e,t){for(var n=t.split("."),a=e,i=n.length,o=0;o<i;o++)void 0===a[n[o]]&&(a[n[o]]={}),a=a[n[o]];return a}t(e,"Web.Lang.Utility.Namespace").ensureNamespace=t}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Common"),n=function(e){"string"==typeof e&&(e=JSON.parse(res)),this.code=e.code,this.message=e.message};n.prototype={getErrorCode:function(){return this.code},getErrorMessage:function(){return this.message}},t.Error=n}();var t=function(){function e(t,n,a){_classCallCheck(this,e),this.x=t||0,this.y=n||0,this.z=a||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a}}]),e}(),n=function(){function e(n,a){_classCallCheck(this,e),this.min=n||new t(1/0,1/0,1/0),this.max=a||new t(-1/0,-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new t(this.max.x-this.min.x,this.max.y-this.min.y,this.max.z-this.min.z)}},{key:"setFromCenterAndSize",value:function(e,n){var a=new t(n.x,n.y).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}},{key:"getCenter",value:function(){return new t(this.min.x+this.max.x,this.min.y+this.max.y,this.min.z+this.max.z).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}}]),e}();!function(){var a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Algorithm"),i=function(){function e(t,n){_classCallCheck(this,e),this.points=t,this.searchRangeSquared=Math.pow(n,2),this.EPSILON_SQR=.1,this.clusters=[],this._clusterId=1}return _createClass(e,[{key:"setSearchRange",value:function(e){this.searchRangeSquared=Math.pow(e,2)}},{key:"setPoints",value:function(e){this.points=e}},{key:"meanShift",value:function(e){for(var t=e.clone(),n=[];;){var a=this.rangeSearch(t);this.connect(n,a);var i=this.mean(a);if(t.distanceToSquared(i)<=this.EPSILON_SQR)break;t=i}return n}},{key:"mean",value:function(e){var n=new t,a=!0,i=!1,o=void 0;try{for(var l,r=e[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var s=l.value;n.add(s)}}catch(e){i=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}return n.multiplyScalar(1/e.length),n}},{key:"rangeSearch",value:function(e){var t=[],n=!0,a=!1,i=void 0;try{for(var o,l=this.points[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var r=o.value;e.distanceToSquared(r)<=this.searchRangeSquared&&t.push(r)}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t}},{key:"clustering",value:function(e,t){var n=this;if(this.tmpPoints=this.points,this.clusters.length>0){1===this.clusters.length&&1===this.clusters[0].parents.length&&(this._clusterId=1),this.points=[];var a=[].concat(_toConsumableArray(this.clusters));this.clusters=[];for(var i=0;i<a.length;i++){var o=a[i],l=[];t?this.points=o.points:(this.resetClusterPoints(o.points),this.points=o.points);var r=[],s=0;e?(s=++this._clusterId,r=o.parents):(s=o.parents.pop(),void 0===s&&(s=0),r=o.parents);var c=!0,d=!1,f=void 0;try{for(var u,m=o.points[Symbol.iterator]();!(c=(u=m.next()).done);c=!0){var p=u.value;if(!p.stopMoving){var g=this.meanShift(p);e?this.mergeClustersInTarget({points:g,center:this.mean(g),id:s,parents:[].concat(_toConsumableArray(r))},l):this.mergeClusters({points:g,center:this.mean(g),id:s,parents:[].concat(_toConsumableArray(r))})}}}catch(e){d=!0,f=e}finally{try{!c&&m.return&&m.return()}finally{if(d)throw f}}e&&this.clusters.push.apply(this.clusters,l)}}else{var h=!0,b=!1,v=void 0;try{for(var y,C=this.points[Symbol.iterator]();!(h=(y=C.next()).done);h=!0){var B=y.value;if(!B.stopMoving){var w=this.meanShift(B),L=++this._clusterId,M=[0];M.push(L),this.mergeClusters({points:w,center:this.mean(w),id:this._clusterId++,parents:M})}}}catch(e){b=!0,v=e}finally{try{!h&&C.return&&C.return()}finally{if(b)throw v}}}this.clusters.forEach(function(e){n.resetPointStatus(e.points)})}},{key:"mergeClusters",value:function(e){var t=!1,n=!0,a=!1,i=void 0;try{for(var o,l=this.clusters[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var r=o.value,s=e.center.distanceToSquared(r.center)<=4*this.searchRangeSquared,c=JSON.stringify(r.parents)===JSON.stringify(e.parents);if(s&&c){this.connect(r.points,e.points,!0),r.center=this.mean(r.points),this.updateClusterBbox(r),t=!0;break}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}!1===t&&(this.updateClusterBbox(e),this.clusters.push(e))}},{key:"mergeClustersInTarget",value:function(e,t){var n=!1,a=!0,i=!1,o=void 0;try{for(var l,r=t[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var s=l.value;if(e.center.distanceToSquared(s.center)<=4*this.searchRangeSquared){this.removeNodeFromParents(e.id,s.parents),this.connect(s.points,e.points,!0),s.center=this.mean(s.points),this.updateClusterBbox(s),n=!0;break}}}catch(e){i=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}!1===n&&(this.updateClusterBbox(e),e.id=++this._clusterId,e.parents.push(e.id),t.push(e))}},{key:"removeNodeFromParents",value:function(e,t){var n=t.indexOf(e);n>=0&&t.splince(n,1)}},{key:"updateClusterBbox",value:function(e){var t=(new n).setFromPoints(e.points);e.bbox=t}},{key:"connect",value:function(e,t,n){var a=!0,i=!1,o=void 0;try{for(var l,r=t[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var s=l.value;s.stopMoving&&!n||e.push(s),s.stopMoving=!0}}catch(e){i=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}return e}},{key:"resetPointStatus",value:function(e){var t=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){i.value.stopMoving=!1}}catch(e){n=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}}},{key:"resetClusterPoints",value:function(e){for(var t=0;t<e.length;t++)for(var n=0;n<this.tmpPoints.length;n++)if(e[t].index===this.tmpPoints[n].index){e[t]=this.tmpPoints[n];break}}}]),e}();a.MeanShift=i}();var a=function(){function e(t,n){_classCallCheck(this,e),this.x=t||0,this.y=n||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"normalize",value:function(){return this.multiplyScalar(1/this.length())}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),a=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*a+e.x,this.y=i*a+o*n+e.y,this}},{key:"setLength",value:function(e){return this.multiplyScalar(e/this.length())}},{key:"angle",value:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}}]),e}(),i=function(){function e(t,n){_classCallCheck(this,e),this.min=t||new a(1/0,1/0),this.max=n||new a(-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new a(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"setFromCenterAndSize",value:function(e,t){var n=new a(t.x,t.y).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"getCenter",value:function(){return new a(this.min.x+this.max.x,this.min.y+this.max.y).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}}]),e}();!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Algorithm"),n=function e(){_classCallCheck(this,e)};n.toThreeJsBox2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],o=!0,l=!1,r=void 0;try{for(var s,c=e[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var d=s.value,f=Math.min(t,100)/100,u=Math.max(d[1][1]-d[0][1],d[1][0]-d[0][0]),m=u*f,p=new a(d[0][0],d[0][1]),g=new a(d[1][0],d[1][1]),h=new i(p,g),b=h.getSize();n.push((new i).setFromCenterAndSize(h.getCenter(),b.addScalar(2*m)))}}catch(e){l=!0,r=e}finally{try{!o&&c.return&&c.return()}finally{if(l)throw r}}var v=0,y=!0,C=!1,B=void 0;try{for(var w,L=n[Symbol.iterator]();!(y=(w=L.next()).done);y=!0){w.value.indices=[v++]}}catch(e){C=!0,B=e}finally{try{!y&&L.return&&L.return()}finally{if(C)throw B}}return n},n.toDrawingBox2=function(e){var t=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var r=o.value,s=[];s.push([r.min.x,r.min.y]),s.push([r.max.x,r.max.y]),t.push(s)}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t},n.merge=function(e,t){for(var n=e.length,a=0;a<=n;a++){if(a===n){e.push(t);break}var i=e[a];if(i.intersectsBox(t)){i.union(t),i.indices=i.indices.concat(t.indices);break}}},n.mergeBoundingBox=function(e){for(var t=e,a=[];;){for(var i=0;i<t.length;i++)n.merge(a,t[i]);if(a.length===t.length)break;t=a.slice(0,a.length),a=[]}return a},t.BoundingBoxUtil=n}(),function(){function t(e){function t(){}return t.prototype=e,new t}function n(e,n){var a=t(n.prototype);a.constructor=e,e.prototype=a}e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Type").inheritPrototype=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.HttpRequest"),n=function(e,t){var n={type:"get",cache:!0,headers:{"Content-type":"application/x-www-form-urlencoded"},data:null,async:!0,success:null,failure:null},a=Object.assign(n,e),i=function(e){a.success&&a.success(e.responseText,e.responseXML)},o=function(e){a.failure&&a.failure(e)},l=function(e,t){var n;n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n.onreadystatechange=function(){if(4==n.readyState){var a=n.status;if(a>=200&&a<300||304==a){var i=n,o=i.responseText,l=i.responseXML;e({responseText:o,responseXML:l})}else t(a)}},n.open(a.type,a.url,a.async);for(var i in a.headers)n.setRequestHeader(i,a.headers[i]);n.send(a.data)},r=function(){return new Promise(l)};t?CLOUD.Storage.IndexedDBHelper.loadWithStorage("InfoData",a.url,r,i,o):l(i,o)},a=function(e,t,n){var a={};if(a[e])t&&t();else{var i=document.createElement("script");i.type="text/javascript",i.src=e,document.head.appendChild(i),a[e]=!0,i.readyState?i.onreadystatechange=function(){"loaded"==i.readyState||"complete"==i.readyState?(i.onreadystatechange=null,t&&t()):"uninitialized"==i.readyState&&(i.onreadystatechange=null,n&&n())}:(i.onload=function(){t&&t()},i.onerror=function(){n&&n()})}},i=function e(t,n){t.length>1?a(t.shift(),function(){e(t,n)}):a(t.shift(),n)},o=function(e,t,a){var i=void 0;return i="string"==typeof e?{url:e,status:t}:e,new Promise(function(e,o){n(Object.assign({},i,{success:function(n){try{var a=JSON.parse(n)}catch(t){return e(n)}"success"==a.code||"noCode"==i.status?e("noCode"==t?a:a.data):o("requestError，dataCode:"+a.code+", dataMessage:"+a.message)},failure:function(e){o(e)}}),a)})};t.ajax=n,t.promiseJSONRequest=o,t.getScript=a,t.getScripts=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.FullScreen"),n=function(e){if(!e)return!1;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},a=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},i=function(){return document.webkitIsFullScreen||!!document.mozFullScreenElement||!!document.msFullScreenElement||!1},o=function(e){var t=function(){e&&e()};document.onfullscreenchange=t,document.onwebkitfullscreenchange=t,document.documentElement.onwebkitfullscreenchange=t,document.onmozfullscreenchange=t,document.onmsfullscreenchange=t};t.fullScreen=n,t.exitFullScreen=a,t.onFullScreenChanged=o,t.isFullScreen=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.ClientHelper"),n=null;if(!t.getIsDesktop){var a=function(){if("Mobile"===n)return!1;if("Web"===n)return!0;var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),a=/(?:SymbianOS)/.test(e)||t,i=/(?:Android)/.test(e),o=/(?:Firefox)/.test(e),l=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||i&&!/(?:Mobile)/.test(e)||o&&/(?:Tablet)/.test(e));return!(/(?:iPhone)/.test(e)&&!l||i||a||l)},i=function(e){n=e},o=function(){return/(?:iPhone)/.test(navigator.userAgent)},l=function(e){var t=function(e){return e.replace("viewToken.json","").replace(/\.\//g,"/").replace(/\/\//g,"/")};if(e.indexOf("://")>-1){var n=e.split("://");e=n[0]+"://"+t(n[1])}else e="//"===e.slice(0,2)?"//"+t(e.slice(2)):"./"!=e.slice(0,2)?t(e):"."+t(e.slice(1));return e},r=function(e,t,n){n=n||"asc";var a=!1;return t?t.indexOf(".")>-1&&(a=!0):t="name",e=e.sort(function(e,i){if(a){var o=f(e,t),l=f(i,t);return"asc"==n?o.localeCompare(l):l.localeCompare(o)}return"asc"==n?e[t].localeCompare(i[t]):i[t].localeCompare(e[t])}),d(e,t,a)},s=function(e,t,n){n=n||"asc";var a=!1;return t?t.indexOf(".")>-1&&(a=!0):t="name",e=e.sort(c(t,a)),d(e,t,a)},c=function(e,t){return function(n,a){function i(e,t,n){if(n){for(r=t;(n=i(e,r))<76&&n>65;)++r;return+e.slice(t-1,r)}return n=m&&m.indexOf(e.charAt(t)),n>-1?n+76:(n=e.charCodeAt(t)||0)<45||n>127?n:n<46?65:n<48?n-1:n<58?n+18:n<65?n-11:n<91?n+11:n<97?n-37:n<123?n+5:n-63}var o,l;t?(o=f(n,e),l=f(a,e)):(o=n[e],l=a[e]);var r,s,c=1,d=0,u=0,m=String.alphabet;if((o+="")!=(l+=""))for(;c;)if(s=i(o,d++),c=i(l,u++),s<76&&c<76&&s>66&&c>66&&(s=i(o,d,d),c=i(l,u,d=r),u=r),s!=c)return s<c?-1:1;return 0}},d=function(e,t,n){var a=[],i=[],o=[],l=[];return e.map(function(e,r){var s;s=n?f(e,t):e[t],/^[a-zA-Z]*$/.test(s.slice(0,1))?a.push(e):/^[\u4e00-\u9fa5]*$/.test(s.slice(0,1))?i.push(e):/^\d+(\.\d+)?$/.test(s.slice(0,1))?o.push(e):l.push(e)}),l.concat(o,a,i)},f=function(e,t){var n=t.split("."),a=e;return n.map(function(e,t){a=a[e]}),a},u=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},m=function(e,t,n,a,i,o){var l=void 0,r=void 0,s=void 0,c=void 0,d=0,f=Math.sqrt((n-e)*(n-e)+(a-t)*(a-t));if(0===f)return[0,{x:n,y:a}];var u=Math.sqrt((i-e)*(i-e)+(o-t)*(o-t));if(0===u)return[0,{x:i,y:o}];var m=Math.sqrt((n-i)*(n-i)+(a-o)*(a-o));if(0===m)return d=f,[d,{x:n,y:a}];if(f<u){if(a===o?l=n<i?0:Math.PI:(c=(i-n)/m,c-1>1e-5&&(c=1),l=Math.acos(c),a>o&&(l=2*Math.PI-l)),c=(e-n)/f,c-1>1e-5&&(c=1),r=Math.acos(c),a>t&&(r=2*Math.PI-r),s=r-l,s<0&&(s=-s),s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2)return[f,{x:n,y:a}];if(n===i)return[u*Math.sin(s),{x:n,y:t}];if(a===o)return[u*Math.sin(s),{x:e,y:a}];var p=0,g=0,h=(o-a)/i-n,b=-1/h,v=t-e*b;return p=(o-i*h-v)/(b-h),g=b*p+v,[f*Math.sin(s),{x:p,y:g}]}if(a===o?l=n<i?Math.PI:0:(c=(n-i)/m,c-1>1e-5&&(c=1),l=Math.acos(c),o>a&&(l=2*Math.PI-l)),c=(e-i)/u,c-1>1e-5&&(c=1),r=Math.acos(c),o>t&&(r=2*Math.PI-r),s=r-l,s<0&&(s=-s),s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2)return[u,{x:i,y:o}];if(n===i)return[u*Math.sin(s),{x:n,y:t}];if(a===o)return[u*Math.sin(s),{x:e,y:a}];var y=0,C=0,B=(o-a)/i-n,w=-1/B,L=t-e*w;return y=(o-i*B-L)/(w-B),C=w*y+L,[u*Math.sin(s),{x:y,y:C}]},p=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},g=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}};t.getIsDesktop=a,t.setNavigatorType=i,t.getIsIphone=o,t.getIsIE=u,t.formatURL=l,t.sortByName=r,t.sortByRules=s,t.PointToLineDistance=m,t.isWebGLAvailable=p,t.isWebGL2Available=g}}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.MouseMotion"),n=function(t){function n(){a&&"walk"==t.getViewer().getEditorManager().editor.name||(i.addClass("motion-zoom"),o=Date.now(),setTimeout(function(){Date.now()-o>180&&i.removeClass("motion-zoom")},200))}var a=!1,i=t.getDomElement(),o=void 0,l=!1,r=!1,s=null;e.Bimface.Viewer.Viewer3D&&t instanceof e.Bimface.Viewer.Viewer3D&&(a=!0),i.addEventListener("keydown",function(e){17==event.keyCode&&(l=!0)}),i.addEventListener("keyup",function(e){17==event.keyCode&&(l=!1)}),i.addEventListener("mousedown",function(e){t._opt.enableZoomRect||l||(s={x:e.clientX,y:e.clientY})}),i.addEventListener("mousemove",function(e){if(s&&!r&&!(Math.abs(s.x-e.clientX)<2&&Math.abs(s.y-e.clientY)<2)){if(a){var n=t.getUseLeftHandedInput();if("walk"==t.getViewer().getEditorManager().editor.name)1==e.buttons&&i.addClass("motion-rotate");else{var o=t._getIsCursorEnabled();1==e.buttons?o&&i.addClass(n?"motion-rotate":"motion-translate"):i.addClass(n?"motion-translate":"motion-rotate")}}else 1==e.buttons&&i.addClass("motion-translate");r=!0}}),i.addEventListener("mousewheel",n,!1),i.addEventListener("DOMMouseScroll",n,!1),i.addEventListener("mouseup",function(e){s=!1,r=!1,i.removeClass("motion-translate"),i.removeClass("motion-rotate")})};t.setCursor=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e,t){var n=document.createElement(e);return n.setAttribute("class",t),n};t.create=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);return n.setAttribute("class",t),n};t.createNS=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e){return e.indexof("#")?document.getElementById(e.replace("#","")):e.indexof(".")?document.getElementsByClassName(e.replace(".","")):document.getElementsByTagName(e)};t.select=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(t){var n=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),a={element:null,handle:null,axis:"all",cursor:"move",distance:0,start:null,move:null,stop:null,bBoxDetection:!1},i=Object.assign(a,t),o=i.element;if(!o)return!1;var l=i.handle||o,r=void 0,s=!1,c=this,d=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(i.distance,2)&&(i.start&&i.start(r),!0)},f=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e};this.resize=function(e,t,n){t=t||{x:0,y:0};var a=e.getBoundingClientRect(),o=e.parentElement.getBoundingClientRect(),l=a.left-o.left,r=a.top-o.top,s=e.offsetWidth,c=e.offsetHeight,d=e.parentElement.offsetWidth,f=e.parentElement.offsetHeight,u=Math.min(l+t.x,d-s),m=Math.min(r+t.y,f-c),p=l+t.x<0?0:u>0&&u||0,g=r+t.y<0?0:m>0&&m||0;n&&0!=p&&0!=g||(e.style.left=p+"px",e.style.top=g+"px",e.style.transform="none",i.record&&i.record(p,g))};var u=function(e){var t=o.getBoundingClientRect(),n=o.parentElement.getBoundingClientRect(),a=t.left-n.left,l=t.top-n.top;if(i.bBoxDetection)c.resize(o,e);else{var r=a+e.x,s=l+e.y;switch(i.axis){case"x":o.style.left=r+"px";break;case"y":o.style.top=s+"px";break;case"all":default:o.style.left=r+"px",o.style.top=s+"px"}}},m=function(e){var t=e;if(n){if(!f(t.button))return;r={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",p)}else r={x:t.touches[0].clientX,y:t.touches[0].clientY},l.addEventListener("touchmove",p);i.start&&i.start(r)},p=function(e){var t=e;if(n)var a={x:t.clientX,y:t.clientY};else var a={x:t.touches[0].clientX,y:t.touches[0].clientY};var o={x:a.x-r.x,y:a.y-r.y};s?(i.move&&i.move(r,a,o),r=a,u(o)):s=d(o),e.preventDefault(),e.stopPropagation()},g=function(){s&&i.end&&i.end(r),s=!1,document.removeEventListener("mousemove",p),l.removeEventListener("touchmove",p)};n?(l.style.cursor=i.cursor,l.style.userSelect="none",l.addEventListener("mousedown",m),document.addEventListener("mouseup",g)):(l.addEventListener("touchend",g),l.addEventListener("touchstart",m))};t.drag=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e){var n={element:null,axis:"all",minWidth:100,minHeight:100,distance:0,start:null,sizable:null,stop:null},a=Object.assign(n,e),i=a.element;if(!i)return!1;var o,l,r=void 0,s=!1,c=t.create("div","bf-resize"),d=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(a.distance,2)&&(a.start&&a.start(r),!0)},f=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e},u=function(e){var t=i.offsetLeft,n=i.offsetTop,r=o+e.x<a.minWidth?a.minWidth:o+e.x,s=l+e.y<a.minHeight?a.minHeight:l+e.y;switch(a.resize&&a.resize(r,s),i.style.left=t+"px",i.style.top=n+"px",a.axis){case"x":i.style.width=r+"px";break;case"y":i.style.height=s+"px";break;case"all":default:i.style.width=r+"px",i.style.height=s+"px"}},m=function(e){o=i.clientWidth,l=i.clientHeight;var t=e;f(t.button)&&(r={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",p),document.addEventListener("touchmove",p))},p=function(e){var t=e,n={x:t.clientX,y:t.clientY},i={x:n.x-r.x,y:n.y-r.y};s?(a.sizable&&a.sizable(r,n,i),u(i)):s=d(i)},g=function(){s&&a.end&&a.end(r),s=!1,document.removeEventListener("mousemove",p),document.removeEventListener("touchmove",p)};i.addClass("bf-sizable"),i.appendChild(c),c.addEventListener("mousedown",m),c.addEventListener("touchstart",m),document.addEventListener("mouseup",g),document.addEventListener("touchend",g)};t.sizable=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e){var n=this,a={element:null,min:0,max:100,cur:50,step:1,isShowProgress:!0,input:null,change:null,currentColor:"#11dab7",defaultColor:"#999"},i=Object.assign(a,e);this._opt=i;var o=t.create("div","bf-range"),l=t.create("input","bf-input-range");n.input=l,l.setAttribute("type","range"),l.setAttribute("step",i.step),l.setAttribute("min",i.min),l.setAttribute("max",i.max),l.setAttribute("value",i.cur);var r=t.create("span","bf-range-min");r.innerText=i.min;var s=t.create("span","bf-range-cur");n.cur=s,s.innerText=i.cur;var c=t.create("span","bf-range-max");c.innerText=i.max;var d=t.create("span","bf-range-progress");o.appendChild(l),i.isShowProgress&&(o.appendChild(r),o.appendChild(s),o.appendChild(c)),o.appendChild(d),i.element.appendChild(o),n.setProgress(i.cur),l.addEventListener("input",function(){n.setProgress(this.value),i.input&&i.input(this.value)}),l.addEventListener("change",function(){n.setProgress(this.value),i.change&&i.change(this.value)})};n.prototype.setProgress=function(e){var t=this._opt,n=t.max-t.min,a=this.input,i=this.cur,o=(e-t.min)/n*100;a.value=e,a.style.background="linear-gradient(to right,"+t.currentColor+" 0%,"+t.currentColor+"  "+o+"%,"+t.defaultColor+" "+o+"%, "+t.defaultColor+" 100%)",i.innerText=e},n.prototype.reset=function(){this.setProgress(this._opt.cur)},t.range=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=function(e){var t={element:null,min:0,max:100,from:null,to:null,step:1,currentColor:"#11dab7",defaultColor:"#999",change:null};this._opt=Object.assign(t,e),this._opt.from=this._opt.from||this._opt.min,this._opt.to=this._opt.to||this._opt.max,this.init()};n.prototype={init:function(){var e=t.create("div","bf-multiple-range"),n=t.create("div","bf-range-track"),a=t.create("span","bf-slider bf-slider-min");a.id="minSlider",a.type="minimum";var i=t.create("span","bf-slider bf-slider-max");i.id="maxSlider",i.type="maximum",this._state={from:this._opt.from,to:this._opt.to},n.style.backgroundColor=this._opt.currentColor,e.style.backgroundColor=this._opt.defaultColor,e.appendChild(n),e.appendChild(a),e.appendChild(i),this._opt.element.appendChild(e),this._track=n,this._sliders={min:a,max:i},this._element=e,this.bindEvent(),this.update(!1)},bindEvent:function(){var e,t,n=this,a=!1,i=function(n){var n=n||event;t=n.screenX,e=this,a=!0},o=function(i){if(a){var i=i||event,o=i.screenX-t,l=Math.round(o/n._pix/n._opt.step)*n._opt.step;0!=l&&(t=l*n._pix+t,"minimum"==e.type?n._state.from+=l:n._state.to+=l,n.recalculate(e),n.update(!0))}},l=function(){e=null,a=!1};this._sliders.min.addEventListener("mousedown",i),this._sliders.max.addEventListener("mousedown",i),document.addEventListener("mousemove",o),document.addEventListener("mouseup",l)},update:function(e){var t=this._sliders.min.offsetWidth,n=this._sliders.max.offsetWidth;if(!this._pix){var a=this._element.offsetWidth,i=this._opt.max-this._opt.min,o=(a-t-n)/i;this._pix=o}var l=(this._state.from-this._opt.min)*this._pix,r=(this._state.to-this._opt.min)*this._pix+t+n;this._track.style.left=l+t/2+"px",this._track.style.width=r-l-t/2-n/2+"px",this._sliders.min.style.left=l+"px",this._sliders.max.style.left=r+"px",this._opt.change&&e&&this._opt.change(this._state)},recalculate:function(e){this._state.to>=this._opt.max&&(this._state.to=this._opt.max),this._state.from<=this._opt.min&&(this._state.from=this._opt.min),e&&("maximum"==e.type&&this._state.to<=this._state.from&&(this._state.to=this._state.from),"minimum"==e.type&&this._state.from>=this._state.to&&(this._state.from=this._state.to))},getProgress:function(){return this._state},setProgress:function(e){this._state=e,this.recalculate(),this.update(!1)}},t.multipleRange=n}(),function(){var e=function(e){var t,n;this.addEventListener("touchstart",function(e){t=Date.now()}),this.addEventListener("touchend",function(a){(n=Date.now())-t<200&&e(a)})};HTMLElement.prototype.tap=e}(),function(){(window.ActiveXObject||"ActiveXObject"in window)&&(HTMLElement.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)},window.Element&&function(e){e.matches=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.msMatchesSelector||function(e){for(var t=this,n=(t.parentNode||t.document).querySelectorAll(e),a=-1;n[++a]&&n[a]!=t;);return!!n[a]}}(Element.prototype),window.Element&&function(e){e.closest=e.closest||function(e){for(var t=this;t.matches&&!t.matches(e);)t=t.parentNode;return t.matches?t:null}}(Element.prototype))}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.UUID"),n=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")};t.createUUID=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),n=function(e,t){var n=null,a=Date.now();return void 0==t&&(t=30),function(){var i=Date.now(),o=t-(i-a),l=this,r=arguments;clearTimeout(n),o<=0?(e.apply(l,r),a=Date.now()):n=setTimeout(e,o)}};t.throttle=n}();var o=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility");o.DataUtil={assertType:function(e,t){var n=function(t){return Object.prototype.toString.call(e)==="[object "+t+"]"};switch(t){case"obj":case"Obj":case"object":case"Object":return n("Object");case"arr":case"Arr":case"array":case"Array":return n("Array");case"num":case"Num":case"number":case"Number":return n("Number");case"func":case"Func":case"function":case"Function":return n("Function");case"str":case"Str":case"string":case"String":return n("String");default:return n(t)}},assertParamsType:function(){for(var e=this,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];if(n.length>1){var i=n.splice(n.length-1,1),o=_slicedToArray(i,1),l=o[0],r=!0;return n.every(function(t){return r=e.assertType(t,l)}),r}},hasProperty:function(e,t){return!!this.assertType(e,"obj")&&e.hasOwnProperty(t)},hasProperties:function(e){for(var t=this,n=arguments.length,a=Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];if(!a)return!1;var o=!0;return a.every(function(n){return o=t.hasProperty(e,n)}),o},hasChildProperty:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(!n||0===n.length)return!1;for(var i=e,o=0;o<n.length;o++){var l=n[o];if(!this.hasProperty(i,l))return!1;i=i[l]}return!0},getChildProperty:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(this.hasChildProperty.apply(this,[e].concat(_toConsumableArray(n)))){var i=e;return n.forEach(function(e){return i=i[e]}),i}}},o.DataUtil,function(){e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Utils").Transformation={getTranslation:function(e){var t=this._getDecompose(e);return{x:t.position.x,y:t.position.y,z:t.position.z}},getQuaternion:function(e){var t=this._getDecompose(e);return{x:t.quaternion._x,y:t.quaternion._y,z:t.quaternion._z,w:t.quaternion._w}},getScaling:function(e){var t=this._getDecompose(e);return{x:t.scale.x,y:t.scale.y,z:t.scale.z}},quaternionToEulerAngles:function(e,t){var n=new THREE.Euler,a=new THREE.Quaternion(e.x,e.y,e.z,e.w),i=n.setFromQuaternion(a,t||"XYZ");return{x:i._x,y:i._y,z:i._z,
order:i._order}},eulerAnglesToQuaternion:function(e){var t=new THREE.Quaternion,n=new THREE.Euler(e.x,e.y,e.z,e.order),a=t.setFromEuler(n);return{x:a._x,y:a._y,z:a._z,w:a._w}},_getDecompose:function(e){var t=new THREE.Matrix4,n=new THREE.Vector3,a=new THREE.Quaternion,i=new THREE.Vector3;return t.fromArray(e),t.decompose(n,a,i),{position:n,quaternion:a,scale:i}}}}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang"),n=function(){this.container={}};n.prototype.addEvent=function(e,t){return"string"==typeof e&&"function"==typeof t&&(void 0===this.container[e]?this.container[e]=[t]:this.container[e].push(t)),this},n.prototype.fireEvent=function(e){if(e&&this.container[e]){var t=Array.prototype.slice.call(arguments);t.shift();for(var n=[].concat(_toConsumableArray(this.container[e])),a=n.length,i=0;i<a;i++){n[i].apply(null,t)}}return this},n.prototype.removeEvent=function(e,t){if("function"==typeof t&&"string"==typeof e){var n=this.container[e];if(n instanceof Array){for(var a=0,i=n.length;a<i;a+=1)if(n[a]===t){n.splice(a,1);break}0==n.length&&delete this.container[e]}return this}},t.EventManager=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Geometry"),n=function(e,t,n){this.x=e,this.y=t,this.z=n};n.prototype={get:function(){return{x:this.x,y:this.y,z:this.z}},set:function(e,t,n){this.x=e,this.y=t,this.z=n}},t.Point3d=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Geometry"),n=function(e,n){var a={},i=new t.Point3d,o=new t.Point3d;return i.set(e.x,e.y,e.z),o.set(n.x,n.y,n.z),a.min=i,a.max=o,a};t.BoundingBox=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Graphics.Utility"),n=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t};t.RGBToHex=n}();var l=window.hostConfig||{APIHost:"https://api.bimface.com",resourceHost:"https://m.bimface.com",staticHost:"https://static.bimface.com",dataEnvType:"BIMFACE"};!function(){function t(e,t){function n(e){return"FloorPlan"==e||"CeilingPlan"==e}if("DrawingSheet"!=t.viewType)return null;var a=t.viewInfo,i=a.preview.width,o=a.preview.height,l=a.outline[0],r=a.outline[2],s=a.outline[1],c=a.outline[3],d=r-l,f=c-s;a=t;for(var u=a.portsAndViews,m=0;m<u.length;m++){var p=u[m];if(n(p.viewType)){var g=function(t,n,a,r,c){var u=e.x/i,m=(o-e.y)/o;if("Elevation"==c.viewType){m=(i-e.x)/i,u=e.y/o;var p=c.viewPoint.viewDirection;1!=Math.round(p[0])&&-1!=Math.round(p[1])||(u=(o-e.y)/o)}var g=(t-l)/d,h=(n-l)/d;if(u<g||u>h)return null;var b=(a-s)/f,v=(r-s)/f;if(m<b||m>v)return null;var y=(u-g)/(h-g),C=(m-b)/(v-b),B=((c.outline[2]-c.outline[0])*y+c.outline[0])*c.viewPoint.scale,w=((c.outline[3]-c.outline[1])*C+c.outline[1])*c.viewPoint.scale;return new THREE.Vector3(B,w,0)}(p.viewport[0],p.viewport[3],p.viewport[1],p.viewport[4],p);if(null!=g){if(n(p.viewType))null!==g&&(g.z=p.elevation);else if("Elevation"==p.viewType){var h=p.viewPoint.viewDirection,b=p.cropBox;0!=Math.round(h[0])?null!==g&&(g.z=g.y,g.y=g.x,g.x=h[0]<0?b[3]:b[0]):0!=Math.round(h[1])&&null!==g&&(g.z=g.y,g.y=h[1]<0?b[4]:b[1])}return g}}}return null}function n(e,t,n){if("DrawingSheet"!=t.viewType)return!1;var a=t.preview.width,i=t.preview.height,o=t.outline[0],l=t.outline[2],r=t.outline[1],s=t.outline[3],c=t.portsAndViews;for(var d in c){var f=c[d];if("FloorPlan"===f.viewType){var u=f.viewPoint.scale,m=f.outline[0]*u,p=f.outline[2]*u,g=f.outline[1]*u,h=f.outline[3]*u;if(!(e.x<m||e.x>p||e.y<g||e.y>h)){var b=(e.x-m)/(p-m),v=(e.y-g)/(h-g),y=f.viewport[3]-f.viewport[0],C=f.viewport[4]-f.viewport[1];n(a*((f.viewport[0]+y*b-o)/(l-o)),i-i*((f.viewport[1]+C*v-r)/(s-r)),f)}}}return!0}var a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Graphics.Utility.Relation"),i=function(t,n,a){e.Web.Lang.Utility.HttpRequest.ajax({url:l.resourceHost+"/"+t+"/metadata/views.json",success:function(e){var i=JSON.parse(e).viewList,e=[];for(var o in i){var r=i[o];r.viewType==n&&(r.preview.path=l.resourceHost+"/"+t+"/"+r.preview.path,e.push(r))}a&&a(e)}})},o=function(t,n,a){e.Web.Lang.Utility.HttpRequest.ajax({url:l.resourceHost+"/"+t+"/metadata/drawings.json",success:function(e){for(var t=JSON.parse(e).drawingList,i=0;i<t.length;i++){var o=t[i];if(o.viewInfo.id==n){a&&a(o);break}}}})},r=function(n,a){if("DrawingSheet"==a.viewType)return t(n,a);if("FloorPlan"!=a.viewType)return console.warn("Not support yet!"),null;var i=a.preview.width,o=a.preview.height,l=a.outline[0],r=a.outline[2],s=a.outline[1],c=a.outline[3],d=r-l,f=c-s,u=(0-l)/d,m=c/f,p=(n.x-i*u)/i,g=(o*m-n.y)/o;return p=p*d*a.viewPoint.scale,g=g*f*a.viewPoint.scale,new e.Web.Geometry.Point3d(p,g,a.elevation)},s=function(e,t){var a=[];if(n(e,t,function(e,t,n){a.append({x:e,y:t})}))return 0==a.length?null:a;if("FloorPlan"!=t.viewType)return console.warn("Not support yet!"),null;var i=t.preview.width,o=t.preview.height,l=t.outline[0],r=t.outline[2],s=t.outline[1],c=t.outline[3],d=r-l,f=c-s,u=(0-l)/(r-l),m=c/(c-s),p=e.x/(d*t.viewPoint.scale),g=e.y/(f*t.viewPoint.scale);return p=p*i+i*u,g=o*m-g*o,{x:p,y:g,z:0}};a.getViews=i,a.getDrawingSheets=o,a.point2DToPoint3D=r,a.point3DToPoint2D=s}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Graphics.Utility"),n=function(e){var t=new Image;return new Promise(function(n,a){t.onload=function(){n(t)},t.onerror=function(e){a(e)},t.crossOrigin="anonymous",t.src=e,!0===t.complete&&n(t)})};t.ImageContainer=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Graphics"),n=e.Web.Graphics.Utility.RGBToHex,a=function(e,t,n,a){this.red=e,this.green=t,this.blue=n,this.alpha=a},i=function(e,t){/^#[0-9a-fA-F]{6}$/.test(e)&&(this.red=parseInt(e.slice(1,3),16),this.green=parseInt(e.slice(3,5),16),this.blue=parseInt(e.slice(5),16)),"number"==typeof t?(t>1&&(t=1),t<0&&(t=0),this.alpha=t):this.alpha=1},o=function(){arguments.length<4?i.apply(this,arguments):a.apply(this,arguments)};o.prototype={getRGB:function(){return"rgba("+this.red+","+this.green+","+this.blue+")"},getRGBA:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},getHEX:function(){return""+n(this.red)+n(this.green)+n(this.blue)},getAlpha:function(){return this.alpha},fromObject:function(e){return this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha,this}},t.Color=o}(),function(){SVGElement.prototype.getClass=HTMLElement.prototype.getClass=function(e){return this.getAttribute("class")},SVGElement.prototype.hasClass=HTMLElement.prototype.hasClass=function(e){var t=this.getClass();return!!t&&(t&&t.split(" ")).indexOf(e)>-1},SVGElement.prototype.addClass=HTMLElement.prototype.addClass=function(e){var t=this.getClass(),n=t&&t.split(" ");return t?-1==n.indexOf(e)&&(n.push(e),t=n.join(" "),this.setAttribute("class",""+t)):this.setAttribute("class",""+e),this},SVGElement.prototype.removeClass=HTMLElement.prototype.removeClass=function(e){if(!this.hasClass(e))return this;var t=this.getClass().replace(e,"").trim();return t?this.setAttribute("class",""+t):this.removeAttribute("class"),this},SVGElement.prototype.toggleClass=HTMLElement.prototype.toggleClass=function(e,t){var n=(this.getClass(),this.hasClass(e));return void 0!=t?(t&&!n&&this.addClass(e),t||this.removeClass(e)):n?this.removeClass(e):this.addClass(e),!n}}(),function(){Array.prototype.getObjectByAttribute=function(e,t){for(var n=this,a=n.length,i=0;i<a;i++)if(n[i][e]==t)return n[i];return!1},Array.prototype.removeObjectByAttribute=function(e,t){for(var n=this,a=n.length,i=0;i<a;i++)if(n[i][e]==t)return n=n.splice(i,1);return!1},Array.prototype.getAllObjectByAttribute=function(e,t){for(var n=this,a=n.length,i=0,o=[];i<a;i++)n[i][e]==t&&o.push(n[i]);return o},Array.prototype.removeByValue=function(e){for(var t=this,n=t.length,a=n-1;a>=0;a--)t[a]==e&&t.splice(a,1);return t},Array.prototype.insert=function(e,t){return this.splice(e,0,t),this}}(),function(){SVGElement.prototype.setCss=HTMLElement.prototype.setCss=function(e){if(e)for(var t in e)this.style[t]=e[t]},SVGElement.prototype.getCss=HTMLElement.prototype.getCss=function(){return this.style}}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Data"),n=(e.Web.Lang.Utility.HttpRequest,null),a={getInstance:function(){return null==n&&(n={},n.sendingPeriod=6e4,n.requestList=[],n.isEnabled=!0,n.modelType="",n.modelId="",n.handleId=null,n.send=function(e,t,a){if(n.isEnabled){var i={functionName:e+"."+t},o=Object.assign(i,a);this.requestList.push(o)}},n.intervalAction=function(){if(n.isEnabled){var e=n.requestList,t=e.length;if(t>0){var a=e.slice(0,t);n._send(a),e.splice(0,t)}}},n.handleId=setInterval(n.intervalAction,n.sendingPeriod),n._send=function(e){var t=BimfaceLoaderConfig.APIHost+"/inside/track?ModelType="+this.modelType+"&ModelId="+this.modelId,n={Events:e},a={"Content-Type":"application/json"};fetch(t,{method:"PUT",mode:"cors",body:JSON.stringify(n),headers:a,cache:"default"}).then(function(e){})},n.setIsEnabled=function(e){n.isEnabled=!0===e,n.isEnabled&&null===n.handleId?n.handleId=setInterval(n.intervalAction,n.sendingPeriod):n.isEnabled||null===n.handleId||(clearInterval(n.handleId),n.handleId=null)},n.getIsEnabled=function(){return n.isEnabled}),n}};t.StatisticsDataManager=a}(),function(e){function t(){l||(l=!0,i())}
var n,a,i,o,l,r,s='<svg><symbol id="gld-bf-third-person-lg" viewBox="0 0 1024 1024"><path d="M592 32a112 112 0 0 1 78.336 192.032L676.032 224c78.656 0 125.312 55.264 132.48 137.28l23.424 211.168 0.064 6.24c-3.168 37.184-26.24 61.728-63.84 61.728-12.032 0-22.4-2.56-31.104-7.168l-0.864 278.4A79.424 79.424 0 0 1 655.936 992c-28.096 0-50.336-11.456-64.096-30.08-14.4 18.752-37.184 30.08-63.872 30.08-45.216 0-79.04-33.856-79.04-78.72l-0.064-280.64a65.248 65.248 0 0 1-32.352 7.872c-37.728 0-64.512-27.36-64.512-63.68l0.256-3.936 25.632-206.656C387.2 279.36 427.552 224 505.44 224l8.192 0.032A112 112 0 0 1 592 32z m84.032 224h-170.592c-64.48 0-89.056 51.392-95.712 113.632L384 576.832c0 18.016 11.84 31.68 32.512 31.68 20.608 0 29.696-13.024 31.68-31.872l32.576-194.496 0.16 531.104c0 27.072 19.328 46.752 47.04 46.752 27.68 0 48-18.592 48.416-48.096L575.936 640h32l0.448 271.808c0 27.072 15.68 48.192 47.552 48.192 27.712 0 48.288-21.28 48.288-48.352l1.6-529.504 30.72 194.08c2.592 19.264 10.976 32.192 31.616 32.192s30.208-11.776 31.968-32.448l-23.424-211.136C771.296 302.912 740.448 256 676.032 256zM384 864v32H96v-32h288z m512 0v32h-96v-32h96zM288 544v32H192v-32h96z m304-480a80 80 0 1 0 0 159.968A80 80 0 0 0 592 64z"  ></path></symbol><symbol id="gld-bf-reverse-lg" viewBox="0 0 1024 1024"><path d="M128 128h192v32H160v160H128V128z m0 736h192v-32H160v-160H128v192zM864 128h-192v32h160v160h32V128z m0 736h-192v-32h160v-160h32v192zM566.016 332.48l19.968-24.96L768 448H256v-32h420.768zM457.984 659.52l-19.968 24.96L256 544h512v32H347.232z"  ></path></symbol><symbol id="gld-bf-section-plane-pick" viewBox="0 0 1024 1024"><path d="M512 416l336 208-112 64 96 160-96 64-96-160-128 80V416z m32 57.44v300.832l106.688-66.688 95.456 159.136 42.688-28.448-97.088-161.824 93.632-53.568L544 473.44z"  ></path><path d="M640 96v288h-32V156.384L288 362.016V781.76l128-82.272v38.88l-160 103.776V345.056L640 96z"  ></path></symbol><symbol id="gld-bf-split-drawings" viewBox="0 0 1024 1024"><path d="M896 384v448H320V384h576z m-160 32H352v384h384V416z m128 192h-96v192h96v-192zM736 224v96h-32V256H192v384h64v32H160V224h576z m128 288h-96v64h96v-64z m0-96h-96v64h96v-64z"  ></path></symbol><symbol id="gld-bf-export" viewBox="0 0 1024 1024"><path d="M384 64v64H128v768h768v-256h64v320H64V64h320z m576 0v384h-64V173.184l-480 480.064-45.248-45.248L850.56 128H576V64h384z"  ></path></symbol><symbol id="gld-bf-arrowup" viewBox="0 0 1024 1024"><path d="M937.642667 707.157333L511.317333 281.173333 450.730667 341.333333 85.333333 707.072l60.16 60.330667L511.317333 401.92l365.994667 365.482667z"  ></path></symbol><symbol id="gld-bf-arrowdown" viewBox="0 0 1024 1024"><path d="M937.642667 316.842667L511.317333 742.826667 450.730667 682.666667 85.333333 316.928l60.16-60.330667L511.317333 622.08l365.994667-365.482667z"  ></path></symbol><symbol id="gld-bf-search" viewBox="0 0 1024 1024"><path d="M447.99808 128c75.328 0 148.544 26.688 206.144 75.2a318.976 318.976 0 0 1 98.944 341.568 318.72 318.72 0 0 1-304.896 223.36c-32.64 0-65.216-5.056-96.768-15.04a319.04 319.04 0 0 1-222.144-277.632 319.04 319.04 0 0 1 171.456-311.552c45.504-23.552 96-35.84 147.264-35.904z m0-128A447.872 447.872 0 0 0 1.72608 486.4 448 448 0 1 0 447.99808 0z"  ></path><path d="M750.27008 843.008l90.496-90.496 180.992 180.992L931.26208 1024z"  ></path></symbol><symbol id="gld-bf-translation" viewBox="0 0 1056 1024"><path d="M512 576v160h96l-112 128-112-128h96v-160h32z m224-192l128 112-128 112v-96.032L576 512v-32l160-0.032V384zM256 384v96h160v32H256v96l-128-112L256 384z m240-256L608 256h-96v160h-32V256h-96l112-128z" fill="#000000" ></path></symbol><symbol id="gld-bf-rotation" viewBox="0 0 1056 1024"><path d="M480 192h32v352h-32V192z m0 544h32v128h-32v-128zM672 500L832 480l-14.176 160z" fill="#000000" ></path><path d="M482.976 655.968c-184.384 0-336-83.392-336-192 0-97.344 122.24-175.36 282.944-189.664l9.888-0.8 2.304 31.904c-150.976 10.912-263.136 80.704-263.136 158.56 0 85.76 134.944 160 304 160 64.096 0 125.184-10.688 176.384-30.208 46.08-17.6 82.208-41.6 104.032-68.8l4.48-5.92 26.016 18.624c-25.248 35.328-68.288 65.088-123.136 85.984-54.944 20.96-119.872 32.32-187.776 32.32z" fill="#000000" ></path></symbol><symbol id="gld-bf-scaling" viewBox="0 0 1056 1024"><path d="M480 544v320H160V544h320z m-32 32H192v256h256v-256zM836.672 164.672l22.656 22.656-224 224-22.656-22.656zM160 480h32V192h352V160H160zM544 832h288V480h32v384H544z" fill="#000000" ></path><path d="M672 160h192v192h-32V192h-160z" fill="#000000" ></path></symbol><symbol id="gld-bf-room-height" viewBox="0 0 1024 1024"><path d="M896 768v32H96v-32h800zM496 256l112 128h-96v256h96l-112 128-112-128h96v-256h-96l112-128zM896 224v32H96V224h800z"  ></path></symbol><symbol id="gld-bf-next" viewBox="0 0 1024 1024"><path d="M404.64 692.704l169.28-169.44-169.28-169.408 22.656-22.592 169.28 169.28 0.064-0.032 22.624 22.72-192 192.128z"  ></path></symbol><symbol id="gld-bf-previous" viewBox="0 0 1024 1024"><path d="M619.264 692.704l-169.28-169.44 169.28-169.408-22.656-22.592-169.28 169.28-0.064-0.032-22.624 22.72 192 192.128z"  ></path></symbol><symbol id="gld-bf-drag" viewBox="0 0 1024 1024"><path d="M608 192a64 64 0 0 1 63.84 59.2L672 256v192h-32V256a32 32 0 0 0-63.776-3.744L576 256h-32a64 64 0 0 1 64-64zM416 192a64 64 0 0 1 63.84 59.2L480 256v192h-32V256a32 32 0 0 0-63.776-3.744L384 256v192h-32V256a64 64 0 0 1 64-64z"  ></path><path d="M320 384a64 64 0 0 1 63.84 59.2L384 448v160h-32v-160a32 32 0 0 0-63.776-3.744L288 448v160H256v-160a64 64 0 0 1 64-64zM704 272a64 64 0 0 1 63.84 59.2l0.16 4.8V608h-32v-272a32 32 0 0 0-63.776-3.744L672 336h-32a64 64 0 0 1 64-64zM512 864a256 256 0 0 0 255.872-248L768 608h-32a224 224 0 0 1-447.872 7.68L288 608H256a256 256 0 0 0 256 256zM512 128a64 64 0 0 1 63.84 59.2L576 192v256h-32V192a32 32 0 0 0-63.776-3.744L480 192v80h-32V192a64 64 0 0 1 64-64z"  ></path></symbol><symbol id="gld-bf-zoom-out" viewBox="0 0 1024 1024"><path d="M480 160a288 288 0 1 0 0 576 288 288 0 0 0 0-576z m0 32a256 256 0 1 1 0 512 256 256 0 0 1 0-512z"  ></path><path d="M640 416H320v64h320z"  ></path><path d="M651.328 660.672l-22.656 22.656 176 176 22.656-22.656z"  ></path></symbol><symbol id="gld-bf-zoom-in" viewBox="0 0 1024 1024"><path d="M480 160a288 288 0 1 0 0 576 288 288 0 0 0 0-576z m0 32a256 256 0 1 1 0 512 256 256 0 0 1 0-512z"  ></path><path d="M640 416H320v64h320z"  ></path><path d="M448 288v320h64V288z"  ></path><path d="M651.328 660.672l-22.656 22.656 176 176 22.656-22.656z"  ></path></symbol><symbol id="gld-bf-full-screen" viewBox="0 0 1024 1024"><path d="M608 192v32h169.6l-227.2 227.2 22.4 22.4L800 246.4V416h32V192h-224z m-156.8 358.4L224 777.6V608H192v224h224v-32H246.4l227.2-227.2-22.4-22.4z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-measure-settings" viewBox="0 0 1024 1024"><path d="M607.744 193.28a318.208 318.208 0 0 1 116.8 65.76c9.728 8.544 12.16 22.656 5.888 33.92-6.048 10.88-9.184 23.136-9.152 35.552a74.752 74.752 0 0 0 74.88 74.432 27.84 27.84 0 0 1 27.488 21.28 316.096 316.096 0 0 1 1.696 136.768 27.68 27.68 0 0 1-24.32 21.856l-4.832 0.128a74.816 74.816 0 0 0-65.408 38.08 73.92 73.92 0 0 0 1.664 75.296 27.584 27.584 0 0 1-4.8 35.04 318.4 318.4 0 0 1-115.584 67.2 27.744 27.744 0 0 1-33.44-13.664A75.008 75.008 0 0 0 512 744.512c-28.096 0-53.792 15.584-66.656 40.416a27.776 27.776 0 0 1-33.376 13.664 322.464 322.464 0 0 1-118.88-70.24 27.36 27.36 0 0 1-5.056-33.888 74.048 74.048 0 0 0-0.128-74.368 74.944 74.944 0 0 0-64.864-37.12l-19.168 0.864-3.584-15.36a316.8 316.8 0 0 1 0.064-144.288 27.776 27.776 0 0 1 23.872-21.12l3.52-0.16a74.784 74.784 0 0 0 74.976-74.4 72.864 72.864 0 0 0-9.152-35.52 27.392 27.392 0 0 1 5.92-33.952 318.208 318.208 0 0 1 116.736-65.792 27.904 27.904 0 0 1 32 11.936A74.944 74.944 0 0 0 512 240.608c26.016 0 50.144-13.44 63.744-35.424a27.904 27.904 0 0 1 32-11.936z m-6.624 31.488l-1.728 2.656A106.976 106.976 0 0 1 512 272.608c-34.88 0-67.456-16.96-87.36-45.184l-1.792-2.656-8.672 2.912A286.336 286.336 0 0 0 329.888 275.2l-6.624 5.568 1.76 3.52c5.344 11.52 8.544 23.968 9.44 36.64l0.256 7.616a106.784 106.784 0 0 1-101.44 106.208l-2.496 0.064-1.76 8.352a284.8 284.8 0 0 0-0.032 106.4l0.32 1.568h0.416c33.28 2.08 63.744 19.52 82.24 47.168l3.584 5.664c17.952 30.848 19.168 68.48 3.488 100.352l-1.6 2.912 5.952 5.312a290.464 290.464 0 0 0 87.776 51.84l7.52 2.656 1.472-2.592a107.008 107.008 0 0 1 85.216-51.744l6.624-0.192c37.792 0 72.64 19.84 91.904 52.032l1.376 2.528 8.32-2.88a286.368 286.368 0 0 0 83.328-48.48l6.496-5.664-1.76-3.072a105.92 105.92 0 0 1-2.08-95.232l3.296-6.4a106.752 106.752 0 0 1 86.528-54.144l5.216-0.192 1.664-8.768a283.968 283.968 0 0 0-1.216-98.464l-1.888-8.928-3.072-0.096a106.752 106.752 0 0 1-100.672-100.128l-0.16-6.016a104.832 104.832 0 0 1 9.696-44.352l1.76-3.456-6.72-5.664a286.208 286.208 0 0 0-84.16-47.456l-8.736-2.912z m-92 127.264l6.976 0.032a128 128 0 1 1-8.192 255.872 128 128 0 0 1 8.192-255.872z m5.952 32a96 96 0 1 0-6.144 191.904 96 96 0 0 0 6.144-191.872z"  ></path></symbol><symbol id="gld-bf-scene-front" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M256 416h352v352H256z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-back" viewBox="0 0 1024 1024"><path d="M416 256h352v352H416z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-left" viewBox="0 0 1024 1024"><path d="M224 384l160-160v384l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-right" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M640 416l128-128v339.2l-128 128z" fill="#FFFFFF" fill-opacity=".6" ></path></symbol><symbol id="gld-bf-scene-top" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M268.8 384l128-128h358.4l-128 128z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-bottom" viewBox="0 0 1024 1024"><path d="M640 768l160-160H416l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#333333" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#333333" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#333333" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-arrow-right" viewBox="0 0 1024 1024"><path d="M538.624 466.176L150.698667 853.248l60.245333 60.416 449.024-448L210.432 25.002667l-59.733333 60.928z"  ></path><path d="M879.957333 466.176L492.032 853.248l60.245333 60.416 449.024-448L551.765333 25.002667l-59.733333 60.928z"  ></path></symbol><symbol id="gld-bf-BIMFACE-logo" viewBox="0 0 6963 1024"><path d="M13.23008 23.3472l172.2368 172.2368V23.3472zM0 208.81408h172.19584L0 36.61824zM202.01472 23.3472v172.2368L374.21056 23.3472zM387.4816 208.81408V36.61824L215.2448 208.81408zM417.30048 23.3472l172.19584 172.2368V23.3472zM404.02944 36.61824v172.19584h172.2368zM606.04416 23.3472v172.2368L778.28096 23.3472zM791.51104 208.81408V36.61824L619.3152 208.81408zM821.32992 23.3472l172.19584 172.2368V23.3472zM808.05888 36.61824v172.19584h172.2368zM1010.0736 36.61824v172.19584h172.2368zM1023.34464 225.40288l172.19584 172.19584V225.40288zM1010.0736 238.63296v172.19584h172.2368zM1109.44256 513.51552l86.09792-86.09792h-172.19584zM1010.0736 440.64768v172.19584h172.2368zM1010.0736 629.43232v172.19584l172.2368-172.19584zM1195.54048 814.85824V642.6624l-172.19584 172.19584zM1010.0736 831.44704v172.19584l172.2368-172.19584zM808.05888 831.44704v172.19584l172.2368-172.19584zM821.32992 1016.91392h172.19584v-172.2368zM619.3152 831.44704l172.19584 172.19584V831.488zM606.04416 1016.91392h172.2368l-172.2368-172.2368zM404.02944 831.44704v172.19584L576.3072 831.488zM417.30048 1016.91392h172.19584v-172.2368zM808.05888 427.4176v172.19584l172.2368-172.19584zM993.52576 612.84352v-172.19584l-172.19584 172.19584zM791.51104 599.6544v-172.2368H619.3152zM606.04416 440.64768v172.19584h172.2368zM404.02944 427.4176v172.19584l172.2368-172.19584zM589.49632 612.84352v-172.19584l-172.19584 172.19584zM0 225.36192v172.2368l172.19584-172.2368zM13.23008 410.8288h172.2368V238.63296zM13.23008 427.37664l172.2368 172.2368v-172.2368zM0 612.84352h172.19584L0 440.64768zM0 629.43232v172.19584l172.19584-172.19584zM13.23008 814.85824h172.2368V642.6624zM13.23008 831.44704l172.2368 172.19584V831.488zM0 1016.91392h172.19584L0 844.67712zM1314.77504 23.3472l172.19584 172.2368V23.3472zM1301.54496 208.81408h172.19584L1301.54496 36.61824zM1473.7408 225.40288l-172.19584 172.19584V225.40288zM1486.97088 410.8288H1314.816l172.19584-172.19584zM1314.77504 427.4176l172.19584 172.19584v-172.19584zM1301.54496 612.84352h172.19584l-172.19584-172.19584zM1473.7408 629.43232l-172.19584 172.19584v-172.19584zM1486.97088 814.8992H1314.816l172.19584-172.2368zM1314.77504 831.44704l172.19584 172.19584V831.488zM1301.54496 1016.91392h172.19584l-172.19584-172.2368zM1606.20544 23.3472l172.2368 172.2368 110.592-172.19584zM2099.32288 523.4688l175.39072 175.39072 112.72192-175.43168zM2389.4016 559.88224l-102.52288 159.58016h215.08096l-102.52288-159.58016-4.99712-7.7824M1592.9344 36.61824v172.19584h172.2368zM1592.9344 225.40288v172.19584l172.2368-172.19584zM2083.10272 506.88V225.40288h-281.47712zM1794.99008 208.81408h288.11264L1909.18656 38.2976zM2099.69152 225.40288v282.17344h282.13248zM1778.44224 410.8288V238.63296l-172.2368 172.19584zM1778.44224 599.6544v-172.2368h-172.2368zM1592.9344 440.64768v172.19584h172.2368zM1592.9344 629.43232v172.19584l172.2368-172.19584zM1778.44224 814.85824V642.6624l-172.2368 172.19584zM1606.20544 831.44704l172.2368 172.19584V831.488zM1592.9344 1016.91392h172.2368l-172.19584-172.2368zM2899.7632 23.3472l110.63296 172.2368L3182.592 23.3472zM2514.1248 698.85952l175.39072-175.39072h-288.11264zM3023.6672 208.81408h172.19584V36.61824zM3195.86304 397.59872V225.40288H3023.6672zM2705.73568 506.88l281.47712-281.47712h-281.47712zM2705.73568 208.81408h288.11264L2879.65184 38.2976zM2689.14688 225.40288l-282.13248 282.17344h282.13248zM3010.39616 238.63296v172.19584H3182.592zM3010.39616 599.6544l172.19584-172.2368h-172.19584zM3195.86304 612.84352v-172.19584l-172.19584 172.19584zM3195.86304 801.62816v-172.19584H3023.6672zM3182.592 814.85824l-172.19584-172.19584v172.19584zM3010.39616 831.44704v172.19584L3182.592 831.488zM3023.6672 1016.91392h172.19584v-172.2368zM4172.84096 530.06336c0 27.4432-22.24128 49.68448-49.68448 49.68448M4123.15648 480.37888c27.4432 0 49.68448 22.24128 49.68448 49.68448M6010.88 917.54496H5504.2048a139.10016 139.10016 0 0 1-139.10016-139.10016V261.81632a139.10016 139.10016 0 0 1 139.10016-139.10016v0.08192l457.03168-0.08192h49.68448a49.68448 49.68448 0 0 0 0-99.36896H5504.2048a238.46912 238.46912 0 0 0-238.46912 238.46912v516.62848a238.46912 238.46912 0 0 0 238.46912 238.46912H6010.88a49.68448 49.68448 0 0 0 0-99.36896"  ></path><path d="M4123.15648 480.37888H3477.34016V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896h546.65216a49.64352 49.64352 0 0 0-0.2048-99.36896H3576.70912a198.73792 198.73792 0 0 0-198.69696 198.73792V1014.5792h99.328V579.74784h645.81632a49.68448 49.68448 0 1 0 0-99.36896M5121.88416 946.05312L4704.78848 60.29312l-0.4096-0.94208v-0.04096a59.5968 59.5968 0 0 0-109.3632 0v0.04096l-0.28672 0.69632-417.13664 886.00576a49.68448 49.68448 0 0 0 89.9072 42.31168l382.23872-812.35968 382.23872 812.35968a49.68448 49.68448 0 0 0 89.9072-42.31168M6855.39328 579.74784h49.68448a49.68448 49.68448 0 0 0 0-99.36896h-645.81632V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896v-0.12288l99.328 0.12288h447.11936a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a198.69696 198.69696 0 0 0-198.69696 198.73792v596.09088a198.69696 198.69696 0 0 0 198.656 198.73792H6905.11872a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a99.36896 99.36896 0 0 1-99.36896-99.36896v-238.42816h596.13184z"  ></path><path d="M4550.49216 817.72544l99.24608-237.9776 99.20512 237.9776z"  ></path></symbol><symbol id="gld-bf-warning-1" viewBox="0 0 1024 1024"><path d="M469.333333 682.666667h85.333334v85.333333h-85.333334v-85.333333z m0-384h85.333334v341.333333h-85.333334V298.666667z m42.666667 640c235.648 0 426.666667-191.018667 426.666667-426.666667S747.648 85.333333 512 85.333333 85.333333 276.352 85.333333 512s191.018667 426.666667 426.666667 426.666667z m0 85.333333C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z"  ></path></symbol><symbol id="gld-bf-room-addnode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m16 64l-0.032 64H800v32h-64.032L736 768h-32l-0.032-64H640v-32h63.968L704 608h32zM208 640a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-448A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-deletenode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m-512 96a48 48 0 1 0 0 96 48 48 0 0 0 0-96zM800 672v32h-160v-32h160zM208 192A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-dragnode" viewBox="0 0 1024 1024"><path d="M512 640v128h96l-112 128-112-128h96v-128h32z m256-256l128 112-128 112v-96.032L640 512v-32l128-0.032V384zM224 384v96h128v32H224v96l-128-112L224 384z m272 32a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m0 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-352L608 224h-96v128h-32V224h-96l112-128z"  ></path></symbol><symbol id="gld-bf-success--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM288 448L192 544 416 768 832 352 736 256l-320 320-128-128z"  ></path></symbol><symbol id="gld-bf-information--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m64-320V384H384v64h64v256H384v64h256v-64H576zM448 192v128h128V192H448z"  ></path></symbol><symbol id="gld-bf-warning--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM448 192v384h128V192H448z m0 448v128h128v-128H448z"  ></path></symbol><symbol id="gld-bf-fitpanel" viewBox="0 0 1024 1024"><path d="M768 256v448h-96v-32h64V288H352v64h-32V256h448z"  ></path><path d="M608 416v320H288V416h320z m-35.552 35.552H323.52v248.896h248.896V451.52z"  ></path></symbol><symbol id="gld-bf-explode" viewBox="0 0 1024 1024"><path d="M832 288l-320 160L192 288l320-160 320 160zM512 163.776L263.552 288 512 412.224 760.448 288 512 163.776zM128 384l320 160v352L128 736V384z m32 51.776v280.448l256 128v-280.448l-256-128zM896 736l-320 160V544l320-160z"  ></path></symbol><symbol id="gld-bf-n-ployline" viewBox="0 0 1024 1024"><path d="M128 591.104l683.136 239.104 10.592-30.208-596.864-208.896 640.128-224.032L453.696 224l-10.528 30.208 324.704 112.96z"  ></path></symbol><symbol id="gld-bf-elevation" viewBox="0 0 1024 1024"><path d="M224 352h640v32h-284L384 608l-224-256h64z m313.472 32H230.528L384 559.392 537.472 384zM640 672v32H160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-horizontal" viewBox="0 0 1024 1024"><path d="M224 512v32h320v-32zM704 512v32h96v-32z"  ></path><path d="M512 728.48v34.4c73.024-23.712 128-127.04 128-250.88 0-141.376-71.648-256-160-256-74.56 0-137.184 81.6-154.944 192h32.416c16.448-93.664 67.648-160 122.528-160 66.72 0 128 98.048 128 224 0 105.376-42.88 191.232-96 216.48z"  ></path><path d="M512 640l-16 122.88 128-10.88z"  ></path></symbol><symbol id="gld-bf-rotate-vertical" viewBox="0 0 1024 1024"><path d="M512 224h32v320h-32zM512 704h32v96h-32z"  ></path><path d="M728.48 512h34.4c-23.712 73.024-127.04 128-250.88 128-141.376 0-256-71.648-256-160 0-74.56 81.6-137.184 192-154.944v32.416c-93.664 16.448-160 67.648-160 122.528 0 66.72 98.048 128 224 128 105.376 0 191.232-42.88 216.48-96z"  ></path><path d="M640 512l122.88-16-10.88 128z"  ></path></symbol><symbol id="gld-bf-hide-slice" viewBox="0 0 1024 1024"><path d="M586.72 518.848l-25.664-25.664A241.408 241.408 0 0 1 640 480c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M703.872 636a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM480 457.376L819.424 796.8l-22.656 22.624L457.376 480z" fill="#333333" ></path><path d="M384 736v32H128V192h640v256h-32V224H160v512z" fill="#333333" ></path></symbol><symbol id="gld-bf-distance-min" viewBox="0 0 1024 1024"><path d="M224 704v64h608v-64H224z m-32-32h672v128H192v-128z m64-192h512v32H256v-32z m64-224h128v32h-32v96h-32V288h-32v96h-32V256z m128 128V288h32v96h-32z m96-160v32h-32V224h32z m0 64v96h-32V288h32z m128 96V288h32v96h-32z m-64-96v96h-32V256h96v32h-64z" fill="#333333" ></path><path d="M192 375.584l29.44-12.608L278.464 496l-56.96 133.024-29.44-12.608L243.616 496 192 375.584z m646.432 0l-29.44-12.608-56.96 133.024 56.96 133.024 29.44-12.608-51.616-120.416 51.648-120.416h-0.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-area" viewBox="0 0 1024 1024"><path d="M841.6 704L550.4 288H192v416M160 256h409.6L896 736H160V256z m0-32" fill="#333333" ></path><path d="M336 345.6l22.4 22.4-86.4 86.4-22.4-22.4 86.4-86.4z m160 0l22.4 22.4-246.4 246.4-22.4-22.4 246.4-246.4z m64 96l22.4 22.4-182.4 182.4-22.4-22.4 182.4-182.4z m64 96l22.4 22.4-86.4 86.4-22.4-22.4 86.4-86.4z m64 0" fill="#333333" ></path></symbol><symbol id="gld-bf-fittobox" viewBox="0 0 1024 1024"><path d="M496 224L256 352v256l240 128 240-128v-256l-240-128z m198.4 137.6l-198.4 102.4-195.2-102.4 195.2-102.4 198.4 102.4zM288 582.4v-192l192 99.2v201.6l-192-99.2v-9.6z m416 9.6l-192 99.2v-201.6l192-99.2v201.6z" fill="#515151" ></path><path d="M352 128H128v224h32V160h192zM352 864H128v-224h32v192h192zM640 128h224v224h-32V160h-192zM640 864h224v-224h-32v192h-192z" fill="#515151" ></path></symbol><symbol id="gld-bf-delete" viewBox="0 0 1024 1024"><path d="M640 192V128H384v64H128v64h768V192zM192 320v544c0 52.928 43.072 96 96 96h448c52.928 0 96-43.072 96-96V320H192z m64 512V384h128v448H256z m192 0V384h128v448H448z m320 0h-128V384h128v448z"  ></path></symbol><symbol id="gld-bf-route" viewBox="0 0 1024 1024"><path d="M240 288a112 112 0 1 1 0-224 112 112 0 0 1 0 224zM224 288h32v128H224V288z m0 192h32v128H224v-128z m576-160h32v128h-32v-128z m0 192h32v118.144h-32V512zM240 896a112 112 0 1 1 0-224 112 112 0 0 1 0 224z m576-608a112 112 0 1 1 0-224 112 112 0 0 1 0 224z m-576 320a176 176 0 1 1 0 352 176 176 0 0 1 0-352z m0 32a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m576-32a112 112 0 1 1 0 224 112 112 0 0 1 0-224z m-179.008-69.44l91.84 89.12-22.272 22.976-91.84-89.152 22.272-22.944zM499.2 404.8l91.84 89.184-22.272 22.944-91.84-89.152 22.272-22.944z m-137.76-133.696l91.84 89.152-22.272 22.944-91.84-89.152 22.272-22.944zM223.648 137.376l91.84 89.152-22.272 22.944-91.84-89.12 22.272-22.976z" fill="#000000" ></path></symbol><symbol id="gld-bf-n-cloud" viewBox="0 0 1024 1024"><path d="M694.4 192C752 192 800 240 800 297.6c0 48-32 86.4-73.6 99.2 41.6 12.8 73.6 51.2 73.6 99.2s-32 86.4-73.6 99.2c41.6 12.8 73.6 54.4 73.6 99.2 0 57.6-48 105.6-105.6 105.6-48 0-86.4-32-99.2-73.6C582.4 768 544 800 496 800s-86.4-32-99.2-73.6C384 768 342.4 800 297.6 800 240 800 192 752 192 694.4c0-48 32-86.4 73.6-99.2C224 582.4 192 544 192 496s32-86.4 73.6-99.2C224 384 192 342.4 192 297.6 192 240 240 192 297.6 192c48 0 86.4 32 99.2 73.6C409.6 224 448 192 496 192s86.4 32 99.2 73.6C608 224 649.6 192 694.4 192m0-32c-38.4 0-73.6 19.2-99.2 44.8-25.6-25.6-60.8-44.8-99.2-44.8s-73.6 19.2-99.2 44.8C371.2 179.2 336 160 297.6 160 220.8 160 160 220.8 160 297.6c0 38.4 19.2 73.6 44.8 99.2-25.6 25.6-44.8 60.8-44.8 99.2s19.2 73.6 44.8 99.2c-25.6 25.6-44.8 60.8-44.8 99.2C160 771.2 220.8 832 297.6 832c38.4 0 73.6-19.2 99.2-44.8 25.6 25.6 60.8 44.8 99.2 44.8s73.6-19.2 99.2-44.8c25.6 28.8 60.8 44.8 99.2 44.8 76.8 0 137.6-60.8 137.6-137.6 0-38.4-19.2-73.6-44.8-99.2 25.6-25.6 44.8-60.8 44.8-99.2s-19.2-73.6-44.8-99.2c28.8-25.6 44.8-60.8 44.8-99.2C832 220.8 771.2 160 694.4 160z"  ></path></symbol><symbol id="gld-bf-up" viewBox="0 0 1129 1024"><path d="M600.275862 564.965517v459.034483h-105.931034V564.965517H15.677793L564.965517 15.677793 1114.253241 564.965517H600.275862z"  ></path></symbol><symbol id="gld-bf-down" viewBox="0 0 1129 1024"><path d="M600.275862 459.034483V0h-105.931034v459.034483H15.677793L564.965517 1008.322207 1114.253241 459.034483H600.275862z"  ></path></symbol><symbol id="gld-bf-transparent" viewBox="0 0 1024 1024"><path d="M512 0L32 256v512l480 256 480-256V256z m394.24 273.28L512 476.16 120.96 274.56 512 70.4zM96 718.08v-384l384 197.76v402.56l-384-198.4z m832 17.92l-384 198.4V531.84l384-197.76v401.92z"  ></path></symbol><symbol id="gld-bf-untransparent" viewBox="0 0 1024 1024"><path d="M968.56051 244.585987l-456.56051 238.063695-456.56051-238.063695L512 0zM22.828025 306.547771l456.56051 235.454777v481.997452L22.828025 782.675159zM1001.171975 782.675159l-456.56051 241.324841V542.002548l456.56051-235.454777z"  ></path></symbol><symbol id="gld-bf-properties-" viewBox="0 0 1024 1024"><path d="M320 320v64H256V320h64z m448 0v64H384V320h384zM320 512v64H256V512h64z m448 0v64H384V512h384z m-448 192v64H256v-64h64z m448 0v64H384v-64h384zM64 0v960h896V0H64z m64 896V192h768v704H128z" fill="#333333" ></path></symbol><symbol id="gld-bf-ncloud" viewBox="0 0 1024 1024"><path d="M795.5 492c0.2-4.7 0.2-9 0.2-12.4 0-56.4-22-109.3-61.8-149.2-39.8-39.8-92.8-61.8-149.2-61.8-43.7 0-86.6 14.8-124.2 43-25.7 19.2-47.2 43.6-62.8 70.8-17-8.9-35.9-13.5-55.5-13.5-31.3 0-61.4 14.5-84.7 40.9-15.6 17.6-26.7 39-32 61.2-26.4 10.5-50 28.4-67 51.2-19.9 26.7-30.5 58.5-30.5 91.9 0 84.8 69 153.9 153.9 153.9l0-0.4L781 767.6l0 0.2c76.1 0 138-61.9 138-138C919.1 559 864.6 499.7 795.5 492L795.5 492zM786.6 736 786.6 736l-514.1-0.1C209.6 731 160 678.4 160 614.4c0-52.8 33.4-99.8 83.3-116.4 0.2-0.1 0.3-0.1 0.4-0.2 5-1.4 8.8-5.5 9.7-10.8 7.1-42.7 44.2-85.9 88.9-85.9 18.3 0 35.9 5.5 50.8 16 1.5 1.4 3.3 2.5 5.3 3.2l0 0c7.8 2.9 16.5-0.7 20-8.3 30.3-65.2 98-111.3 166.3-111.3 98.7 0 179 80.3 179 179 0 6.7-0.4 17.2-1 26.4-0.5 8.2 5.2 15.5 13.3 16.9l0 0c1.4 0.2 2.8 0.3 4.2 0.1l0 0.1c58.5 0 106.9 48.4 106.9 106.9C887.2 686.7 842.5 733.1 786.6 736L786.6 736z"  ></path></symbol><symbol id="gld-bf-axial-" viewBox="0 0 1024 1024"><path d="M608 128h32v736h-32V128z m128 128v32H928v416h-192v32h224V256h-224zM96 256h32v96H96V256z m0 192h32v96H96v-96z m0 192h32v96H96v-96z m320 64v32h96v-32h-96z m-192 0h96v32H224v-32zM224 256v32h96V256H224z m192 0h96v32h-96V256zM256 480h224v32H256z"  ></path></symbol><symbol id="gld-bf-sectionbox1" viewBox="0 0 1024 1024"><path d="M592 128L160 345.056V717.12l304 155.04L896 655.104V283.04L592 128z m269.664 172.544L464 500.064 194.368 362.56l397.664-200.096 269.632 138.08zM192 396.384l256 130.56v302.016l-256-130.56v-302.016z m672 240l-384 192.576v-302.016l384-192.576v302.016z"  ></path></symbol><symbol id="gld-bf-axial" viewBox="0 0 1024 1024"><path d="M416 128h-32v736h32V128zM288 256v32H96v416h192v32H64V256h224z m640 0h-32v96h32V256z m0 192h-32v96h32v-96z m0 192h-32v96h32v-96z m-320 64v32h-96v-32h96z m192 0h-96v32h96v-32z m0-448v32h-96V256h96z m-192 0h-96v32h96V256zM544 480h224v32h-224z"  ></path><path d="M672 384v224h-32v-224z"  ></path></symbol><symbol id="gld-bf-section-axial" viewBox="0 0 1024 1024"><path d="M320 749.76V362.016l256-173.632v387.744l-256 173.632z m-32 60.384l320-217.056V128L288 345.056v465.088z"  ></path><path d="M750.4 640.928l-15.52 26.848-277.12-160 15.488-26.88 277.12 160z m46.368-83.072l81.536 177.28-188.8 15.424 107.264-192.704z"  ></path></symbol><symbol id="gld-bf-min-" viewBox="0 0 1024 1024"><path d="M64 576v64h275.2L12.8 966.4l44.8 44.8L384 684.8V960h64V576H64z m838.4-499.2L576 403.2V128H512v384h384V448H620.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-max-" viewBox="0 0 1024 1024"><path d="M576 64v64h275.2L524.8 454.4l44.8 44.8L896 172.8V448h64V64H576zM454.4 524.8L128 851.2V576H64v384h384v-64H172.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-show" viewBox="0 0 1024 1024"><path d="M85.333333 505.941333S230.101333 256 512 256c286.378667 0 426.666667 251.050667 426.666667 251.050667s-139.221333 248.362667-426.666667 251.52c-292.309333 3.2-426.666667-252.586667-426.666667-252.586667zM512 682.666667a170.666667 170.666667 0 1 0 0-341.333334 170.666667 170.666667 0 0 0 0 341.333334z m0-42.666667a128 128 0 1 1 0-256 128 128 0 0 1 0 256z"  ></path></symbol><symbol id="gld-bf-hide" viewBox="0 0 1024 1024"><path d="M235.733333 213.333333l592.213334 592.213334-29.568 29.610666L206.165333 243.029333 235.690667 213.333333z m688.128 283.093334c-5.632-9.386667-141.482667-229.674667-412.757333-229.674667-52.096 0-99.114667 8.234667-141.226667 21.333333l34.261334 34.261334a428.8 428.8 0 0 1 106.965333-13.866667c250.752 0 376.917333 209.408 376.917333 209.408s-48.426667 81.152-145.792 142.378667l30.336 30.378666c98.048-64.426667 148.181333-145.792 151.466667-151.296l12.8-21.589333-12.970667-21.333333z m-306.090666 217.258666a425.984 425.984 0 0 1-106.666667 13.738667c-250.026667 0-376.96-209.408-376.96-209.408s48.682667-80.896 145.792-142.122667l-30.336-30.378666c-97.792 64.256-148.053333 145.28-151.296 150.912L85.333333 518.016l13.098667 21.589333c5.632 9.429333 142.122667 229.717333 412.672 229.717334 52.053333 0 99.072-8.106667 141.056-21.205334l-34.389333-34.432z m-138.88-316.586666c10.325333-2.773333 21.077333-4.693333 32.213333-4.693334a125.866667 125.866667 0 0 1 125.610667 125.610667c0 11.264-1.962667 21.845333-4.693334 32.213333l33.237334 33.237334a167.509333 167.509333 0 0 0-219.733334-219.605334l33.365334 33.237334z m64.128 241.834666c-10.325333 2.773333-20.906667 4.693333-31.914667 4.693334a125.866667 125.866667 0 0 1-125.653333-125.610667c0-11.093333 1.962667-21.76 4.693333-31.914667l-33.237333-33.28a167.509333 167.509333 0 0 0 219.605333 219.605334l-33.493333-33.493334z"  ></path></symbol><symbol id="gld-bf-layers" viewBox="0 0 1024 1024"><path d="M512 512L118.4 352 512 192l393.6 160L512 512z m-310.4-160l310.4 128 310.4-128L512 224l-310.4 128z"  ></path><path d="M707.2 464l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 672l393.6-160-156.8-64z"  ></path><path d="M707.2 624l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 832l393.6-160-156.8-64z"  ></path></symbol><symbol id="gld-bf-distance" viewBox="0 0 1024 1024"><path d="M800 480v256H192v-256h608z m-32 32H224v192h544v-192z" fill="#333333" ></path><path d="M672 608.032h32v-96h-32zM576 608.032h32v-96h-32zM384 608.032h32v-96h-32zM480 640h32v-128h-32zM288 608.032h32v-96H288zM192 352h608v-32H192z" fill="#333333" ></path><path d="M768 384.032h32V288h-32v96.032z m-576 0h32V288H192v96.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-angle" viewBox="0 0 1024 1024"><path d="M192 704v64h640v-64H192z m-32-32h704v128H160v-128z" fill="#333333" ></path><path d="M216.736 672.608l-18.336-25.088L692.064 256.608l18.336 25.088z" fill="#333333" ></path><path d="M288 439.072c136.512 23.456 203.616 111.136 192.416 264.928h-32.8c10.112-138.08-40.128-212.544-159.616-233.024v-31.904z" fill="#333333" ></path></symbol><symbol id="gld-bf-view" viewBox="0 0 1024 1024"><path d="M528 160L224 320v384l304 160 304-160V320l-0.032 0.032M528.032 195.584L797.664 338.08 528 480 258.368 338.08l269.664-142.496zM256 372.992l256 134.752v311.68L256 684.672v-311.68z m544 311.68L544 819.424v-311.68l256-134.752v311.68z"  ></path></symbol><symbol id="gld-bf-orbit" viewBox="0 0 1024 1024"><path d="M774.816 705.536C717.76 784.704 625.472 832 528 832c-167.616 0-304-136.384-304-304h64l-80-128-80 128h64c0 185.28 150.72 336 336 336 107.712 0 209.696-52.256 272.736-139.776l-25.92-18.688zM864 528c0-185.28-150.72-336-336-336-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304h-64l80 128 80-128h-64z"  ></path><path d="M688 416l-160-64v0.224l-159.712 63.872L368 416v224l160 64 160-64V416zM512 663.136l-112-44.8V463.264l112 44.8v155.072zM411.328 433.344L528 386.496v0.032l116.896 46.688L528 480l-116.672-46.656zM656 618.336l-112 44.8V508.064l112-44.8v155.072z"  ></path></symbol><symbol id="gld-bf-pan" viewBox="0 0 1024 1024"><path d="M528 496H768V416l128 96-128 96v-80h-240V768H608l-96 96-96-96h80v-240H256V608l-128-96 128-96v80h240V256H416l96-128 96 128h-80v240z"  ></path></symbol><symbol id="gld-bf-zoom" viewBox="0 0 1024 1024"><path d="M512 202.816L308.16 384h168.096L512 670.016 547.744 384h168.096L512 202.816zM594.752 704h-165.504L512 786.752 594.752 704z m-147.008-32l0.512 3.968 3.52-3.968H480l-3.52-28.032L480 640h-4L448 416H224l288-256 288 256h-224l-28 224H544l3.52 3.968L544 672h28.256l3.52 3.968 0.48-3.968H672l-160 160-160-160h95.744z"  ></path></symbol><symbol id="gld-bf-add" viewBox="0 0 1024 1024"><path d="M448 448H128v128h320v320h128V576h320V448H576V128H448v320z"  ></path></symbol><symbol id="gld-bf-minus" viewBox="0 0 1024 1024"><path d="M128 448h768v128H128z"  ></path></symbol><symbol id="gld-bf-firstperson" viewBox="0 0 1024 1024"><path d="M528 224a80 80 0 1 0 0-160 80 80 0 0 0 0 160z m0 32a112 112 0 1 1 0-224 112 112 0 1 1 0 224z"  ></path><path d="M612.096 256h-170.624c-64.48 0-89.088 51.392-95.744 113.632L320 576.832c0 18.016 11.872 31.68 32.512 31.68s29.728-13.024 31.712-31.872l32.576-194.496 0.16 531.104c0 27.072 19.328 46.752 47.04 46.752 27.68 0 48.032-18.592 48.448-48.096L512 640h32l0.448 271.808c0 27.072 15.68 48.192 47.552 48.192 27.712 0 48.288-21.28 48.288-48.352l1.632-529.504 30.688 194.08c2.624 19.264 11.008 32.192 31.648 32.192s30.208-11.776 31.968-32.448l-23.424-211.136C707.392 302.912 676.544 256 612.096 256z m60.192 655.648A79.424 79.424 0 0 1 592 992c-28.096 0-50.336-11.456-64.096-30.08-14.4 18.752-37.184 30.08-63.904 30.08-45.216 0-79.04-33.856-79.04-78.72l-0.096-280.64a65.28 65.28 0 0 1-32.352 7.872c-37.728 0-64.512-27.36-64.512-63.68l0.256-3.936 25.664-206.656C323.2 279.36 363.52 224 441.472 224h170.624c78.656 0 125.344 55.264 132.48 137.28l23.456 211.168 0.064 6.24c-3.168 37.184-26.24 61.728-63.84 61.728-12.032 0-22.4-2.56-31.104-7.168l-0.864 278.4z"  ></path></symbol><symbol id="gld-bf-measure" viewBox="0 0 1024 1024"><path d="M160 672h736v-256H160v256z m-32-288h800v320H128V384z m0-32h800v32H128v-32z"  ></path><path d="M224 416h32v96H224v-96z m96 0h32v96h-32v-96z m96 0h32v96h-32v-96z m192 0h32v96h-32v-96z m-96 0h32v160h-32v-160z m192 0h32v96h-32v-96z m96 0h32v96h-32v-96z"  ></path></symbol><symbol id="gld-bf-notes" viewBox="0 0 1024 1024"><path d="M192 768.672l640 0 0 64-640 0 0-64Z"  ></path><path d="M931.904 775.2"  ></path><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M166.4 439.712 165.76 438.592 167.04 438.592Z"  ></path><path d="M359.712 682.784l-134.88 22.464 22.464-134.848L359.712 682.784zM359.712 682.784"  ></path><path d="M725.44 317.056l39.328-39.328-112.384-112.384-39.328 39.328L725.44 317.056zM725.44 317.056"  ></path><path d="M702.656 339.84 590.272 227.488 269.792 547.936 382.176 660.288 495.456 547.04 495.456 547.04Z"  ></path></symbol><symbol id="gld-bf-narrow" viewBox="0 0 1024 1024"><path d="M352 480l192 192-288 96L352 480zM292 754.9l-22-23.3L768 256l23.5 24L292 754.9z"  ></path></symbol><symbol id="gld-bf-noval" viewBox="0 0 1024 1024"><path d="M512 192c158.8 0 288 129.2 288 288S670.8 768 512 768 224 638.8 224 480 353.2 192 512 192M512 160c-176.7 0-320 143.3-320 320s143.3 320 320 320 320-143.3 320-320S688.7 160 512 160L512 160z"  ></path></symbol><symbol id="gld-bf-nrectangle" viewBox="0 0 1024 1024"><path d="M800.2 256.1l0 447.7-576.3 0L223.9 256.1 800.2 256.1M832.2 224.1 191.8 224.1l0 511.7 640.3 0L832.2 224.1 832.2 224.1z"  ></path></symbol><symbol id="gld-bf-ntext" viewBox="0 0 1024 1024"><path d="M784 224l0 150.4-14.6 0c-8.7-34.4-18.3-58.5-28.8-73.6s-25.1-27-43.5-36c-10.3-4.9-28.3-7.3-54-7.3l-41 0 0 425c0 28.2 1.6 45.8 4.7 52.8s9.2 13.2 18.2 18.5c9.1 5.3 21.5 7.9 37.2 7.9l18.3 0 0 15L392.1 776.7l0-15 18.3 0c16 0 28.8-2.8 38.6-8.5 7-3.8 12.6-10.3 16.7-19.5 3-6.5 4.5-23.6 4.5-51.2l0-424.9-39.8 0c-37.1 0-64.1 7.9-80.8 23.6-23.6 22-38.5 52.6-44.7 93.3L288 374.5 288 224 784 224z"  ></path></symbol><symbol id="gld-bf-mark" viewBox="0 0 1024 1024"><path d="M192.2 800.2l608-608.2 22.6 22.6-608 608.2C214.8 822.8 192.2 800.2 192.2 800.2zM809.6 822.8l-608-608.2 22.6-22.6 608 608.2C832.2 800.2 809.6 822.8 809.6 822.8z"  ></path></symbol><symbol id="gld-bf-zoomrect" viewBox="0 0 1024 1024"><path d="M886.4 809.6l-96-96c25.6-28.8 41.6-64 41.6-105.6 0-9.6 0-19.2-3.2-28.8v-6.4c-3.2-9.6-3.2-16-6.4-22.4 0-3.2-3.2-6.4-3.2-9.6-3.2-6.4-6.4-9.6-9.6-16-3.2-6.4-6.4-9.6-9.6-16l-6.4-6.4c-6.4-9.6-16-16-22.4-22.4v-288h-512v512h288c6.4 9.6 12.8 16 22.4 22.4l6.4 6.4c6.4 3.2 9.6 6.4 16 9.6 6.4 3.2 9.6 6.4 16 9.6 3.2 0 6.4 3.2 9.6 3.2 6.4 3.2 16 6.4 22.4 6.4h6.4c9.6 3.2 19.2 3.2 28.8 3.2 35.2 0 67.2-12.8 96-32l96 96 19.2-19.2zM288 672v-448h448v236.8c-19.2-9.6-41.6-12.8-64-12.8-89.6 0-160 70.4-160 160 0 22.4 6.4 44.8 12.8 64h-236.8z m384 64c-9.6 0-19.2 0-28.8-3.2-3.2 0-3.2 0-6.4-3.2-6.4-3.2-12.8-3.2-19.2-6.4-3.2 0-3.2-3.2-6.4-3.2-6.4-3.2-12.8-6.4-19.2-12.8 0 0-3.2 0-3.2-3.2l-19.2-19.2-6.4-6.4c-12.8-19.2-19.2-44.8-19.2-70.4 0-70.4 57.6-128 128-128 25.6 0 48 6.4 70.4 19.2l6.4 6.4c6.4 6.4 16 12.8 19.2 19.2 0 0 0 3.2 3.2 3.2 6.4 6.4 9.6 12.8 12.8 19.2 0 3.2 3.2 3.2 3.2 6.4 3.2 6.4 6.4 12.8 6.4 19.2 0 3.2 0 3.2 3.2 6.4 3.2 9.6 3.2 19.2 3.2 28.8 0 70.4-57.6 128-128 128z"  ></path></symbol><symbol id="gld-bf-selected" viewBox="0 0 1024 1024"><path d="M930.133333 315.733333L827.733333 213.333333 409.6 631.466667 196.266667 418.133333 85.333333 529.066667l213.333334 213.333333 102.4 102.4L512 742.4l418.133333-426.666667z" fill="#333333" ></path></symbol><symbol id="gld-bf-tree" viewBox="0 0 1024 1024"><path d="M800 672v-192h-288V288h96V128h-224v160h96v192H192v192H128v160h160v-160H224v-160h256v160h-64v160h160v-160h-64v-160h256v160h-64v160h160v-160z"  ></path></symbol><symbol id="gld-bf-infor" viewBox="0 0 1024 1024"><path d="M512 85.333333c238.933333 0 426.666667 187.733333 426.666667 426.666667s-187.733333 426.666667-426.666667 426.666667-426.666667-187.733333-426.666667-426.666667 187.733333-426.666667 426.666667-426.666667m0-85.333333C230.4 0 0 230.4 0 512s230.4 512 512 512 512-230.4 512-512-230.4-512-512-512z"  ></path><path d="M469.333333 256h85.333334v85.333333h-85.333334zM469.333333 426.666667h85.333334v341.333333h-85.333334z"  ></path></symbol><symbol id="gld-bf-box-hide" viewBox="0 0 1024 1024"><path d="M528 128L96 352v352l304 160 131.2-67.2c-9.6-9.6-22.4-12.8-32-19.2L416 819.2v-278.4l384-198.4v188.8c9.6 3.2 22.4 6.4 32 9.6V288l-304-160zM128 684.8v-278.4l256 134.4v278.4l-256-134.4z m272-172.8l-268.8-140.8 396.8-208 268.8 144L400 512z" fill="#333333" ></path><path d="M682.72 582.848l-25.664-25.664A241.408 241.408 0 0 1 736 544c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M799.872 700a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM576 521.376L915.424 860.8l-22.656 22.624L553.376 544z" fill="#333333" ></path></symbol><symbol id="gld-bf-information" viewBox="0 0 1024 1024"><path d="M512 160c195.2 0 352 156.8 352 352s-156.8 352-352 352S160 707.2 160 512 316.8 160 512 160m0-32C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128z"  ></path><path d="M480 320h64v64h-64zM480 448h64v256h-64z"  ></path></symbol><symbol id="gld-bf-properties" viewBox="0 0 1024 1024"><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M288 416l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 416l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 544l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 544l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 672l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 672l352 0 0 64-352 0 0-64Z"  ></path><path d="M852 160 192 160l0 160 0 544 672 0L864 160 852 160zM384 208l64 0 0 64-64 0L384 208zM288 208l64 0 0 64L288 272 288 208zM832 832 224 832 224 320l608 0L832 832z"  ></path></symbol><symbol id="gld-bf-map" viewBox="0 0 1024 1024"><path d="M656 96C524.8 96 416 201.6 416 336S656 736 656 736 896 467.2 896 336 790.4 96 656 96z m0 339.2c-67.2 0-121.6-54.4-121.6-121.6 0-67.2 54.4-121.6 121.6-121.6s121.6 54.4 121.6 121.6c0 67.2-54.4 121.6-121.6 121.6zM128 704h480v32H128zM128 416h288v32h-288z"  ></path><path d="M320 256h32v672h-32zM640 768h32v160h-32zM704 704h160v32h-160z"  ></path></symbol><symbol id="gld-bf-maximize" viewBox="0 0 1024 1024"><path d="M608 192v32h169.6l-227.2 227.2 22.4 22.4L800 246.4V416h32V192zM451.2 550.4L224 777.6V608H192v224h224v-32H246.4l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-minimize" viewBox="0 0 1024 1024"><path d="M256 544v32h169.6l-227.2 227.2 22.4 22.4 227.2-227.2V768h32v-224zM803.2 198.4L576 425.6V256h-32v224h224v-32h-169.6l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-reset-box" viewBox="0 0 1024 1024"><path d="M210.56 672l112-160h-224z" fill="#333333" ></path><path d="M530.016 864v-32a304 304 0 1 0-304-304h-32c0-185.568 150.4-336 336-336 185.568 0 336 150.432 336 336S715.552 864 530.016 864z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-box" viewBox="0 0 1024 1024"><path d="M528 832c-166.4 0-304-137.6-304-304h64l-80-128-80 128h64C192 713.6 342.4 864 528 864c108.8 0 211.2-51.2 272-140.8l-25.6-19.2c-57.6 80-150.4 128-246.4 128zM864 528C864 342.4 713.6 192 528 192c-108.8 0-211.2 54.4-275.2 140.8l25.6 19.2c57.6-80 150.4-128 249.6-128C694.4 224 832 361.6 832 528h-64l80 128 80-128h-64z"  ></path><path d="M640 416v224h-224V416h224m32-32h-288v288h288V384z"  ></path></symbol><symbol id="gld-bf-close16" viewBox="0 0 1024 1024"><path d="M929.7 873.9 567.8 511.8l361.4-361.6c11.9-11.9 11.9-31.2 0-43.2l-12.7-12.7c-11.9-11.9-31.2-11.9-43.1 0L512 455.9 150.6 94.3c-11.9-11.9-31.2-11.9-43.1 0L94.8 107c-11.9 11.9-11.9 31.2 0 43.2l361.4 361.6L94.2 873.9c-11.9 11.9-11.9 31.3 0 43.2l12.7 12.7c11.9 11.9 31.2 11.9 43.1 0L512 567.6l361.9 362.1c11.9 11.9 31.2 11.9 43.1 0l12.7-12.7C941.6 905.1 941.6 885.8 929.7 873.9z"  ></path></symbol><symbol id="gld-bf-orbitcamera" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M704 416l-96 48L608 416l-256 0 0 224 256 0 0-48 96 48L704 416zM576 608l-192 0 0-160 192 0 0 32 0 96L576 608zM672 588.224l-64-32 0-56.448 64-32L672 588.224z"  ></path></symbol><symbol id="gld-bf-orbitpoint" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M528 528m-112 0a3.5 3.5 0 1 0 224 0 3.5 3.5 0 1 0-224 0Z"  ></path></symbol><symbol id="gld-bf-settings" viewBox="0 0 1024 1024"><path d="M796.896 435.552c-6.72-25.12-16.672-48.96-29.408-70.976l55.872-84.32-0.096-0.096-79.456-79.456L743.712 200.64l-84.32 55.872c-22.016-12.736-45.824-22.688-70.976-29.408L568.32 128l-0.128 0-112.384 0L455.68 128l-20.128 99.104c-25.12 6.72-48.96 16.672-70.976 29.408L280.288 200.64 280.192 200.736 200.736 280.192 200.64 280.288l55.872 84.32c-12.736 22.016-22.688 45.824-29.408 70.976L128 455.68l0 0.128 0 112.384 0 0.128 99.104 20.128c6.72 25.12 16.672 48.96 29.408 70.976L200.64 743.712l0.096 0.096 79.456 79.456 0.096 0.096 84.32-55.872c22.016 12.736 45.824 22.688 70.976 29.408L455.68 896l0.128 0 112.384 0 0.128 0 20.096-99.104c25.12-6.72 48.96-16.672 70.976-29.408l84.32 55.872 0.096-0.096 79.456-79.456 0.096-0.096-55.872-84.32c12.736-22.016 22.688-45.824 29.408-70.976L896 568.32l0-0.128 0-112.384L896 455.68 796.896 435.552zM512 672c-88.352 0-160-71.648-160-160s71.648-160 160-160 160 71.648 160 160S600.352 672 512 672z"  ></path></symbol><symbol id="gld-bf-home" viewBox="0 0 1024 1024"><path d="M928 512L512 128 96 512h128v352h192V608h192v256h192V512z"  ></path></symbol><symbol id="gld-bf-sectionbox" viewBox="0 0 1024 1024"><path d="M576 160l32 0 0 704-32 0 0-704Z"  ></path><path d="M672 256 672 288 704 288 830.016 288 864 288 864 672 830.016 672 704 672 672 672 672 704 896 704 896 256Z"  ></path><path d="M128 512l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 704l32 0c16 0 32 0 32 0l0-32L128 672 128 704z"  ></path><path d="M416 288 452 288 480 288 512 288 512 256 416 256Z"  ></path><path d="M128 352l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 256l64 0 0 32-64 0 0-32Z"  ></path><path d="M256 256l96 0 0 32-96 0 0-32Z"  ></path><path d="M416 672 416 704 512 704 512 672 452 672Z"  ></path><path d="M256 672l96 0 0 32-96 0 0-32Z"  ></path></symbol></svg>',c=(c=document.getElementsByTagName("script"))[c.length-1].getAttribute("data-injectcss")
;if(c&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}n=function(){var e,t,n,a;(a=document.createElement("div")).innerHTML=s,s=null,(n=a.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",e=n,(t=document.body).firstChild?(a=e,(n=t.firstChild).parentNode.insertBefore(a,n)):t.appendChild(e))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(a=function(){document.removeEventListener("DOMContentLoaded",a,!1),n()},document.addEventListener("DOMContentLoaded",a,!1)):document.attachEvent&&(i=n,o=e.document,l=!1,(r=function(){try{o.documentElement.doScroll("left")}catch(e){return void setTimeout(r,50)}t()})(),o.onreadystatechange=function(){"complete"==o.readyState&&(o.onreadystatechange=null,t())})}(window),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=function(){return{id:null,tagName:"div",className:"bf-control",title:"",element:""}};t.ControlConfig=n}(),function(){var t=Object.freeze({Click:"Click",MouseEnter:"MouseEnter",MouseLeave:"MouseLeave",MouseMove:"MouseMove",StateChange:"StateChange",Change:"Change"});e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control").ControlEvent=t}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){var a=this;a.eventManager=new e.Web.Lang.EventManager,a.element=n.create(t.tagName,t.className),a.id=t.id||e.Web.Lang.Utility.UUID.createUUID(),t.title&&!t.isPanel&&a.setTitle(t.title),t.element&&t.element.appendChild(a.element)};a.prototype={addEventListener:function(e,t){var n=this,a=n.eventManager;n.element.addEventListener(e.toLocaleLowerCase(),t),a.addEvent(e,t)},removeEventListener:function(e,t){var n=this;n.eventManager.removeEvent(e,t),n.element.removeEventListener(e.toLocaleLowerCase(),t)},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},setTitle:function(e){this.element.setAttribute("title",e)},getTitle:function(){return this.element.getAttribute("title")},setClassNames:function(e){this.element.setAttribute("class",e)},getClassNames:function(){return this.element.getClass()},addClassName:function(e){this.element.addClass(e)},removeClassName:function(e){this.element.removeClass(e)},toggleClassName:function(e,t){this.element.toggleClass(e,t)},setDomId:function(e){this.element.setAttribute("id",e)},getDomId:function(){return this.element.getAttribute("id")},getId:function(){return this.id},setHtml:function(e){this.element.innerHTML=e},setStyle:function(e){this.element.setCss(e)},destroy:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},t.Control=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Toolbar"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-toolbar"};return Object.assign({},n,e)};t.ToolbarConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Toolbar"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),function(e){this._controls=[],t.Control.call(this,e),this.element.addEventListener("mousedown",this.bringToFront.bind(this))});a.Type.inheritPrototype(i,t.Control),i.prototype.addControl=function(e){this.getControls().push(e),this.element.appendChild(e.element)},i.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},i.prototype.addControls=function(e){for(var t=this,n=0,a=e.length;n<a;n++)t.addControl(e[n]);return this.getControls()},i.prototype.insertControl=function(e,t){var n=this.getControls();n.insert(e,t);var a=n[e+1];a?this.element.insertBefore(t.element,a.element):this.element.appendChild(t.element)},i.prototype.removeControl=function(e){var t=this.getControls(),n=t.getObjectByAttribute("id",e);t.removeObjectByAttribute("id",e),this.element.removeChild(n.element)},i.prototype.getControls=function(){return this._controls},i.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},i.prototype.destroy=function(){for(var e=this.getControls(),t=0;t<e.length;t++)e[t].destroy();this._controls=[],this.element.parentNode&&this.element.parentNode.removeChild(this.element)},n.Toolbar=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=(e.Bimface.UI.Button.ButtonOption,new e.Bimface.UI.Control.ControlConfig),a=function(){var e={className:"bf-button",title:"button",checkedState:!1,defaultClass:"",changeClass:"",inheritTitle:!1};return Object.assign({},n,e)};t.ButtonConfig=a}(),function(){var t=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control")),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=function(e){t.Control.call(this,e),this._enabled=!0};a.Type.inheritPrototype(i,t.Control),i.prototype.addToolbar=function(e){this.toolbar=e,this.element.appendChild(e.element)},i.prototype.getToolbar=function(e){return this.toolbar},i.prototype.disabled=function(){this._enabled=!1,this.element.addClass("bf-button-disabled")},i.prototype.enabled=function(){this._enabled=!0,this.element.removeClass("bf-button-disabled")},n.Button=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),a=e.Bimface.UI.Control.ControlEvent,i=function(e){t.Button.call(this,e);var n=this;n._checked=e.checkedState,n._checked&&this.addClassName("bf-checked"),n.addEventListener(a.Click,function(){n.toggleCheckedState()})};n.Type.inheritPrototype(i,t.Button),i.prototype.toggleCheckedState=function(){this.setCheckedState(!this._checked)},i.prototype.setCheckedState=function(e){this._checked!=e&&(this._checked=e,this.toggleClassName("bf-checked",e),this.eventManager.fireEvent(a.StateChange,e))},i.prototype.isChecked=function(){return this._checked},t.ToggleButton=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Toolbar"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),o=new a.ToolbarConfig,l=new t.ControlConfig,r=function(e){t.Control.call(this,e);var n=this;n._inheritTitle=e.inheritTitle;var i=new t.Control(l);i.setClassNames("bf-current"),o.element=n.element,o.className="bf-sub-toolbar bf-scroll-bar";var r=new a.Toolbar(o);n.currentElement=i,n._subToolbar=r,n.element.appendChild(n.currentElement.element),n.addEventListener("Click",function(){n.toggleDropDownList()})};i.Type.inheritPrototype(r,t.Control),r.prototype.toggleDropDownList=function(){this.checked=!this.checked,this.toggleClassName("bf-expand")},r.prototype.showDropDownList=function(){this._checked=!0,this.addClassName("bf-expand")},r.prototype.hideDropDownList=function(e){this._checked=!1,this.removeClassName("bf-expand")},r.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),1==n.length&&t.setSelectedControlById(e.id),e.addEventListener("Click",function(){for(var a=0,i=n.length;a<i;a++)n[a].setCheckedState(!1);t.currentElement.setHtml(this.outerHTML.replace("checked","")),e.setCheckedState(!0),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},r.prototype.removeControl=function(e){this._subToolbar.removeControl(e)},r.prototype.getControls=function(){return this._subToolbar.getControls()},r.prototype.getControl=function(e){return this._subToolbar.getControl(e)},r.prototype.getCurrentControl=function(){return this._currentControl},r.prototype.setSelectedControlById=function(e){var t=this.getControl(e);t.setCheckedState(!1);var n=t.element.cloneNode(!0);this._inheritTitle||n.removeAttribute("title"),this.currentElement.setHtml(n.outerHTML),t.setCheckedState(!0),this._currentControl=t},r.prototype.setSelectedUiById=function(e){this.element.querySelector(".bf-checked").removeClass("bf-checked"),this.setSelectedControlById(e),this.eventManager.fireEvent("Change",this.getControl(e))},n.ComboBox=r}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),a=function(e){t.ComboBox.call(this,e),this.currentElement=e.home,this.home=e.home,this.element.appendChild(this.currentElement.element)};n.Type.inheritPrototype(a,t.ComboBox),a.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),e.addEventListener("Click",function(){for(var a=0,i=n.length;a<i;a++)n[a].setCheckedState(!1);t.currentElement.setCheckedState(!1),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},a.prototype.recover=function(){this.home.setCheckedState(!1),this.hideDropDownList()},t.TouchComboBox=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),a=function(e){t.ToggleButton.call(this,e)};n.Type.inheritPrototype(a,t.ToggleButton),t.ComboBoxOptionButton=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),a=function(e){t.Button.call(this,e);var n=this;n.addClassName(e.defaultClass),n._defaultClass=e.defaultClass,n._changeClass=e.changeClass,this.type="default",n._title=e.title,n._changeTitle=e.changeTitle||e.title,n._checked&&this.addClassName("bf-checked"),n.addEventListener("Click",function(){n.toggleState(),n.eventManager.fireEvent("Change",n.type)})};n.Type.inheritPrototype(a,t.Button),a.prototype.toggleState=function(){this.setState("change"==this.type?"default":"change")},a.prototype.setState=function(e){this.type=e,"default"==e?(this.addClassName(this._defaultClass),this.removeClassName(this._changeClass)):(this.addClassName(this._changeClass),this.removeClassName(this._defaultClass))},t.ChangeButton=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),a={},i=function(e){t.Button.call(this,e);var n=this;n._checked=e.checkedState,n.addEventListener("Click",function(){n.setChecked()}),a[e.groupName]?(a[e.groupName].push(n),this._groupList=a[e.groupName]):(a[e.groupName]=[n],this._groupList=a[e.groupName],n.setChecked())};n.Type.inheritPrototype(i,t.Button),i.prototype.setChecked=function(){for(var e=this._groupList,t=0,n=e.length;t<n;t++)e[t].removeClassName("bf-checked");this.addClassName("bf-checked")},t.SingleButton=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Menu"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-menu",isSubMenu:!1,text:null};return Object.assign({},n,e)};t.MenuConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Menu"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-menu-item"};return Object.assign({},n,e)};t.MenuItemConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Button"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Menu"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),function(e){this._controls=[],t.Button.call(this,e),this.isDisabled=!1});a.Type.inheritPrototype(i,t.Button),i.prototype.setText=function(e){this.element.innerText=e},i.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},i.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},i.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},i.prototype.show=function(e){this.element.removeClass("bf-hide"),this.isHide=!1},i.prototype.addEventListener=function(e,t){var n=this,a=n.eventManager;this.isDisabled||(n.element.addEventListener(e.toLocaleLowerCase(),t),a.addEvent(e,t))},n.MenuItem=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Menu"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(){this.element=n.create("div","bf-spacer")};a.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},t.Spacer=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Toolbar"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Menu"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=function(e){if(t.Toolbar.call(this,e),this.element.addEventListener("mousedown",function(e){e.stopPropagation()}),this.element.addEventListener("contextmenu",function(e){e.preventDefault()}),this.isDisabled=!1,e.isSubMenu){var n=i.create("div","bf-menu-item");n.innerText=e.text;var a=i.create("div","bf-menu");this.element.appendChild(n),this.element.appendChild(a),this.subElement=a}};a.Type.inheritPrototype(o,t.Toolbar),o.prototype.setPosition=function(e){this.element.style.left=e.x+"px",this.element.style.top=e.y+"px"},o.prototype.addControl=function(e){this.getControls().push(e),this.subElement?this.subElement.appendChild(e.element):this.element.appendChild(e.element)},o.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},o.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},o.prototype.destroy=function(e){this.element&&this.element.remove(),this.element=null},n.Menu=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Panel"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility");n.PanelPositions=n.PanelPositions||{};var o=function(i){var o=e.Web.Lang.Utility.ClientHelper.getIsDesktop();i.isPanel=!0,this._opt=i,t.Control.call(this,i),this._controls=[];var l=this,r=l.element;l.isShow=!0;var s=a.create("div","bf-panel-body"),c=a.create("div","bf-panel-header"),d=a.create("div","bf-panel-footer"),f=a.create("div","bf-panel-container bf-scroll-bar"),u=a.create("div","bf-close"),m=i.css;for(var p in m)r.style[p]=""+m[p];if(i.easyMode||r.appendChild(u),i.title){var g=a.create("div","bf-title");g.textContent=i.title,r.appendChild(g),r.addClass("bf-has-title"),l.headerElement=g}s.appendChild(c),s.appendChild(f),r.appendChild(s),s.appendChild(d),g&&i.enableDrag&&o&&(this.drag=new e.Web.Lang.Utility.Dom.drag({element:this.element,handle:g,bBoxDetection:!0,move:function(e,t,n){l.eventManager.fireEvent("Move",e,t,n)},record:function(e,t){n.PanelPositions[i.className]={left:e,top:t}}})),this.body=s,this.container=f,this.header=c,this.footer=d,i.enableSizable&&e.Web.Lang.Utility.Dom.sizable({element:this.element,axis:"all",sizable:function(e,t,n){l.eventManager.fireEvent("Sizable",e,t,n)}}),r.addEventListener("mousedown",this.onMouseDown.bind(this)),r.addEventListener("mousemove",this.onMouseMove.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),u.addEventListener("click",function(){l.hide()}),f.addEventListener("click",function(e){var t=e.target.closest(".bf-group-title");if(t&&t.hasClass("bf-group-title")){t.parentNode.toggleClass("bf-collapse")}}),f.addEventListener("DOMNodeRemoved",function(){l.showTips()}),f.addEventListener("DOMNodeInserted",function(){l.hideTips()}),window.addEventListener("resize",this.initPosition.bind(this))};i.Type.inheritPrototype(o,t.Control),o.prototype.setData=function(e,t){if(this.clear(),e&&e.length>0){for(var n='<table class="bf-table">',a=0,i=e.length;a<i;a++){for(var o='<tbody class="bf-group '+(t&&"bf-collapse")+'"><tr class="bf-group-title"><td colspan="2"><i class="bf-icon"></i>'+e[a].group+"</td></tr>",l=e[a].items,r=0,s=l.length;r<s;r++){var c=l[r];o+='<tr class="bf-group-content"><td class="bf-key">'+c.key+'</td><td class="bf-value">'+c.value+"</td></tr>"}o+="</tbody>",n+=o}n+="</table>",this.container.innerHTML=n}},o.prototype.setTitleContent=function(e){this.headerElement.textContent=e},o.prototype.onMouseDown=function(){this.isMouseDown=!0,this.element.removeEventListener("mousemove",this.onMouseMove),this.bringToFront()},o.prototype.onMouseMove=function(e){!0!==this.isMouseDown&&(e.preventDefault(),e.stopPropagation())},o.prototype.onMouseUp=function(){this.isMouseDown=!1,this.element.addEventListener("mousemove",this.onMouseMove)},o.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},o.prototype.showTips=function(){if(this.tipsElement)return void this.body.insertBefore(this.tipsElement,this.body.childNodes[1])},o.prototype.setTips=function(e,t){this.tipsElement&&this.tipsElement.remove();var n={default:"bf-panel-tips",loading:"bf-panel-loading"},i=n[t]||n.default,o=a.create("div",i);o.textContent=e,this.tipsElement=o,this.showTips()},o.prototype.hideTips=function(){this.tipsElement&&this.tipsElement.remove()},o.prototype.setContainerHeader=function(e){if("String"==typeof e);else{e.style.right="100%",e.style.bottom="100%",document.body.appendChild(e);var t=e.offsetHeight;document.body.removeChild(e),e.removeAttribute("style"),e.style.marginTop="-"+t+"px",this.body.style.paddingTop=t+"px",this.header.appendChild(e)}},o.prototype.setContainerFooter=function(e){"String"==typeof e||this.footer.appendChild(e)},o.prototype.close=function(){this.destroy(),this.eventManager.fireEvent("Close"),this.isShow=!1,window.removeEventListener("resize",this.initPosition.bind(this))},o.prototype.hide=function(e){this.isShow=!1,this.element.style.display="none",!0!==e&&this.eventManager.fireEvent("Hide")},o.prototype.show=function(e){this.isShow=!0,this.element.style.display="",!0!==e&&this.eventManager.fireEvent("Show"),this.bringToFront(),this.initPosition()},o.prototype.clear=function(){this.container.innerHTML=""},o.prototype.toggle=function(){this.isShow?this.element.style.display="none":(this.element.style.display="",this.bringToFront()),this.isShow=!this.isShow},o.prototype.addControl=function(e){this.getControls().push(e),this.container.appendChild(e.element)},o.prototype.getControls=function(){return this._controls},o.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},o.prototype.setHtml=function(e){this.container.innerHTML=e},o.prototype.addClass=function(e){this.element.addClass(e)},o.prototype.removeClass=function(e){this.element.removeClass(e)},o.prototype.setHeight=function(e){this.element.style.height=e+"px"},o.prototype.setWidth=function(e){this.element.style.width=e+"px"},o.prototype.setHeader=function(e){this._opt.title=e,this.headerElement.textContent=e},o.prototype.getTitle=function(){return this._opt.title},o.prototype.isDisplay=function(){return"none"!=this.element.style.display},o.prototype.initPosition=function(){this.isShow&&this.drag&&(n.PanelPositions[this._opt.className]?(this.element.style.left=n.PanelPositions[this._opt.className].left+"px",this.element.style.top=n.PanelPositions[this._opt.className].top+"px",this.drag.resize(this.element)):this.drag.resize(this.element,null,!0))},n.Panel=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Panel"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-panel",title:"panel",css:{width:"200px",height:"200px",minWidth:"200px",minHeight:"200px"},enableDrag:!0,enableSizable:!0};return Object.assign({},n,e)};t.PanelConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tree"),n=function(e){var t=this;t._root=e,t.element=e.element,t.eventManager=e.eventManager,t.addEventListener=e.addEventListener,t.removeEventListener=e.removeEventListener,e.addEventListener("SelectionChanged",function(e,n){t._selectionNode==e?n||(t._selectionNode=null):(t._selectionNode&&t._selectionNode.deselect(),t._selectionNode=e)})};n.prototype={getRoot:function(){return this._root},getChecked:function(){function e(a,i){var o=a.getCheckedState(),l=a.element.getAttribute("data-filter");switch(o){case"unchecked":break;case"checked":if(a==t)n="all";else{var r=Object.assign({},i);r[l]=a.id,n.push(r)}break;case"half":var s=a.getControls(),c=Object.assign({},i);a!=t&&(c[l]=a.id);for(var d=0,f=s.length;d<f;d++)e(s[d],c)}}var t=this._root,n=[];return e(t,{}),n},getSelection:function(){function e(t,n){var a=t.element.getAttribute("data-filter"),i=t.getParent();if(!i)return n;n[a]=t.id,e(i,n)}var t=this._selectionNode,n={};return!!t&&(e(t,n),n)},clear:function(e){var t=this.getRoot();!function t(n){n.setCheckedState(e),n.setIconState("default"),n.deselect();var a=n.getControls();if(a&&a.length>0)for(var i=0;i<a.length;i++)t(a[i])}(t)}},t.Tree=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Toolbar"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tree"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=function(e){t.Toolbar.call(this,e),this._opt=Object.assign({},e),e.hasCheckbox&&(this._checkedState=e.isChecked?"checked":"unchecked"),this._iconState=!0;var n=i.create("div","bf-tree-node bf-collapse");this._enabled=e.enabled,this._selection=e.selection,this._selectionState="unSelected",this._datas=e.datas,this.treeNode=n};a.Type.inheritPrototype(o,t.Toolbar),o.prototype.setData=function(e,t){var n=this,a=this._opt,o=this.treeNode;if(a.hasCheckbox){var l=a.isChecked?"bf-checked":"",r=i.create("span","bf-label "+l);r.innerHTML='<input type="checkbox" checked="'+a.isChecked+'"><span class="bf-checkbox"></span>',this.checkbox=r,o.appendChild(r),r.addEventListener("click",function(e){var t=r.getElementsByTagName("input")[0].checked,a=t?"unchecked":"checked";n.setCheckedState(!t),n.eventManager.fireEvent("CheckedChanged",a,n)})}var s=i.create("span","bf-tree-name");if(t=t||BimfaceLanguage.bf_panel_modelTree_nameUndefined,s.textContent=t,n.setTitle(t),s.addEventListener("click",function(e){if(n._enabled)if(n._selection){var t=this.hasClass("bf-selected");t?n.deselect():n.select(),t=!t,n._selectionState=t?"selected":"unselected",n.eventManager.fireEvent("SelectionChanged",n,t)}else n.toggleExpansion()}),a.icon&&(this.icon=a.icon,o.appendChild(a.icon.element),this.icon.addEventListener("Change",function(e){n._iconState="default"==e,n.setChildrenIconState(e),n.eventManager.fireEvent("IconChanged",n,e)})),a.hasExpand){var c=i.create("span","bf-icon"),o=this.treeNode;c.addEventListener("click",function(){n.toggleExpansion();var e=void 0;e=!o.hasClass("bf-collapse"),n.eventManager.fireEvent("ExpandChanged",n,e)}),o.appendChild(c)}o.appendChild(s),this.element.appendChild(o),this.treeName=s,this.id=e,this.name=t},o.prototype.addChildNode=function(e){var t=this;if(this._controls.push(e),e._parent=this,!this.subTree){var n=i.create("span","bf-icon"),a=this.treeNode;n.addEventListener("click",function(){t.toggleExpansion()}),a.insertBefore(n,this.treeNode.children[0]),this.subTree=i.create("div","bf-sub-tree"),this.element.appendChild(this.subTree)}this.subTree.appendChild(e.element),e.addEventListener("CheckedChanged",function(e,n){n._opt.propagation&&t.setParentCheckedState(n),t.eventManager.fireEvent("CheckedChanged",e,n)}),e.addEventListener("SelectionChanged",function(e,n,a){t.eventManager.fireEvent("SelectionChanged",e,n,a)}),e.addEventListener("IconChanged",function(n,a){e._opt.propagation&&t.setParentIconState(e),t.eventManager.fireEvent("IconChanged",n,a)})},o.prototype.removeChildNode=function(e){var t=this._controls.getObjectByAttribute("id",e);this.subTree.removeChild(t.element),this._controls.removeObjectByAttribute("id",e)},o.prototype.getChildNode=function(){return this.subTree},o.prototype.getCheckedState=function(){return this._checkedState},o.prototype.getIconState=function(){return this._iconState},o.prototype.getSelectionState=function(){return this._selectionState},o.prototype.getConfig=function(){return this._opt},o.prototype.getParent=function(){return!!this._parent&&this._parent},o.prototype.setCheckedState=function(e){var t=this._opt;this._checkedState=e?"checked":"unchecked",t.hasCheckbox&&this.checkbox&&(this.checkbox.getElementsByTagName("input")[0].checked=e,this.checkbox.toggleClass("bf-checked",e),this.checkbox.toggleClass("bf-unchecked",!e),this.checkbox.removeClass("bf-half")),this.setChildrenCheckedState(e)},o.prototype.setIconState=function(e){this.icon&&(this.icon.setState(e),this.setChildrenIconState(e),this._iconState="default"==e)},o.prototype.setParentCheckedState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n,a=0,i=t.length;a<i;a++){var o=t[a].getCheckedState();n?o!=n&&(n="half"):n=o}this._checkedState=n}switch(this._checkedState){case"checked":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-checked"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-half");break;case"unchecked":this.checkbox.getElementsByTagName("input")[0].checked=!1,this.checkbox.addClass("bf-unchecked"),this.checkbox.removeClass("bf-checked"),this.checkbox.removeClass("bf-half");break;case"half":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-half"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-checked")}},o.prototype.setChildrenCheckedState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var a=0;a<n;a++)t[a].setCheckedState(e)},o.prototype.setParentIconState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n=!1,a=0,i=t.length;a<i;a++){var o=t[a].getIconState();if(o){n=o;break}}this._iconState=n}n?this.icon.setState("default"):this.icon.setState("change")},o.prototype.setChildrenIconState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var a=0;a<n;a++)t[a].setIconState(e)},o.prototype.expand=function(){var e=this;this.treeNode.removeClass("bf-collapse"),this.eventManager.fireEvent("Expand",e)},o.prototype.collapse=function(){var e=this;this.treeNode.addClass("bf-collapse"),this.eventManager.fireEvent("Collapse",e)},o.prototype.toggleExpansion=function(e){var t=this;this.treeNode.hasClass("bf-collapse")?t.expand():t.collapse()},o.prototype.select=function(){if(this._selection)return this.treeName.addClass("bf-selected")},o.prototype.deselect=function(){this.treeName&&this.treeName.removeClass("bf-selected")},o.prototype.disabled=function(){this._enabled=!1,this.treeName.addClass("bf-disabled")},o.prototype.enabled=function(){this._enabled=!0,this.treeName.removeClass("bf-disabled")},o.prototype.addNode=function(e){this.treeNode.appendChild(e)},o.prototype.removeNode=function(e){this.treeNode.appendChild(e)},o.prototype.setAttribute=function(e,t){this.treeNode.setAttribute(e,t)},n.TreeNode=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tree"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-tree",title:"tree",icon:null,hasCheckbox:!0,isChecked:!0,enabled:!0,selection:!0,propagation:!0,hasExpand:!1};return Object.assign(n,e)};t.TreeNodeConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Select"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-select",options:["请选择"],prefix:"",suffix:"",position:"bottom",default:null};return Object.assign({},n,e)};t.SelectConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Select"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=function(e){this._controls=e.options,t.Control.call(this,e);var n=this;n._opt=e;var a=i.create("span","bf-select-current");a.addEventListener("click",function(){a.toggleClass("bf-open")}),document.addEventListener("mousedown",function(e){e.target.closest(".bf-select")||a.removeClass("bf-open")}),n._currentElement=a,e.default?n.setCurrentOption(e.default):n.setCurrentOption(e.options[0].id);for(var o=i.create("ul","bf-select-list bf-scroll-bar"),l=n._controls,r=0,s=l.length;r<s;r++){var c=n.createElement(l[r]);o.appendChild(c)}n.element.appendChild(n._currentElement),n.element.appendChild(o),e.element&&e.element.appendChild(n.element),"top"===e.position&&o.addClass("bf-select-top")};a.Type.inheritPrototype(o,t.Control),o.prototype.setCurrentOption=function(t){if(!this.currentOption||t!=this.currentOption.id){var n=this.eventManager,a=this._controls,i=a.getObjectByAttribute("id",t);0!=i&&(this.currentOption=i,this._currentElement.innerText=""+this._opt.prefix+i.name+this._opt.suffix,n.fireEvent(e.Bimface.UI.Control.ControlEvent.Change,i))}},o.prototype.getCurrentOption=function(){return this.currentOption},o.prototype.createElement=function(e){var t=this,n=i.create("li","bf-select-option");return n.innerText=e.name,n.setAttribute("id",e.id),n.addEventListener("click",function(){t.setCurrentOption(e.id),t._currentElement.removeClass("bf-open")}),n},n.Select=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tabs"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={className:"bf-select",options:[{id:"default",name:"请选择",className:"bf-tabs-option",title:"请选择"}],default:null};return Object.assign({},n,e)};t.TabsConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tabs"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=function(e){this._controls=e.options,t.Control.call(this,e);var n=this,a=i.create("ul","bf-tabs-list");this.list=a;for(var o=n._controls,l=0,r=o.length;l<r;l++){var s=n.createElement(o[l]);a.appendChild(s)}e.default?n.setCurrentOption(e.default):n.setCurrentOption(e.options[0].id),n.element.appendChild(a),e.element&&e.element.appendChild(n.element)};a.Type.inheritPrototype(o,t.Control),o.prototype.setCurrentOption=function(t){for(var n=this.eventManager,a=this._controls,i=a.getObjectByAttribute("id",t),o=this.list.querySelectorAll("li"),l=0,r=o.length;l<r;l++)o[l].id==t?o[l].addClass("active"):o[l].removeClass("active");-1!=i&&(this.currentOption=i,n.fireEvent(e.Bimface.UI.Control.ControlEvent.Change,i))},o.prototype.getCurrentOption=function(){return this.currentOption},o.prototype.createElement=function(e){var t=this,n=(this.eventManager,i.create("li","bf-tabs-option "+e.className));return n.innerText=e.name,n.setAttribute("id",e.id),n.setAttribute("title",e.name),n.addEventListener("click",function(){t.getCurrentOption().id!=e.id&&t.setCurrentOption(e.id)}),n},o.prototype.addOption=function(e){if(!this._controls.getObjectByAttribute("id",e.id)){this._controls.push(e);var t=this.createElement(e);this.list.appendChild(t)}},n.Tabs=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tips"),n=new e.Bimface.UI.Control.ControlConfig,a=function(){var e={
className:"bf-tips",element:null,html:"提示",timeOut:0};return Object.assign({},n,e)};t.TipsConfig=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Control"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.UI.Tips"),a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=function(e){t.Control.call(this,e);var n=this,a=this.element,o=i.create("div","bf-tips-container"),l=i.create("div","bf-close");o.innerHTML=e.html,a.appendChild(o),a.appendChild(l),l.addEventListener("click",function(){n.hide()}),this.container=o,this.timeOut=e.timeOut,this.show()};a.Type.inheritPrototype(o,t.Control),o.prototype.close=function(){this.element.remove()},o.prototype.hide=function(){this.element.style.display="none"},o.prototype.show=function(){var e=this;e.element.style.display="",e.timeOut&&(clearTimeout(e.counter),e.counter=setTimeout(function(){e.hide()},e.timeOut))},o.prototype.getHtml=function(e){this.container.innerHTML=e},o.prototype.setHtml=function(e){return this.container.innerHTML},n.Tips=o}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={Toolbars:["MainToolbar","ModelTree"],navigatorType:"",Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"],effectMode:"performance"},n=e.Bimface.Viewer.Viewer3DConfig();return Object.assign({},t,n)};t.WebApplication3DConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",Rendered:"Rendered",PureRender:"PureRender",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",MouseDoubleClicked:"MouseDoubleClicked",ContextMenu:"ContextMenu",RectSelection:"RectSelection",Error:"Error",AddView:"AddView",RemoveView:"RemoveView",FamilyTypeChanged:"FamilyTypeChanged",MissingDrawingElement:"MissingDrawingElement",ToolbarHomeClick:"ToolbarHomeClick",DemandLoaded:"DemandLoaded",ButtonOnToolbarClicked:"ButtonOnToolbarClicked",AxisGridHover:"AxisGridHover",FloorExplosion:"FloorExplosion",Hover:"Hover",MouseMove:"MouseMove",ViewChanged:"ViewChanged",ModelAdded:"ModelAdded"});t.WebApplication3DEvent=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom")),a=e.Bimface.Data.StatisticsDataManager.getInstance(),i=function(t){t.navigatorType&&e.Web.Lang.Utility.ClientHelper.setNavigatorType(t.navigatorType);var i,o=e.Web.Lang.Utility.ClientHelper.getIsDesktop();if(o)i=n.create("div","bf-container");else{t.Toolbars=["MainToolbar","ModelTree"],t.Buttons=["Home","ViewButton","Measure","Section","Walk","MobileProperty"],t.enableViewHouse=!1,i=n.create("div","bf-container  bf-mobile ");var l=t.domElement.offsetWidth,r=t.domElement.offsetHeight;i.style.fontSize=90*Math.min(l,r,414)/750+"px"}var s=this,c=t;t.domElement.appendChild(i),c.domElement=i,this.getViewer=function(){return d},this.getEventManager=function(){return u},this.getToolbars=function(){return s.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),s.UI.getToolbar(e)},this.getPanel=function(e){return s.UI.getPanel(e)},this.getPlugin=function(e){return s.UI.getPlugin(e)},this.render=function(){this.getViewer().render()},this.addView=function(e,t,n){d.addView(e,t,n)},this.getAnnotationManager=function(){return s.getPlugin("Annotation")},this.destroy=function(){this.UI.destroy(),this.UI=null,d.destroy(),d=null,i.onclick=null,i.remove()},this.addEventListener=e.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=e.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new e.Bimface.Viewer.Viewer3D(c),f=e.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(f.ViewAdded,function(){s.UI.init();var e=d.getViewer(),t=e.getNumOfElements(),n=e.getNumOfTriangles(),i=void 0,o=d._data.modelType;i="singleMode"==o?"model":o;var l={eventId:"加载",loadModel:"normal",type:i,elements:t,triangles:n};a.send("Glodon.Bimface.Application.WebApplication3D","ViewAdded",l)}),d.addEventListener(f.ViewChanged,function(){s.UI&&s.UI.updateModelTree()}),d.addEventListener(f.AddView,function(n){if(1===n){var a=new e.Bimface.Application.UI.UIConfig;a=Object.assign(a,t),a.element=i,a.viewer=d,s.UI=new e.Bimface.Application.UI.UI(a)}}),d.addEventListener(f.RemoveView,function(e){0==e&&(s.UI.destroy(),s.UI=null)}),o&&(i.onclick=function(){var e=document.activeElement,t=document.getElementById("cloud-main-canvas");t&&e!=t&&"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName&&t.focus()})};t.WebApplication3D=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={Toolbars:["MainToolbar"],Buttons:["Home","Measure","Section","Property","Explode","Setting","FullScreen"],EnableFamilyList:!0},n=e.Bimface.Viewer.Viewer3DConfig();return n.enableExplosion=!0,Object.assign({},t,n)};t.WebApplicationRfaConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error"});t.WebApplicationRfaEvent=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=e.Bimface.UI.Control.ControlEvent,o=new e.Bimface.UI.Button.ButtonConfig;o.id="Home",o.title=BimfaceLanguage.bf_btn_home,o.className="bf-button gld-bf-home";var l=new e.Bimface.UI.Button.Button(o);if("ViewerDrawing"==a.viewerType)l.addEventListener(i.Click,function(){a.home()});else{var r=a instanceof e.Bimface.Viewer.Viewer3D,s=e.Bimface.Viewer.Viewer3DEvent;l.addEventListener(i.Click,function(){var e=n.getControl("ViewButton");e&&e.recover();var t=n.getControl("Interactive");if(t&&t.hideDropDownList(),r){if(a.getViewHouseIsLoaded())a.getEventManager().fireEvent(s.ToolbarHomeClick);else{var i=a.getCustomHomeview()||a.getDefaultHomeview();a.setCameraStatus(i)}}else a.home()})}return l};t.Home=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=e.Bimface.Viewer.NavigationMode3D,r={OrbitPoint:l.PickWithRect,OrbitCamera:l.Fly},s=new e.Bimface.UI.Button.ButtonConfig;s.id="OrbitButton",s.title="导航",s.inheritTitle=!0;var c=new e.Bimface.UI.Button.ComboBox(s),d=new e.Bimface.UI.Button.ButtonConfig;d.id="OrbitPoint",d.title="绕构件旋转",d.className="bf-button gld-bf-orbitpoint";var f=new e.Bimface.UI.Button.ComboBoxOptionButton(d),u=new e.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-orbitcamera";var m=new e.Bimface.UI.Button.ComboBoxOptionButton(u);return c.addControl(f),c.addControl(m),c.addEventListener(o.Change,function(e){n.getControl("Section").setCheckedState(!1),a.setNavigationMode(r[e.id])}),c};t.OrbitButton=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=(t.getRootElement(),a instanceof e.Bimface.Viewer.Viewer3D),o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="Home",l.title="Home",l.className="bf-button gld-bf-scene";var r=new e.Bimface.UI.Button.ComboBoxOptionButton(l),s=new e.Bimface.UI.Button.ButtonConfig;s.id="ViewButton",s.title="视角",s.className="bf-combobox viewButton",s.inheritTitle=!0,s.home=r;var c=new e.Bimface.UI.Button.TouchComboBox(s);c.element.addClass(BimfaceLanguage.name);var d={Top:"top",Bottom:"bottom",East:"right",South:"front",West:"left",North:"back"};for(var f in d){var u=d[f],m=new e.Bimface.UI.Button.ButtonConfig;m.id=f,m.title=f,m.className="bf-button";var p=new e.Bimface.UI.Button.ComboBoxOptionButton(m);p.setHtml('<svg class="gld-bf-scene-inner"><use class="" xlink:href="#gld-bf-scene-'+u+'"></use></svg>'),c.addControl(p)}return c.addEventListener(o.Change,function(e){a.setView(e.id)}),document.querySelector(".bf-mobile").addEventListener("touchstart",function(e){if("canvas"==e.target.tagName.toLowerCase()){var t=document.querySelector(".gld-bf-view.bf-checked");t&&t.click()}}),c};t.ViewButton=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent,l=e.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var r=new e.Bimface.UI.Button.ButtonConfig;r.id="RectangleSelect",r.title=BimfaceLanguage.bf_btn_zoom,r.className="bf-button gld-bf-zoomrect";var s=new e.Bimface.UI.Button.ToggleButton(r),c=function(e){e.end&&s.setCheckedState(!1)};return s.addEventListener(o.StateChange,function(e){e?(a.enableZoomRect(!0),a.addEventListener(l.RectSelection,c)):(a.enableZoomRect(!1),a.removeEventListener(l.RectSelection,c))}),s};t.RectangleSelect=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=e.Bimface.UI.Control.ControlEvent,o=e.Bimface.Viewer.ViewerDrawingEvent,l=new e.Bimface.UI.Button.ButtonConfig;l.id="RectZoom",l.title=BimfaceLanguage.bf_btn_zoom,l.className="bf-button gld-bf-zoomrect";var r=new e.Bimface.UI.Button.ToggleButton(l),s=function(){setTimeout(function(){r.setCheckedState(!1)},200)};return r.addEventListener(i.StateChange,function(e){if(e)a.rectZoom(),a.addEventListener(o.ViewZoomed,s);else{var t=n.getControl("Measure");t&&t._checked?a.getViewer().mouseEditorMgr.activeEditorByName("measure"):a.getViewer().mouseEditorMgr.activeEditorByName("pick"),a.removeEventListener(o.ViewZoomed,s)}}),r};t.RectZoom=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=function(t,n,a){var i=this,o=e.Bimface.Viewer.Viewer3DEvent,l=t.getDefaultModel(),r=function(e){for(var t=[],n=0;n<e.length;n++){for(var a=e[n].name,i=e[n].parameters,o=[],l=0;l<i.length;l++)o=o.concat(i[l].items);t=t.concat([{group:a,items:o}])}return t},s=function(){p._tab&&"components"!=p._tab.getCurrentOption().id?p.setTips(BimfaceLanguage.bf_panel_props_matSel):p.setTips(BimfaceLanguage.bf_panel_props_propSel)},c=function(e){var n=void 0;return t.getModels().some(function(t){var a=[];if(a=e?e[t.modelId]||[]:t.getSelectedComponents(),n||1!==a.length){if(a.length>1||1===a.length&&n&&n.id!==a[0])return n=void 0,!0}else n={modelId:t.modelId,id:a[0]}}),n},d=function(e,n){var a=n?e:c(e);if(p.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),p.clear(),!a)return void("rfaView"==l._data.renderType?l.getFamilyProperty(l._data.familyTypeId,function(e){p.setTips(BimfaceLanguage.bf_panel_props_propSel),p.setData(e.properties)},function(e){s(),p.setData("")}):(s(),p.setData("")));!p._tab||p._tab&&"components"==p._tab.getCurrentOption().id?t.getModel(a.modelId).getComponentProperty(a.id,function(e){p.setTips(BimfaceLanguage.bf_panel_props_propSel),p.setData(e.properties)},function(e){s(),p.setData("")}):(!p._tab||p._tab&&"components"!=p._tab.getCurrentOption().id)&&(e?t.getModel(a.modelId).getMaterialProperty(a.id,function(e){if(p.setTips(BimfaceLanguage.bf_panel_props_matSel),e&&e.length>0){var t=r(e);p.setData(t,!0)}else p.setData("")},function(){p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("")}):p.setData(""))},f=function(e){var n=c();if(!n&&"rfaView"!=l._data.renderType)return"components"==e?p.setTips(BimfaceLanguage.bf_panel_props_propSel):p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("");"components"==e?d(n,!0):(p.setData(""),t.getModel(n.modelId).getMaterialProperty(n.id,function(e){if(e&&e.length>0){var t=r(e);p.setData(t,!0)}else s(),p.setData("")},function(){s(),p.setData("")}))};if(p)return p.show(),t.addEventListener(o.ComponentsSelectionChanged,d),p;var u=new e.Bimface.UI.Panel.PanelConfig;u.title=BimfaceLanguage.bf_btn_props,u.className="bf-panel property-panel",u.id="property";var m=e.Web.Lang.Utility.ClientHelper.getIsDesktop();u.css=m?{right:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%"};var p=new e.Bimface.UI.Panel.Panel(u);p.setTips(BimfaceLanguage.bf_panel_props_propSel),t.propertyPanel=p,p.addClass("property-panel"),p.addClass("bf-property-panel");var g=[{id:"components",name:BimfaceLanguage.bf_panel_props_props},{id:"material",name:BimfaceLanguage.bf_panel_props_mats}];if(!i._tab&&t._manifest.Features.HasMaterialProperty){var h=new e.Bimface.UI.Tabs.TabsConfig;h.className="bf-property-tab",h.default="components",h.options=g;var b=new e.Bimface.UI.Tabs.Tabs(h);b.addEventListener(e.Bimface.UI.Control.ControlEvent.Change,function(e){f(e.id)}),p._tab=b,p.setContainerHeader(b.element)}return f("components"),t.addEventListener(o.SelectionChangedInModel,d),p.addEventListener("Hide",function(){t.removeEventListener(o.SelectionChangedInModel,d)}),p.initProperty=f,p};t.PropertyPanel=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="Property",s.title=BimfaceLanguage.bf_btn_props,s.className="bf-button gld-bf-properties";var c,d=new e.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(l.StateChange,function(o){o?(c=new e.Bimface.Application.UI.Panel.PropertyPanel(a,i,n),c.addEventListener("Hide",function(){d.setCheckedState(!1)}),i.appendChild(c.element),c.bringToFront(),c.initPosition(),t.addPanel(c)):(c.close(),t.removePanel(c.id)),a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:o})}),d};t.Property=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var r=new e.Bimface.UI.Button.ButtonConfig;r.id="MobileProperty",r.title="属性",r.className="bf-button gld-bf-properties";var s,c=new e.Bimface.UI.Button.ToggleButton(r);return c.addEventListener(l.StateChange,function(){c.isChecked()?(s=new e.Bimface.Application.UI.Panel.PropertyPanel(a,i,n),s.addEventListener("Hide",function(){"none"!=s.element.style.display&&i.removeChild(s.element),c.setCheckedState(!1)}),i.appendChild(s.element),t.addPanel(s)):(i.removeChild(s.element),t.removePanel(s.id))}),c};t.MobileProperty=n}();var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"formatDistance",value:function(e,t){if(void 0==e)return null;var n=t.precision,a=t.scale||1,i=t.unit,o=t.defaultUnit,l=1;return"Centimeter"===i?l=10:"Meter"===i?l=1e3:"Kilometer"===i&&(l=1e6),"m"===o&&(a*=1e3),e*=a,e/=l,this.formatPrecision(e,n)}},{key:"formatArea",value:function(e,t){var n=t.precision,a=t.scale,i=t.unit,o=t.defaultUnit,l=1;return"Centimeter"===i?l=100:"Meter"===i?l=1e6:"Kilometer"===i&&(l=1e13),"m"===o&&(a*=1e3),e*=Math.pow(a,2),e/=l,this.formatPrecision(e,n)}},{key:"getPostFix",value:function(e,t){if("None"===e)return"";var n={None:"",Kilometer:"km",Meter:"m",Centimeter:"cm",Millimeter:"mm"},a=n[e];return t?a+="²":a=" "+a,a}},{key:"toLocaleString",value:function(e){var t=e.toString(),n=/\d{1,3}(?=((\d{3})+(\.\d+)?)$)/g;return t=t.replace(n,"$&,")}},{key:"formatPrecision",value:function(e,t){if(e=parseInt(Math.round(e*Math.pow(10,t)))/Math.pow(10,t),0!=t){var n=e.toFixed(t).split(".");e=n[0]+"."+n[1]}else e=this.toLocaleString(e);return e}}]),e}();!function(){var t,n,a=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),o=function(i,o){var l=e.Web.Lang.Utility.ClientHelper.getIsDesktop();n=i._opt.viewer;var s,c=a.create("div","bf-tab-container"),d=a.create("div","bf-tab-body"),f=a.create("div","bf-tab-foot"),u=a.create("ul","bf-measure-tab"),m=a.create("div","bf-measure-tabface");m.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                            <i class="gld-bimface gld-bf-distance" ></i>\n                        </li>',u.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                  <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="MinimumDistance">\n                  <i class="gld-bimface gld-bf-distance-min" title="'+BimfaceLanguage.bf_tip_measure_mindis+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Angle">\n                  <i class="gld-bimface gld-bf-angle" title="'+BimfaceLanguage.bf_tip_measure_angle+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Elevation">\n                  <i class="gld-bimface gld-bf-elevation" title="'+BimfaceLanguage.bf_tip_measure_elevation+'"></i>\n                </li>';for(var p=i.type,g=u.querySelectorAll(".bf-measure-tab-item"),h=0;h<g.length;h++){g[h].getAttribute("data-type")===p&&g[h].addClass("bf-active"),g[h].addEventListener("click",function(){for(var e=0;e<g.length;e++)g[e].removeClass("bf-active");var t=this.getAttribute("data-type");this.addClass("bf-active"),i.setMeasureType(t);var n=i.getSelectedItem(),a=n&&n.type==t?i.drawableManager.mapMeasureInfo[n.getId()]:{};M(t,a)})}f.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_clearAll+"<div>",f.addEventListener("click",function(){i.clear()});var b=a.create("span","bf-clear-all gld-bf-measure-settings");b.addEventListener("click",function(e){C(),e.preventDefault(),e.stopPropagation()}),c.appendChild(u),c.appendChild(d),l&&(c.appendChild(f),f.appendChild(b));var v={Millimeter:"mm",Centimeter:"cm",Meter:"m",Kilometer:"km"},y=function(e){if(e){s.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=s.element.querySelector(".bf-close");t.style.display="block",B.style.display="none",c.style.display="block"}else{var t=s.element.querySelector(".bf-close");t.style.display="none",s.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),B.style.display="block",c.style.display="none"}},C=function(t){y(!1);var n,a=i.getUnits(),o=i.getPrecision();"object"==(void 0===o?"undefined":_typeof(o))&&(o=o.distance),n='<ul class="bf-measure-setting">\n                <li class="bf-measure-lengthUnits">\n                  <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                  <div class = 'unit'></div>\n                </li>\n                <li class=\"bf-measure-prompt\">"+BimfaceLanguage.bf_panel_measure_unitsTip+'</li>\n                <li class="bf-measure-precision">\n                  <span >'+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                  <div class = 'unit'></div>\n                </li>\n\n              </ul>",w.innerHTML=n;var l={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},r=new e.Bimface.Application.Button(l);for(var s in v){var c=v[s],d={type:"ComboBoxOptionButton",title:c,id:s,className:"bf-button",html:'<span class="bf-button-name">'+c+"</span>"};r.addControl(new e.Bimface.Application.Button(d))}r.setSelectedControlById(a.distance),w.querySelector(".bf-measure-lengthUnits .unit").appendChild(r.element),r.element.onclick=function(){u.element.removeClass("bf-expand")};var f={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},u=new e.Bimface.Application.Button(f),m={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var s in m){var c=m[s],d={type:"ComboBoxOptionButton",title:c,id:s.toString(),className:"bf-button",html:'<span class="bf-button-name">'+c+"</span>"};u.addControl(new e.Bimface.Application.Button(d))}u.setSelectedControlById(o),w.querySelector(".bf-measure-precision .unit").appendChild(u.element),u.element.onclick=function(){r.element.removeClass("bf-expand")},L.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",L.querySelector(".save").onclick=function(){var e=u.getCurrentControl().id,t=r.getCurrentControl().id;i.setPrecision({distance:e,elevation:e,angle:e}),i.setUnits({distance:t,elevation:t}),y(!0),M(i.type,{}),i.getEventManager().fireEvent("MeasureParamsUpdated")},L.querySelector(".cancel").onclick=function(){y(!0)}},B=a.create("div","bf-setting-container"),w=a.create("div","bf-setting-body"),L=a.create("div","bf-setting-foot");B.appendChild(w),B.appendChild(L);var M=function(t,n){var a=void 0,o=i.getUnits(),l="None"!=o.distance&&"<span class='units'>"+v[o.distance]+"</span>"||"",s="None"!=o.elevation&&"<span class='units'>"+v[o.elevation]+"</span>"||"";switch(t){case e.Bimface.Plugins.Measure.MeasureTypeOption.Distance:var c=void 0!==n.distance?T(n.distance):"--",f=void 0!==n.distanceX?T(n.distanceX):"--",u=void 0!==n.distanceY?T(n.distanceY):"--",m=void 0!==n.distanceZ?T(n.distanceZ):"--";a='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_distance+'：\n                    <span class="bf-measure-value">'+c+"</span>"+l+'\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                  </li>\n                  <li class="bf-measure-x">X： '+f+'</li>\n                  <li class="bf-measure-y">Y： '+u+'</li>\n                  <li class="bf-measure-z">Z： '+m+"</li>\n                </ul>",d.innerHTML=a,d.querySelector(".gld-bf-reset-box").addEventListener("click",function(){i.reset()});break;case e.Bimface.Plugins.Measure.MeasureTypeOption.Angle:var p=void 0!==n.angle?r.formatPrecision(n.angle,i.getMeasureParams().precision):"--";a='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_angle+'：\n                      <span class="bf-measure-value">'+p+'</span> °\n                      <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  </ul>',d.innerHTML=a,d.querySelector(".gld-bf-reset-box").addEventListener("click",function(){i.reset()});break;case e.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance:var c=void 0!==n.distance?T(n.distance):"--";a='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_mindis+'：\n                      <span class="bf-measure-value">'+c+"</span>"+l+"\n                    </li>\n                  </ul>",d.innerHTML=a;break;case e.Bimface.Plugins.Measure.MeasureTypeOption.Elevation:var g="--";n.points&&(g=T(n.points[0].z),0==g.split(" ")[0]&&(g="±"+g)),a='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_elevation+'：\n                    <span class="bf-measure-value">'+g+"</span> "+s+'\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                    </li>\n                  </ul>',d.innerHTML=a,d.querySelector(".gld-bf-reset-box").addEventListener("click",function(){i.reset()})}},T=function(e){return r.formatDistance(e,i.getMeasureParams())},S=new e.Bimface.UI.Panel.PanelConfig;if(S.title=BimfaceLanguage.bf_btn_measure,S.id="MeaurePanel",S.css=l?{right:"10px",bottom:"270px",width:"200px",height:"240px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"2em"},S.enableSizable=!1,S.className="bf-panel bf-measurement-panel",i.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Measuring,function(e){M(e.type,{})}),i.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Measured,function(t){M(t.type,t),t.type==e.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance&&(i.measureItem.setMinDistanceLine(t),i.measureItem.draw())}),i.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){var t=u.querySelectorAll(".bf-measure-tab-item"),n=!0,a=!1,o=void 0;try{for(var l,r=t[Symbol.iterator]();!(n=(l=r.next()).done);n=!0){l.value.removeClass("bf-active")}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}var s=!0,c=!1,d=void 0;try{for(var f,m=t[Symbol.iterator]();!(s=(f=m.next()).done);s=!0){var p=f.value;if(p.getAttribute("data-type")===e.type){p.addClass("bf-active");break}}}catch(e){c=!0,d=e}finally{try{!s&&m.return&&m.return()}finally{if(c)throw d}}i.setMeasureType(e.type),M(e.type,e)}),i.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){M(i.type,{})}),i.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){M(i.getMeasureType(),{})}),s=new e.Bimface.UI.Panel.Panel(S),n=i._opt.viewer,s.container.appendChild(c),s.container.appendChild(B),!l){var x=o.offsetWidth,k=o.offsetHeight;s.element.style.fontSize=100*Math.min(x,k,414)/750+"px",s.element.addClass("measure-panel");var I=s.element.querySelector(".bf-measure-tab"),_=s.element.querySelector(".bf-close");_.innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",I.measure=i,t=I.querySelectorAll(".bf-measure-tab-item");var E;I.id="measureTabs",I.addEventListener("click",function(n){I.hasClass("tab-open")?(I.removeClass("tab-open"),s.element.removeClass("tab-open")):(I.addClass("tab-open"),s.element.addClass("tab-open")),n.target.hasClass("gld-bf-distance")?(E=t[0],s.element.removeClass("miniStyle"),M(e.Bimface.Plugins.Measure.MeasureTypeOption.Distance,{}),I.measure.setMeasureType(e.Bimface.Plugins.Measure.MeasureTypeOption.Distance)):n.target.hasClass("gld-bf-angle")?(E=t[2],s.element.addClass("miniStyle"),M(e.Bimface.Plugins.Measure.MeasureTypeOption.Angle,{}),I.measure.setMeasureType(e.Bimface.Plugins.Measure.MeasureTypeOption.Angle)):(E=t[3],s.element.addClass("miniStyle"),M(e.Bimface.Plugins.Measure.MeasureTypeOption.Elevation,{}),I.measure.setMeasureType(e.Bimface.Plugins.Measure.MeasureTypeOption.Elevation)),I.querySelector(".bf-active").removeClass("bf-active"),E.addClass("bf-active"),m.innerHTML="",m.appendChild(E.cloneNode(!0)),n.preventDefault(),n.stopPropagation()},!0),m.addEventListener("click",function(e){I.hasClass("tab-open")?(I.removeClass("tab-open"),s.element.removeClass("tab-open")):(I.addClass("tab-open"),s.element.addClass("tab-open"))}),_.addEventListener("click",function(e){_.click()},!0),s.element.appendChild(I),s.element.appendChild(m)}return"rfaView"==n._data.renderType&&u.addClass("bf-measure-tab-rfa"),M(i.getMeasureType(),{}),s};i.MeasurePanel=o}();var s=function(e){var t=e.getToolbar("MainToolbar");if(t){var n=t.getControl("Section");if(n){var a=n.getToolbar();if(a){a.getControl("SectionBox").setCheckedState(!1);a.getControl("SectionPlane").setCheckedState(!1);a.getControl("PickSectionPlane").setCheckedState(!1)}else n.setCheckedState(!1)}}},c=function(e){s(e),d(e),f(e)},d=function(e){var t=e.getPlugin("SectionPlane");t&&(t.exit(),e.removePlugin("SectionPlane"))},f=function(e){var t=e.getPlugin("SectionBox");t&&(t.exit(),e.removePlugin("SectionBox"))},u=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane");t&&t.restore(),n&&(n.restoreRotation(),n.setProgress(0))},m=function(e,t){var n=e.getViewer(),a=e.getPlugin("SectionBox");if(!a){var i=e.getToolbar("MainToolbar");if(i){var o=i.getControl("Section");if(o){o.getToolbar().getControl("SectionBox").setCheckedState(!0),a=e.getPlugin("SectionBox")}}}a.setBox(t),n.zoomToBoundingBox(t)},p=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane"),a=e.getToolbar("MainToolbar"),i={enable:!1,button:null};(t||n)&&(i.enable=!0);var o=a.getControl("Section");if(o){var l=o.getToolbar(),r=l.getControl("SectionBox"),s=l.getControl("SectionPlane");r.isChecked()&&(i.button=r),s.isChecked()&&(i.button=s)}return i};!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Web.Lang.Utility.ClientHelper.getIsIphone(),function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var c=new e.Bimface.UI.Button.ButtonConfig;c.id="Measure",c.title=BimfaceLanguage.bf_btn_measure,c.className="bf-button gld-bf-measure";var d,f=new e.Bimface.UI.Button.ToggleButton(c),u=new e.Bimface.Plugins.Measure.MeasureConfig;u.viewer=a;var m;return f.addEventListener(l.StateChange,function(o){if(o){e.Web.Lang.Utility.ClientHelper.getIsDesktop();s(t);var l=n.getControl("Explode");l&&l.setCheckedState(!1),m=t.getPlugin("Measure"),m||(m=new e.Bimface.Plugins.Measure.Measure(u),m.id="Measure",t.addPlugin(m)),m.switchOn(),d=new e.Bimface.Application.UI.Panel.MeasurePanel(m,i),d.addEventListener("Hide",function(){f.setCheckedState(!1)}),i.appendChild(d.element),d.bringToFront(),d.initPosition(),t.addPanel(d)}else t.removePanel(d.id),d.close(),d=null,m.switchOff();a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:c.id,isChecked:o})}),f});t.Measure=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Web.Lang.Utility.ClientHelper.getIsIphone(),function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=e.Bimface.UI.Control.ControlEvent,l=new e.Bimface.UI.Button.ButtonConfig;l.id="DrawingMeasure",l.title=BimfaceLanguage.bf_btn_measure,l.className="bf-button gld-bf-measure";var r,s=new e.Bimface.UI.Button.ToggleButton(l),c=e.Bimface.Viewer.ViewerDrawingEvent,d=new e.Bimface.Plugins.Measure.MeasureConfig;d.viewer=a;var f;return s.addEventListener(o.StateChange,function(n){n?(f=t.getPlugin("DrawingMeasure"),f||(f=new e.Bimface.Plugins.Measure.Measure(d),f.id="DrawingMeasure",t.addPlugin(f)),f.switchOn(),r=new e.Bimface.Application.UI.Panel.DrawingMeasurePanel(f,i),r.addEventListener("Hide",function(){s.setCheckedState(!1)}),i.appendChild(r.element),r.bringToFront(),r.initPosition(),t.addPanel(r)):(t.removePanel(r.id),r.close(),r=null,f.switchOff()),a.getEventManager().fireEvent(c.ButtonOnToolbarClicked,{id:"Measure",isChecked:n})}),s});t.DrawingMeasure=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i="Viewer3D"==a.viewerType,o=(a.viewerType,e.Bimface.UI.Control.ControlEvent),l=new e.Bimface.UI.Button.ButtonConfig;l.id="Annotation",l.title="批注",l.className="bf-button gld-bf-notes";var r=new e.Bimface.UI.Button.Button(l),s=new e.Bimface.Plugins.Annotation.AnnotationToolbarConfig;s.viewer=t.getViewer();var c=self._annotation=new e.Bimface.Plugins.Annotation.AnnotationToolbar(s),d=e.Bimface.Plugins.Annotation.AnnotationToolbarEvent
;return r._annotationManager=c.getAnnotationManager(),r._annotationToolbar=c,t._plugins.push(r),r.addEventListener(o.Click,function(){n.hide();var e=n.getControl(i&&"Measure"||"DrawingMeasure");e&&e.setCheckedState(!1),c.show(),c.addEventListener(d.Saved,function(){n.show()}),c.addEventListener(d.Cancelled,function(){n.show()})}),r};t.Annotation=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(n){var a=n.getViewer(),i=(n.getRootElement(),new e.Bimface.UI.Panel.PanelConfig);i.title=BimfaceLanguage.bf_panel_section_box,i.id="SectionBoxPanel",i.css={right:"10px",bottom:"60px",width:"200px",height:"200px"},i.className="bf-panel bf-section-panel bf-sectionBox-panel",i.enableSizable=!1;var o,l=new e.Bimface.UI.Panel.Panel(i),r=n.getPlugin("SectionBox");return function(){var i=e.Bimface.Application.UI.Toolbar.SectionToolbarConfig(),s=e.Bimface.Application.UI.Toolbar.Toolbar(i,n),c=s.getControl("SectionReset");o=s.getControl("SectionBoxVisiable"),o.setCheckedState(!1);var d=s.getControl("SectionBoxReverse");c.addEventListener(e.Bimface.UI.Control.ControlEvent.Click,function(){o.setCheckedState(!1),d.setCheckedState(!1)});var f=t.create("div","bf-range-container"),u='<ul class="bf-range-list">\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_X+'</span>\n          <div class="bf-section-range" id="sectionX"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Y+'</span>\n          <div class="bf-section-range" id="sectionY"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Z+'</span>\n          <div class="bf-section-range" id="sectionZ"></div>\n        </li>\n      </ul>';if(f.innerHTML=u,l.addControl(s),l.container.appendChild(f),r&&r._sectionBox)r.showBox(),r.update();else{if(a._sectionBox)r=a._sectionBox;else{var m=new e.Bimface.Plugins.Section.SectionBoxConfig;m.viewer=a,m.id="SectionBox",r=new e.Bimface.Plugins.Section.SectionBox(m)}n.removePlugin("SectionBox"),n.addPlugin(r)}a.render()}(),l.hideBox=function(){o&&o.setCheckedState(!0)},l};n.SectionBoxPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=void 0;if(e.Web.Lang.Utility.ClientHelper.getIsDesktop()){var i=new e.Bimface.UI.Button.ButtonConfig;i.id="Section",i.title=BimfaceLanguage.bf_btn_section,i.className="bf-button bf-toolbar-button gld-bf-sectionbox",a=new e.Bimface.UI.Button.Button(i);var o=new e.Bimface.UI.Toolbar.ToolbarConfig;o.id="SectionSub",o.title=BimfaceLanguage.bf_btn_section,o.className="bf-sub-toolbar",o.buttons=["PickSectionPlane","SectionPlane","SectionBox"];var n=new e.Bimface.Application.UI.Toolbar.Toolbar(o,t);a.addToolbar(n)}else{var l=t.getViewer(),r=t.getRootElement(),s=l instanceof e.Bimface.Viewer.Viewer3D,d=e.Bimface.UI.Control.ControlEvent;if(!s)return void console.log("The API is not supported on this viewer.");var f=new e.Bimface.UI.Button.ButtonConfig;f.id="Section",f.title=BimfaceLanguage.bf_btn_section,f.className="bf-button gld-bf-section-axial",a=new e.Bimface.UI.Button.ToggleButton(f);var u;a.addEventListener(d.StateChange,function(i){if(i){var o=n.getControl("Measure");o&&o.setCheckedState(!1);var s=n.getControl("Explode");s&&s.setCheckedState(!1),u=new e.Bimface.Application.UI.Panel.PickSectionPlanePanel(t),u.addEventListener("Hide",function(){a.setCheckedState(!1)}),r.appendChild(u.element),u.bringToFront(),t.addPanel(u)}else c(t),u&&(t.removePanel(u.id),u.close(),l.render())})}return a};t.Section=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a,i,o,l=t.getViewer(),r=t.getRootElement(),s=l instanceof e.Bimface.Viewer.Viewer3D,c=e.Bimface.UI.Control.ControlEvent,d=e.Bimface.Viewer.Viewer3DEvent;if(!s)return void console.log("The API is not supported on this viewer.");var f=function(e,n){var a=t.getPlugin("SectionBox");if(a){var i=[n.from,n.to];a.setProgress(e,i),l.render()}},u=function(){var e=l._sectionBox;if(e){var t=e.getProgress("x");a.setProgress({from:t[0],to:t[1]});var n=e.getProgress("y");i.setProgress({from:n[0],to:n[1]});var r=e.getProgress("z");o.setProgress({from:r[0],to:r[1]})}},m=function(){var e=t.getToolbar("MainToolbar"),a=e.getControl("Measure");a&&a.setCheckedState(!1);var i=e.getControl("Explode");i&&i.setCheckedState(!1);var o=n.getControl("SectionPlane");o&&o.setCheckedState(!1);var l=n.getControl("PickSectionPlane");l&&l.setCheckedState(!1);var r=t.getPlugin("SectionPlane");r&&(t.removePlugin(r.id),r.exit())},p=new e.Bimface.UI.Button.ButtonConfig;p.id="SectionBox",p.title=BimfaceLanguage.bf_panel_section_box,p.className="bf-button gld-bf-sectionbox1";var g,h=new e.Bimface.UI.Button.ToggleButton(p);return h.addEventListener(c.StateChange,function(n){if(n)m(),g=new e.Bimface.Application.UI.Panel.SectionBoxPanel(t),g.addEventListener("Hide",function(){h.setCheckedState(!1)}),r.appendChild(g.element),g.initPosition(),a=new e.Web.Lang.Utility.Dom.multipleRange({element:g.element.querySelector("#sectionX"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){f("x",e)}}),i=new e.Web.Lang.Utility.Dom.multipleRange({element:g.element.querySelector("#sectionY"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){f("y",e)}}),o=new e.Web.Lang.Utility.Dom.multipleRange({element:g.element.querySelector("#sectionZ"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){f("z",e)}}),u(),l.addEventListener("Rendered",u),t.addPanel(g),l.render();else{var s=t.getPlugin("SectionBox");s&&s.hideBox(),g&&(t.removePanel(g.id),g.close(),l.render())}l.getEventManager().fireEvent(d.ButtonOnToolbarClicked,{id:p.id,isChecked:n})}),h};t.SectionBox=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(e){return e=parseFloat(e),e<0?360+e:e},i=function(n){var i=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=n.getViewer(),l=n.getRootElement(),r=new e.Bimface.UI.Panel.PanelConfig;r.title=BimfaceLanguage.bf_panel_section_plane,r.id="SectionPlanePanel",r.css=i?{right:"10px",bottom:"170px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},r.className="bf-panel bf-section-panel bf-sectionPlane-panel",r.enableSizable=!1;var s=new e.Bimface.UI.Panel.Panel(r),c=n.getPlugin("SectionPlane");if(c){var d=c.getProgress();c.setDirection(c.getDirection()),c.setPlane(c.getPlane()),c.setProgress(d)}return function(){var r=t.create("div","bf-section-plane-head"),d=new e.Bimface.UI.Select.SelectConfig;if(c&&(d.default=c._plane),d.className="bf-select bf-select-axial",i){var f=new e.Bimface.UI.Tabs.TabsConfig,u=t.create("div","bf-section-select");f.className="bf-tabs";var m=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];f.options=m,f.element=u;var p=new e.Bimface.UI.Tabs.Tabs(f),g=new e.Bimface.Application.UI.Button.SectionPlaneVisiable(n);s.toggleButton=g;var h=new e.Bimface.Application.UI.Button.SectionDirection(n);p.addEventListener("Change",function(e){c&&(c.setPlane(e.id),c.coordinateSystem.update(),o.render())}),r.appendChild(u)}else{d.options=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];var b=new e.Bimface.UI.Select.Select(d);s.select=b;var g=new e.Bimface.Application.UI.Button.SectionPlaneVisiable(n);s.toggleButton=g;var h=new e.Bimface.Application.UI.Button.SectionDirection(n);b.addEventListener("Change",function(e){c&&(c.setPlane(e.id),c.coordinateSystem.update(),o.render())}),r.appendChild(b.element)}var v=t.create("div","bf-section-range"),y=new e.Web.Lang.Utility.Dom.range({element:v,min:0,max:100,cur:50,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){c&&(c.setProgress(e),o.render())},change:function(e){c&&(c.setProgress(e),o.render())}}),C=t.create("div","bf-section-range");C.innerHTML='<i class="bf-range-icon gld-bf-rotate-vertical"></i>';var B=t.create("div","bf-section-range");B.innerHTML='<i class="bf-range-icon gld-bf-rotate-horizontal"></i>';var w=new e.Web.Lang.Utility.Dom.range({element:C,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){c&&(c.setRotateAngle(void 0,a(e)),o.render())},change:function(e){c&&(c.setRotateAngle(void 0,a(e)),o.render())}}),L=new e.Web.Lang.Utility.Dom.range({element:B,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){c&&(c.setRotateAngle(a(e),void 0),o.render())},change:function(e){c&&(c.setRotateAngle(a(e),void 0),o.render())}});if(o.addEventListener("Rendered",function(){var e=o._sectionPlane;if(e){var t=e.getProgress();0==i&&y.setProgress(t);var n=e.getRotateAngle();w.setProgress(n.angleB>180?n.angleB-360:n.angleB),L.setProgress(n.angleA>180?n.angleA-360:n.angleA)}}),s.container.appendChild(r),0==i&&s.container.appendChild(v),i?r.appendChild(g.element):r.appendChild(h.element),c&&i&&c._sectionTool)c.showPlane();else{var M=new e.Bimface.Plugins.Section.SectionPlaneConfig;M.viewer=o,M.id="SectionPlane",c=new e.Bimface.Plugins.Section.SectionPlane(M),n.removePlugin("SectionPlane"),n.addPlugin(c)}if(!i){var T=l.offsetWidth,S=l.offsetHeight;c.hidePlane(),s.element.style.fontSize=100*Math.min(S,T,414)/750+"px",s.element.addClass("section-panel");var x=s.element.querySelector(".bf-section-plane-head");s.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",s.element.appendChild(x)}o.render()}(),s};n.SectionPlanePanel=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="SectionPlane",s.title=BimfaceLanguage.bf_panel_section_plane,s.className="bf-button gld-bf-section-axial";var c,d=new e.Bimface.UI.Button.ToggleButton(s),f=function(){var e=t.getToolbar("MainToolbar"),a=e.getControl("Measure");a&&a.setCheckedState(!1);var i=e.getControl("Explode");i&&i.setCheckedState(!1);var o=n.getControl("SectionBox");o&&o.setCheckedState(!1);var l=t.getPlugin("SectionBox");l&&t.removePlugin(l.id);var r=n.getControl("PickSectionPlane"),s=t.getPlugin("SectionPlane");r&&(r._checked&&s&&(t.removePlugin(s.id),s.hidePlane(),s.exit()),r.setCheckedState(!1));var c=t.getPlugin("SectionPlaneForAreaTree");c&&(c.exit(),t.removePlugin("SectionPlaneForAreaTree"))};return d.addEventListener(l.StateChange,function(n){if(a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:d.isChecked()}),n){f();var o=a.getDomElement();c=new e.Bimface.Application.UI.Panel.SectionPlanePanel(t),c.addEventListener("Hide",function(){d.setCheckedState(!1),o.removeAttribute("style")}),o.style.cursor="default",i.appendChild(c.element),c.bringToFront(),t.addPanel(c),c.initPosition(),a.render()}else{var l=t.getPlugin("SectionPlane");l&&l.hidePlane(),c&&(t.removePanel(c.id),c.close(),a.render())}}),d};t.SectionPlane=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(n){var a=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=n.getViewer(),o=n.getRootElement(),l=new e.Bimface.UI.Panel.PanelConfig;l.title=BimfaceLanguage.bf_panel_section_selectPlane,l.id="PickSectionPlanePanel",l.css=a?{right:"10px",bottom:"170px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},l.className="bf-panel bf-section-panel bf-pickSectionPlane-panel",l.enableSizable=!1;var r=new e.Bimface.UI.Panel.Panel(l),s=void 0;if(function(){var t=new e.Bimface.UI.Toolbar.ToolbarConfig;t.id="SectionToolbar",t.className="bf-pick-section-plane",t.buttons=["SectionPlaneVisiable","PickSectionPlaneReset"],s=e.Bimface.Application.UI.Toolbar.Toolbar(t,n),r.addControl(s)}(),!a){var c=o.offsetWidth,d=o.offsetHeight;r.element.style.fontSize=100*Math.min(d,c,414)/750+"px",r.element.addClass("section-panel");var f=t.create("div","bf-button gld-bf-section-plane-pick"),u=r.element.querySelector(".bf-close"),m=r.element.querySelector(".gld-bf-reset-box");u.innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",r.element.querySelector(".bf-pick-section-plane").insertBefore(f,r.element.querySelector(".gld-bf-hide-slice")),f.addEventListener("touchend",function(e){i.enableSnap(!0),B.show();var t=n.getPlugin("SectionPlane");t&&t.hidePlane()});var p=new e.Bimface.Viewer.SnapMode,g=e.Bimface.Viewer.SnapObject.Face;p.setSnap3DList([g]),i.setSnapMode(p),i.enableSnap(!0);var h=function(e,t,n,a,o){var l=i.getViewer().cameraControl;if(null!=e){var r=l.scene.drawingToWorld(e);e.copy(r)}if(null!=t){var s=l.scene.drawingToWorld(t[0]),c=l.scene.drawingToWorld(t[1]);t[0].copy(s),t[1].copy(c)}return{pickPoint:e,pickLine:t,pickPlane:n,normal:a,userId:o}},b=void 0,v=function(e){if(B.showAuxBall){var t=n.getPlugin("SectionPlane");b=t.getOriginProgress(b),t.setOriginProgress(b)}},y=function(e,t){if(B.showAuxBall){n.getPlugin("SectionPlane").setOriginProgress(b+(t||0)),i.render()}else{var a=i.getViewer().pickToPoint(e,5),o=a?h(a.pickPoint,a.pickLine,a.pickPlane,a.face.normal,a.userId):{};i.snap.snapByPoint(o)}},C=function(t){if(B.showAuxBall);else{var a=i.getViewer().pickToPoint(t,5),o=n.getPlugin("SectionPlane");if(!a)return;B.showBall();var l=i.sceneToWorld(a.pickPoint);if(i.enableSnap(!1),l.addScalar(2),o&&o._sectionTool)o.setPositionByPlane(l,a.face.normal,0),o.showPlane();else{n.removePlugin("SectionPlane");var r=new e.Bimface.Plugins.Section.SectionPlaneConfig;r.viewer=i,r.id="SectionPlane",r.exitSectionBox=!1,o=new e.Bimface.Plugins.Section.SectionPlane(r),o.setPositionByPlane(l,a.face.normal,0),n.addPlugin(o),s.getControl("SectionPlaneVisiable").setCheckedState(!1)}i.render()}},B=new e.Bimface.Plugins.AuxMobile.AuxMobile({viewer:i,editor:{touchMoveCallback:y,touchEndCallback:C,touchStartCallback:v}}),w=void 0;B.canvas.addEventListener("touchstart",function(e){var t=e.touches[0];w={x:t.pageX,y:t.pageY},B.onTouchStart(e,w)}),B.canvas.addEventListener("touchmove",function(e){var t=e.touches[0];w={x:t.pageX,y:t.pageY},B.onTouchMove(e,w)}),B.canvas.addEventListener("touchend",function(e){B.onTouchEnd(e,w),w=null}),m.addEventListener("touchstart",function(e){B.show()}),r.addEventListener("Close",function(e){B.destroy()})}return r};n.PickSectionPlanePanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="PickSectionPlane",s.title=BimfaceLanguage.bf_panel_section_selectPlane,s.className="bf-button gld-bf-section-plane-pick";var c,d=new e.Bimface.UI.Button.ToggleButton(s),f=function(){var e=t.getToolbar("MainToolbar"),a=e.getControl("Measure");a&&a.setCheckedState(!1);var i=e.getControl("Explode");i&&i.setCheckedState(!1);var o=n.getControl("SectionBox");o&&o.setCheckedState(!1);var l=t.getPlugin("SectionBox");l&&l.hideBox();var r=n.getControl("SectionPlane");r&&r.setCheckedState(!1);var s=t.getPlugin("SectionPlane");s&&s.hidePlane();var c=t.getPlugin("SectionPlaneForAreaTree");c&&(c.exit(),t.removePlugin("SectionPlaneForAreaTree"))},u=function(){var n=a.getDomElement();c=new e.Bimface.Application.UI.Panel.PickSectionPlanePanel(t),c.addEventListener("Hide",function(){a.enableSnap(!1),d.setCheckedState(!1),n.removeAttribute("style")}),n.style.cursor="default",i.appendChild(c.element),c.bringToFront(),t.addPanel(c),c.initPosition()};return d.addEventListener(l.StateChange,function(n){if(a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:d.isChecked()}),n){f(),u();var i=new e.Bimface.Viewer.SnapMode,o=e.Bimface.Viewer.SnapObject.Face;i.setSnap3DList([o]),a.setSnapMode(i),a.enableSnap(!0)}else{var l=t.getPlugin("SectionPlane");l&&l.hidePlane(),c&&(t.removePanel(c.id),c.close(),a.render()),a.enableSnap(!1)}}),a.addEventListener(r.MouseClicked,function(n){var i=n.normal,o=n.worldPosition,l=n.objectId,r=n.snapPoint,s=a.snap&&a.snap.isOpen,c=r&&"Plane"==r.type,f=d._checked;if(s&&f&&a.removeSelectedId([l]),f&&s&&c){a.enableSnap(!1),o.addScalar(2);var u=t.getPlugin("SectionPlane");if(u&&u._sectionTool)u.setPositionByPlane(o,i,0),u.showPlane();else{t.removePlugin("SectionPlane");var m=new e.Bimface.Plugins.Section.SectionPlaneConfig;m.viewer=a,m.id="SectionPlane",m.exitSectionBox=!1,u=new e.Bimface.Plugins.Section.SectionPlane(m),u.setPositionByPlane(o,i,0),t.addPlugin(u)}a.render()}}),d};t.PickSectionPlane=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionBoxVisiable",l.title=BimfaceLanguage.bf_tip_section_hide,l.className="bf-button gld-bf-box-hide";var r=new e.Bimface.UI.Button.ToggleButton(l);return r.addEventListener(o.StateChange,function(e){var n=t.getPlugin("SectionBox");n&&(e?n.hideBox():n.showBox()),a.render()}),r};t.SectionBoxVisiable=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionPlaneVisiable",l.title=BimfaceLanguage.bf_tip_section_hide,l.className="bf-button gld-bf-hide-slice";var r=new e.Bimface.UI.Button.ToggleButton(l);return r.addEventListener(o.StateChange,function(e){var n=t.getPlugin("SectionPlane");n?e?n.hidePlane():n.showPlane():r.setCheckedState(!1),a.render()}),r};t.SectionPlaneVisiable=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionRotate",l.title="旋转",l.className="bf-button gld-bf-rotate-box";var r=new e.Bimface.UI.Button.ToggleButton(l);return r.addEventListener(o.Click,function(){var t=e.Bimface.Viewer.SectionBoxMode;r.isChecked()?a.setSectionBoxMode(t.Rotate):a.setSectionBoxMode(t.Default)}),r};t.SectionRotate=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionReset",l.title=BimfaceLanguage.bf_tip_section_resetBox,l.className="bf-button gld-bf-reset-box";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){var e=t.getPlugin("SectionBox");e&&e.reset(),a.render()}),r};t.SectionReset=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="PickSectionPlaneReset",l.title=BimfaceLanguage.bf_tip_section_resetBox,l.className="bf-button gld-bf-reset-box";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){var e=t.getPlugin("SectionPlane");e&&(t.removePlugin(e.id),e.exit()),a.enableSnap(!0),a.render()}),r};t.PickSectionPlaneReset=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=function(t){var n=new e.Bimface.UI.Panel.PanelConfig;n.title=BimfaceLanguage.bf_btn_info,n.css={left:"50%",top:"50%",width:"300px",height:"210px",transform:"translate(-50%,-50%)"},n.enableSizable=!1,n.className="bf-panel bf-basicInfo-panel";var a=t.getInformation(),i=new e.Bimface.UI.Panel.Panel(n),o='<div class="bf-info">\n                  <ul class="bf-info-list">\n                    <li>'+BimfaceLanguage.bf_panel_info_component+'<span class="bf-info-value">'+a.elements+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_mesh+'<span class="bf-info-value">'+a.triangles+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_vertex+'<span class="bf-info-value">'+a.vertices+'</span></li>\n                  </ul>\n                  <div class="bf-info-power">Powered by <a target="_blank" href="http://bimface.com/">bimface.com</a></div>\n                </div>';return i.setHtml(o),i};t.InformationPanel=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="Information",s.title=BimfaceLanguage.bf_btn_info,s.className="bf-button gld-bf-information";var c,d=new e.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(l.StateChange,function(n){n?c?c.show():(c=new e.Bimface.Application.UI.Panel.InformationPanel(a),c.addEventListener("Hide",function(){d.setCheckedState(!1)}),i.appendChild(c.element),c.bringToFront(),t.addPanel(c)):c.hide(),a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:n})}),d};t.Information=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=e.Bimface.UI.Control.ControlEvent,o=new e.Bimface.UI.Button.ButtonConfig;o.id="FullScreen",o.title=BimfaceLanguage.bf_btn_fullScreen,o.className="bf-button gld-bf-maximize";var l=new e.Bimface.UI.Button.ChangeButton(o);return l.addEventListener(i.Click,function(){var e=this.hasClass("gld-bf-maximize");a.enableFullScreen(e)}),e.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=l.getTitle();l.toggleClassName("gld-bf-maximize"),l.toggleClassName("gld-bf-minimize"),e==BimfaceLanguage.bf_btn_fullScreen_exit?l.setTitle(BimfaceLanguage.bf_btn_fullScreen):l.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit)}),l};t.FullScreen=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=(e.Bimface.Viewer.Viewer3D,e.Bimface.UI.Control.ControlEvent),o=new e.Bimface.UI.Button.ButtonConfig;o.id="FamilyList",o.title="FamilyList",o.className="bf-combobox bf-family";var l=new e.Bimface.UI.Button.ComboBox(o),r=a.getDefaultModel();return a.getFamilyTypes(function(t){for(var n=0,a=t.length;n<a;n++){var i=t[n],o=new e.Bimface.UI.Button.ButtonConfig;o.id=i.id,o.title=i.name;var s=new e.Bimface.UI.Button.ComboBoxOptionButton(o);s.setHtml('<span class="bf-button-name">'+i.name+"</span>"),l.addControl(s),0===n&&(r._data.familyTypeId=i.id)}}),l.addEventListener(i.Change,function(e){r.showFamilyTypeById(e.id),r._data.familyTypeId=e.id;var n=t.getPanel("property");n&&n.initProperty("components"),a.render()}),l};t.FamilyList=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=e.Bimface.UI.Control.ControlEvent,o=new e.Bimface.UI.Button.ButtonConfig;o.id="LayoutList",o.title="LayoutList",o.className="bf-combobox bf-family";for(var l=new e.Bimface.UI.Button.ComboBox(o),r=a.getViewer().getLayouts(),s=e.Bimface.Viewer.ViewerDrawingEvent,c=0,d=r.length;c<d;c++){var f=r[c],u=new e.Bimface.UI.Button.ButtonConfig;u.id=f.id||"Model",u.title=f.name;var m=new e.Bimface.UI.Button.ComboBoxOptionButton(u);m.setHtml('<span class="bf-button-name">'+f.name+"</span>"),l.addControl(m)}var p={},g={};return l.addEventListener(i.Change,function(n){var i=t.getPanel("MeaurePanel"),o=t.getToolbar("MainToolbar"),l=o.getControl("Annotation"),r=a.getCurrentViewId();l&&l._enabled&&(p[r]=l._annotationManager.getAnnotationList()),i&&i.hide(),g[r]=a.getCurrentState();var c=e.Web.Lang.Utility.ClientHelper.getIsDesktop();"Model"==n.id?(c||document.querySelector(".gld-bf-measure").setCss({display:"block"}),a.showViewById(0)):(c||document.querySelector(".gld-bf-measure").setCss({display:"none"}),a.showViewById(n.id)),setTimeout(function(){a.update(!0)},100),l&&l._enabled&&p[n.id]&&l._annotationManager.setAnnotationList(p[n.id]);var d="Model"==n.id&&"0"||n.id;g[d]&&a.setState(g[d]);var f=o.getControl("Map");"Model"!=n.id?f&&(f.element.style.display="none"):f&&(f.element.style.display="inline-block");var u="Model"===n.id?0:n.id;a.getEventManager().fireEvent(s.ButtonOnToolbarClicked,{id:"LeftSubToolbar",viewId:u})}),l};t.LayoutList=n}();var g,h,b=function t(n,a,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"default";if(n){var r=new e.Bimface.UI.Tree.TreeNodeConfig,s=new e.Bimface.UI.Button.ButtonConfig;s.className="bf-tree-icon",s.defaultClass="gld-bf-untransparent",s.changeClass="gld-bf-transparent",s.title=BimfaceLanguage.bf_panel_modelTree_transparent,r.selection=!0;var c=new e.Bimface.UI.Button.ChangeButton(s);switch(n.type){case"floor":n.type="levelName",r.isChecked=!0,r.hasCheckbox=!0,r.icon=c;break;case"category":n.type="categoryId",r.isChecked=!0,r.hasCheckbox=!0,r.icon=c;break;case"specialty":r.selection=!1;case"root":r.isChecked=!0,r.hasCheckbox=!0,r.selection=!1,r.icon=c;break;case"family":case"familyType":default:r.isChecked=!0,r.hasCheckbox=!0,r.icon=c}n.elementIds&&(n.type="fileId",r.isChecked=!0,r.hasCheckbox=!0,r.icon=c),n.type||(r.isChecked=!0,r.hasCheckbox=!0,r.icon=c),n.items&&n.items.length>0?r.hasExpand=!0:r.hasExpand=!1,r.datas=n;var d=new e.Bimface.UI.Tree.TreeNode(r);if(d.filter=n.type,d.modelId=i,"model"==n.type&&(d.fileId=n.fileIds),"categoryId"==n.type||"root"==n.type||"model"==n.type)d.setData(n.id,n.name);else if(n.elementIds||n.type)n.fileId?d.setData(n.fileId,n.fileId):"specialty"==n.type&&""==n.name?d.setData("",BimfaceLanguage.bf_panel_modelTree_specialtyUndefined):n.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?d.setData("",n.name):d.setData(n.actualName,n.name);else{var f=-1==n.indexOf(".")?n:n.split(".")[1],u=g+"["+f+"]";d.setData(n,u)}return d.setCheckedState(o),d.setIconState(l),d.addEventListener("ExpandChanged",function(e,o){var l=e.getChildNode();if(n.items&&n.items.length>0&&!l){var r="checked"===e.getCheckedState(),s=e.getIconState()?"default":"change";if("family"==n.type&&(g=n.name),n.items[0].elementIds&&n.items[0].elementIds.length>0)"familyType"!==n.type&&(g=""),n.items.map(function(n){for(var o=n.elementIds.length,l=0,c=o;l<c;l++){var d=n.fileId?n.fileId+"."+n.elementIds[l]:""+n.elementIds[l];e.addChildNode(t(d,a,i,r,s))}});else for(var c=0,d=n.items.length;c<d;c++)e.addChildNode(t(n.items[c],a,i,r,s))}}),d}},v=function(e,t,n){var a=n.data,i=n.modelType,o=n.treeType,l="all"!==e.id?e.id:void 0;if(a&&0!=a.length)if("singleModel"==i)for(var r=a,s=0,c=r.length;s<c;s++)if(1==c&&"floor"==r[s].type)for(var d=r[0].items,f=0;f<d.length;f++){var u=b(d[f],n,l);u.addEventListener("SelectionChanged",function(e,n){B(t,e,n)}),e.addChildNode(u)}else{var u=b(r[s],n,l);u.addEventListener("SelectionChanged",function(e,n){B(t,e,n)}),e.addChildNode(u)}else{var r;r="old"==o?a.items:a;for(var s=0,c=r.length;s<c;s++){var u=b(r[s],n,l);u.addEventListener("SelectionChanged",function(e,n){B(t,e,n)}),e.addChildNode(u)}}},y=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var a=n._parent;"model"===a.filter?t.fileId=a.fileId:"root"!=a.filter&&(t[a.filter]=a.id,e(a))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},C=function e(t,n){if("group"===t.type)for(var a=0;a<t.items.length;a++)e(t.items[a],n);else if("model"===t.type)n.push({fileId:t.fileIds});else{var i=void 0,o=void 0;switch(t.type){case"floor":i="levelName";break;case"category":i="categoryId";break;default:i=t.type}o="categoryId"==t.type||"root"==t.type||"model"==t.type?t.id:t.elementIds||t.type?t.fileId?t.fileId:"specialty"==t.type&&""==t.name?"":t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?"":t.actualName:t,n.push(_defineProperty({},i,o))}return n},B=function(e,t,n){var a=void 0;if("group"===t.filter||"model"===t.filter&&!t.id){var i=t.getConfig(),o=i.datas;a=C(o,[])}else a=y(t);var l;if(l=t.filter?e.getViewer().getFilter().getMatchIds(a):a,n){e.getModels().forEach(function(e){e.clearSelectedComponents()});var r=e.getModel(t.modelId);r&&(r.addSelectedComponentsById(l),r.zoomToSelectedComponents(1))}else e.getModels().forEach(function(e){e.clearSelectedComponents()});e.render()},w=function t(n,a){if(n){var i=new e.Bimface.UI.Tree.TreeNodeConfig,o=new e.Bimface.UI.Button.ButtonConfig;o.className="bf-tree-icon",o.defaultClass="gld-bf-untransparent",o.changeClass="gld-bf-transparent",o.title=BimfaceLanguage.bf_panel_modelTree_transparent,i.selection=!1;var l=new e.Bimface.UI.Button.ChangeButton(o);switch(n.type){case"floor":n.type="levelName",i.isChecked=!0,i.hasCheckbox=!0,i.icon=l;break;case"category":n.type="categoryId",i.isChecked=!0,i.hasCheckbox=!0,i.icon=l;break;case"specialty":case"root":i.isChecked=!0,i.hasCheckbox=!0,i.icon=l;break;case"family":case"familyType":default:i.isChecked=!1,i.hasCheckbox=!1}var r=new e.Bimface.UI.Tree.TreeNode(i);if(r.filter=n.type,r.modelId=a,"categoryId"==n.type||"root"==n.type?r.setData(n.id,n.name):n.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?r.setData("",n.name):r.setData(n.actualName,n.name),n.items&&n.items.length>0)for(var s=0,c=n.items.length;s<c;s++)r.addChildNode(t(n.items[s],a));return r}},L=function(e,t,n){var a=n.data,i=n.modelType,o="all"!==e.id?e.id:void 0;if(h=n.meta.workerType,a&&0!=a.length)if("singleModel"==i)for(var l=0,r=a.length;l<r;l++)if(1==r&&"floor"==a[l].type)for(var s=a[l].items,c=0;c<s.length;c++)e.addChildNode(w(s[c],o));else if("specialty"==a[0].type&&"floor"==a[0].items[0].type&&1==a[0].items.length)for(var s=a[0].items[0].items,c=0;c<s.length;c++)e.addChildNode(w(s[c],o));else e.addChildNode(w(a[l],o));else for(var l=0,r=a.items.length;l<r;l++)e.addChildNode(w(a.items[l],o))},M=function(t){if(t){var n=new e.Bimface.UI.Tree.TreeNodeConfig,a=new e.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title=BimfaceLanguage.bf_panel_modelTree_transparent,n.selection=!0;var i=new e.Bimface.UI.Button.ChangeButton(a);switch(t.type){case"root":case"modelId":n.isChecked=!0,n.hasCheckbox=!0,n.selection=!1,n.icon=i;break;default:n.isChecked=!1,n.hasCheckbox=!1}var o=new e.Bimface.UI.Tree.TreeNode(n);return o.filter=t.type,o.setData(t.id,t.name),o}},T=function(t,n){if(n&&0!=n.length){var a=M({type:"root",id:"all",name:BimfaceLanguage.bf_panel_modelTree_allComponents});a.expand(),a.setAttribute("id","treeRootNode");var i=new e.Bimface.UI.Tree.Tree(a),o=function(e,n){var a=(e.meta,!0);e.data&&e.data.length>0&&function e(t){
"familyType"===t.type?t.items&&0!==t.items.length||(a=!1):t.items&&t.items.length>0&&e(t.items[0])}(e.data[0]),a?v(n,t,e):L(n,0,e)};if(1===n.length)o(n[0],a);else if(n.length>1)for(var l=0;l<n.length;l++){var r=n[l].meta,s=M({type:"modelId",id:r.modelId,name:r.name});a.addChildNode(s),n[l].data&&o(n[l],s)}return i.addEventListener("CheckedChanged",S(t)),i.addEventListener("IconChanged",x(t)),i}},S=function(e){return function(t,n){var a;if("group"===n.filter||"model"===n.filter&&!n.id){var i=n.getConfig(),o=i.datas;a=I(o,[])}else a=k(n);var l=n.modelId,r=n.getCheckedState(),s=n.id;"unchecked"==r?"all"==s?e.getModels().forEach(function(e){e.hideAllComponents()}):n.filter?"modelId"===n.filter?e.getModel(s).hideAllComponents():e.getModel(l).hideComponentsByObjectData(a):e.getModel(l).hideComponentsById(a):"checked"==r&&("all"==s?e.getModels().forEach(function(e){e.showAllComponents()}):n.filter?"modelId"===n.filter?e.getModel(s).showAllComponents():e.getModel(l).showComponentsByObjectData(a):e.getModel(l).showComponentsById(a)),e.render()}},x=function(e){return function(t,n){var a;if("group"===t.filter||"model"===t.filter&&!t.id){var i=t.getConfig(),o=i.datas;a=I(o,[])}else a=k(t);var l=t.modelId,r=t.id;"change"==n?"all"==r?e.getModels().forEach(function(e){e.transparentAllComponents()}):t.filter?"modelId"===t.filter?e.getModel(r).transparentAllComponents():e.getModel(l).transparentComponentsByObjectData(a):e.getModel(l).transparentComponentsById(a):"all"==r?e.getModels().forEach(function(e){e.opaqueAllComponents()}):t.filter?"modelId"===t.filter?e.getModel(r).opaqueAllComponents():e.getModel(l).opaqueComponentsByObjectData(a):e.getModel(l).opaqueComponentsById(a),e.render()}},k=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var a=n._parent;"model"===a.filter?t.fileId=a.fileId:"root"!=a.filter&&(t[a.filter]=a.id,e(a))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},I=function e(t,n){if("group"===t.type)for(var a=0;a<t.items.length;a++)e(t.items[a],n);else if("model"===t.type)n.push({fileId:t.fileIds});else{var i=void 0,o=void 0;switch(t.type){case"floor":i="levelName";break;case"category":i="categoryId";break;default:i=t.type}o="categoryId"==t.type||"root"==t.type||"model"==t.type?t.id:t.elementIds||t.type?t.fileId?t.fileId:"specialty"==t.type&&""==t.name?"":t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?"":t.actualName:t,n.push(_defineProperty({},i,o))}return n},_=function(e,t){var n=[];e.getModels().forEach(function(a){var i=a.getMetaData();if(a._manifest.Features.HasComponentStructure)a.getModelTree(function(a,o,l){if(n.push({data:a,modelType:o,treeType:l,meta:i}),n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var r=T(e,n);t(r)}});else if(n.push({meta:i}),n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var o=T(e,n);t(o)}})},E=function(e,t,n,a){"area"==n?e.getDefaultModel().getAreaProperty(a.id,function(e){e&&e.properties?t.setData(e.properties):t.setData({})}):e.getDefaultModel().getRoomProperty(a.id,function(e){e&&e.properties?t.setData(e.properties):t.setData({})})},N={property:"请选择一个构件，以查看对应属性",material:"暂无对应材质属性",drawing:"暂无对应图纸",area:"暂无对应空间",file:"暂无对应文件",links:"暂无对应文件",component:"暂无对应构件信息",loading:"加载中...",empty:"暂无对应数据",notFined:"找不到对应的三维构件"};!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=function(t){var n=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=(t.getViewer(),e.Bimface.Viewer.Viewer3DEvent,new e.Bimface.UI.Panel.PanelConfig);a.title=BimfaceLanguage.bf_tip_props_rooms,a.className="bf-panel area-panel",a.id="AreaPropertyPanel",a.css=n?{right:"10px",top:"10px",width:"300px",height:"416px"}:{left:"0",top:"0",width:"100%",height:"100%"};var i=new e.Bimface.UI.Panel.Panel(a);return i.setTips(N.area),t.areaPanel=i,i};t.AreaPanel=n}();var P,U=function(t,n,a,i){var o=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),l=t.getViewer();t._objectTypes[n.id]=n.type,o||i||t.getPanel("ModelTree").hide();var r=t.getPanel("AreaPropertyPanel");if(a){r&&E(l,r,n.type,{id:n.id,modelId:n.modelId});var s=n.elevation,d=n.height,f=n.maxPt,u=n.minPt,m=1600,p=10;"m"===l._defaultUnit&&(m/=1e3,p/=1e3);var g={min:u,max:{x:f.x,y:f.y,z:f.z+d}},h=s+m+p,b=n.boundary,v=CLOUD.ExtrudeBodyManager.getInstance(l.getViewer()).getNode(n.id);if(b)if(l.hideAllRooms(),v){l.showRoomsById([n.id]),v.geometry.computeBoundingBox();var y=v.geometry.boundingBox.max.z-v.geometry.boundingBox.min.z;h=s+y+p}else l.createRoom(b,m,n.id),n.modelId&&l.bindRoomByModelId(n.id,n.modelId);v=v||CLOUD.ExtrudeBodyManager.getInstance(l.getViewer()).getNode(n.id);var C=v.explodedDirection.clone().multiplyScalar(v.explodedHeight);h+=C.z,g.min={x:g.min.x+C.x,y:g.min.y+C.y,z:g.min.z+C.z},g.max={x:g.max.x+C.x,y:g.max.y+C.y,z:g.max.z+C.z},l.setSelectedComponentsById([n.id]);var B=l.getCameraAnimation();l.setCameraAnimation(!1),l.setView(e.Bimface.Viewer.ViewOption.Top),l.zoomToBoundingBox(g),l.setCameraAnimation(B);var w=t.getPlugin("SectionPlane"),L=t.getPanel("PickSectionPlanePanel");L&&(w&&(w.exit(),t.removePlugin("SectionPlane"),w=t.getPlugin("SectionPlane")),L.hide());var M=w||A(l);!1===w&&t.addPlugin(M);var T=t.getPanel("SectionPlanePanel"),S=T&&T.toggleButton;S&&S.setCheckedState(!0);var x=T&&T.select;x&&x.setCurrentOption("Z");var k=t.getPanel("SectionBoxPanel");k&&k.hide();var I=l.getViewer().getBoundingBoxWorld(),_=l.getViewer().getScene().getExpandScalar(),N=(new THREE.Box3).setFromCenterAndSize(I.getCenter(),I.getSize().multiplyScalar(_)),P=N.min.z,U=N.max.z,V=100-(h-P)/(U-P)*100;M.setPlane("Z"),M.setDirection("Forward"),M.setProgress(V),M.hidePlane(),CLOUD.GlobalData.ClippingCaps=!0,l.render()}else r&&r.clear(),l.hideAllRooms(),l.getModels().forEach(function(e){e.clearIsolation()}),o||c(t),l.render()},A=function(t){var n=new e.Bimface.Plugins.Section.SectionPlaneConfig;return n.viewer=t,n.id="SectionPlane",n.plane=e.Bimface.Plugins.Section.SectionPlanePlane.Z,n.direction=e.Bimface.Plugins.Section.SectionPlaneDirection.Forward,n.exitSectionBox=!1,new e.Bimface.Plugins.Section.SectionPlane(n)},V=function t(n,a,i,o,l){var r=n.getViewer(),s=n.getRootElement();if(a){var c=new e.Bimface.UI.Tree.TreeNodeConfig;c.isChecked=!1,c.hasCheckbox=!1,c.selection=!1,c.className="bf-tree bf-tree-area","area"!=i&&"room"!=i||(c.selection=!0);var d=new e.Bimface.UI.Tree.TreeNode(c);if(d.type=i,d.modelId=a.modelId,d.setData(a.id,a.name),"area"==i||"room"==i){d.elevation=o,d.height=l,d.boundary=a.boundary,d.maxPt=a.maxPt,d.minPt=a.minPt;var f=new e.Bimface.UI.Button.ButtonConfig;f.className="bf-property-icon",f.title=BimfaceLanguage.bf_tip_props_rooms;var u=new e.Bimface.UI.Button.Button(f);d.addNode(u.element),u.addEventListener("Click",function(){var t=n.getPanel("AreaPropertyPanel");t||(t=new e.Bimface.Application.UI.Panel.AreaPanel(n),t.addEventListener("Close",function(){n.removePanel(t.id)}),t.addEventListener("Hide",function(){t.close()}),E(r,t,d.type,{id:d.id,modelId:d.modelId}),s.appendChild(t.element),t.initPosition(),n.addPanel(t))})}var m,p,o,l;if("areas"==i&&a.areas&&a.areas.length>0&&(m=a.areas,p="area",o=a.elevation,l=a.height),"rooms"==i&&a.rooms&&a.rooms.length>0&&(m=a.rooms,p="room",o=a.elevation,l=a.height),m)for(var g=0;g<m.length;g++){m[g].modelId=d.modelId;var h=t(n,m[g],p,o,l);h.addEventListener("SelectionChanged",function(e,t,a){U(n,e,t,a)}),d.addChildNode(h)}return"rooms"!=i&&"areas"!=i||m||d.disabled(),d}},z=function(t,n,a,i){t.getViewer();if(n&&0!=n.length){var o=new e.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1,o.className="bf-tree bf-tree-empty";var l=new e.Bimface.UI.Tree.TreeNode(o);l.expand();var r=new e.Bimface.UI.Tree.Tree(l);return H(t,n,l,a,i,!0),r}},D=function(t,n){var a=new e.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree bf-tree-empty";var i=new e.Bimface.UI.Tree.TreeNode(a);i.expand();for(var o=new e.Bimface.UI.Tree.Tree(i),l=0;l<n.length;l++){var r=n[l].data,a=new e.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree";var s=new e.Bimface.UI.Tree.TreeNode(a);s.setData(n[l].meta.modelId,n[l].meta.name),s.type="model",i.addChildNode(s),r?(s.expand(),r.modelId=n[l].meta.modelId,H(t,r,s,n[l].HasArea,n[l].HasRoom,!1)):s.disabled()}return o},H=function(t,n,a,i,o,l){var r=new e.Bimface.UI.Tree.TreeNodeConfig;r.isChecked=!1,r.hasCheckbox=!1,r.selection=!1,r.className="bf-tree bf-tree-empty";var s=new e.Bimface.UI.Tree.TreeNode(r);s.setData("room",BimfaceLanguage.bf_panel_modelTree_rooms2),l&&s.expand();var c=new e.Bimface.UI.Tree.TreeNode(r);c.setData("area",BimfaceLanguage.bf_panel_modelTree_areas),l&&c.expand();for(var d=!1,f=!1,u=n.modelId,m=0,p=n.length;m<p;m++)n[m].rooms&&n[m].rooms.length>0&&(n[m].modelId=u,s.addChildNode(V(t,n[m],"rooms")),d=!0),n[m].areas&&n[m].areas.length>0&&(n[m].modelId=u,c.addChildNode(V(t,n[m],"areas")),f=!0);o&&d&&a.addChildNode(s),i&&f&&a.addChildNode(c)},W=function(e,t){var n=e.getViewer();if(1===n.getModelCount())n.getDefaultModel().getAreas(function(a){if(a&&a.length>0){var i=n._manifest.Features.HasArea,o=n._manifest.Features.HasRoom,l=z(e,a,i,o);t&&t(l)}else t&&t()});else if(n.getModelCount()>1){var a=[],i=function(){if(a.length===n.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var i=D(e,a);t(i)}};n.getModels().forEach(function(e){var t=e.getMetaData(),n=e._manifest,o=n.Features.HasArea,l=n.Features.HasRoom;o||l?e.getAreas(function(e){a.push({data:e,meta:t,HasArea:o,HasRoom:l}),i()},function(e){a.push({error:e,meta:t}),i()}):(a.push({meta:t}),i())})}},F=function(t){if(t){var n=new e.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!0,n.hasCheckbox=!0,n.selection=!1;var a=new e.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title=BimfaceLanguage.bf_panel_modelTree_transparent;var i=new e.Bimface.UI.Button.ChangeButton(a);n.icon=i;var o=new e.Bimface.UI.Tree.TreeNode(n);return o.filter=t.type,o.setData(""+t.fileId,t.fileName),o.linkedId=t.linkedBy,o.databagId=t.databagId,o}},O=function(t,n){if(n&&0!=n.length){var a=F({type:"root",fileId:"all",fileName:BimfaceLanguage.bf_panel_modelTree_allFiles});a.expand();var i=new e.Bimface.UI.Tree.Tree(a);if(1===t.getModelCount()){n=e.Web.Lang.Utility.ClientHelper.sortByName(n,"fileName");for(var o=0,l=n.length;o<l;o++)n[o].type="fileId",a.addChildNode(F(n[o]))}else if(t.getModelCount()>1)for(var o=0,l=n.length;o<l;o++)if("integrateModel"===n[o].modelType){var r=F({type:n[o].modelType,fileId:n[o].modelId,fileName:n[o].modelName});r.expand(),a.addChildNode(r);for(var s=e.Web.Lang.Utility.ClientHelper.sortByName(n[o].fileList,"fileName"),c=0;c<s.length;c++)s[c].type="fileId",r.addChildNode(F(s[c]))}else n[o].type=n[o].modelType,a.addChildNode(F(n[o]));return i.addEventListener("CheckedChanged",function(e,n){var a=n.filter,i=n.id,o=n.getCheckedState();if("root"===a)"unchecked"==o?t.getModels().forEach(function(e){e.hideAllComponents()}):t.getModels().forEach(function(e){e.showAllComponents()});else if("integrateModel"===a||"singleModel"===a)"unchecked"==o?t.getModel(i).hideAllComponents():t.getModel(i).showAllComponents();else{var l="all"!==n._parent.id?n._parent.id:void 0,r=n.linkedId,s=[{sceneId:n.databagId+"."+i}];l&&(s[0].modelId=l);for(var c=[],d=0;d<r.length;d++){var f={};f[a]=r[d],l&&(f.modelId=l),c.push(f)}"unchecked"==o?(t.getModel(l).hideComponentsByObjectData(c),t.getModel(l).hideComponentsByObjectData(s)):(t.getModel(l).showComponentsByObjectData(c),t.getModel(l).showComponentsByObjectData(s))}t.render()}),i.addEventListener("IconChanged",function(e,n){var a=e.filter,i=e.id;if("root"===a)"change"==n?t.getModels().forEach(function(e){e.transparentAllComponents()}):t.getModels().forEach(function(e){e.opaqueAllComponents()});else if("integrateModel"===a||"singleModel"===a)"change"==n?t.getModel(i).transparentAllComponents():t.getModel(i).opaqueAllComponents();else{for(var o="all"!==e._parent.id?e._parent.id:void 0,l=e.linkedId,r=[],s=0;s<l.length;s++){var c={};c[a]=l[s],o&&(c.modelId=o),r.push(c)}"change"==n?t.getModel(o).transparentComponentsByObjectData(r):t.getModel(o).opaqueComponentsByObjectData(r)}t.render()}),i}},R=function(e,t){if(1===e.getModelCount()&&"integrateModel"===e.getDefaultModel().getMetaData().modelType)e.getDefaultModel().getFiles(function(n){var a=O(e,n);t&&t(a)});else if(e.getModelCount()>1){var n=[],a=0,i=0;if(e.getModels().forEach(function(o){var l={viewToken:o.viewToken};n.push(l);var r=o.getMetaData();if(l.modelType=r.modelType,l.databagId=r.databagId,"singleModel"===r.modelType){var s=o.modelId.toString();l.fileId=s,l.fileName=r.name,l.fileType=r.fileType}else"integrateModel"===r.modelType&&(l.modelId=o.modelId.toString(),l.modelName=r.name,l.fileList=[],a++,o.getFiles(function(o){if(l.fileList=o,i++,a===i){var r=O(e,n);t&&t(r)}}))}),0===a){var o=O(e,n);t&&t(o)}}},q=function t(n,a){if(n){var i=new e.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!0,i.selection=!1,i.propagation=!1,i.hasCheckbox=!0;var o=new e.Bimface.UI.Button.ButtonConfig;o.className="bf-tree-icon",o.defaultClass="gld-bf-untransparent",o.changeClass="gld-bf-transparent",o.title=BimfaceLanguage.bf_panel_modelTree_transparent;var l=new e.Bimface.UI.Button.ChangeButton(o);i.icon=l;var r=new e.Bimface.UI.Tree.TreeNode(i);if(r.filter="fileId",r.setData(""+n.fileId,n.name),r.linked=[n.linkPathHash],r.databagId=n.databagId,r.modelId=a,n.links&&n.links.length>0)for(var s=0,c=n.links.length;s<c;s++){var d=t(n.links[s],a);r.linked=r.linked.concat(d.linked),r.addChildNode(t(n.links[s],a))}return r}},j=function(t){var n=new e.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!0,n.selection=!1,n.propagation=!1,n.hasCheckbox=!0;var a=new e.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title=BimfaceLanguage.bf_panel_modelTree_transparent;var i=new e.Bimface.UI.Button.ChangeButton(a);n.icon=i;var o=new e.Bimface.UI.Tree.TreeNode(n);if(o.setData(t.meta.modelId,t.meta.name),o.filter="integrateModel",o.expand(),t.data&&t.data.length>0)for(var l=0,r=t.data.length;l<r;l++)o.addChildNode(q(t.data[l],t.meta.modelId));return o},Z=function(t,n,a){if(n&&0!=n.length){var i=q({type:"root",fileId:"all",name:BimfaceLanguage.bf_panel_modelTree_allFiles});i.expand();var o=new e.Bimface.UI.Tree.Tree(i);if(1===t.getModelCount())for(var l=0,r=n.length;l<r;l++)i.addChildNode(q(n[l]));else if(t.getModelCount()>1)for(var l=0;l<n.length;l++)i.addChildNode(j(n[l]));return o.addEventListener("CheckedChanged",function(e,n){var a=n.filter,i=n.id,o=n.getCheckedState();if("all"==i)"unchecked"==o?t.getModels().forEach(function(e){e.hideAllComponents()}):t.getModels().forEach(function(e){e.showAllComponents()});else if("integrateModel"===a)"unchecked"==o?t.getModel(i).hideAllComponents():t.getModel(i).showAllComponents();else{for(var l=n.modelId,r=n.linked,s=[],c=0;c<r.length;c++){var d={};d[a]=r[c]||n.id,n.modelId&&(d.modelId=n.modelId),s.push(d)}"unchecked"==o?t.getModel(l).hideComponentsByObjectData(s):t.getModel(l).showComponentsByObjectData(s)}t.render()}),o.addEventListener("IconChanged",function(e,n){var a=e.filter,i=e.id;if("change"==n)if("all"==i)t.getModels().forEach(function(e){e.transparentAllComponents()});else if("integrateModel"===a)t.getModel(i).transparentAllComponents();else{for(var o=e.modelId,l=e.linked,r=[],s=0;s<l.length;s++){var c={};c[a]=l[s]||e.id,e.modelId&&(c.modelId=e.modelId),r.push(c)}t.getModel(o).transparentComponentsByObjectData(r)}else if("all"==i)t.getModels().forEach(function(e){e.opaqueAllComponents()});else if("integrateModel"===a)t.getModel(i).opaqueAllComponents();else{for(var o=e.modelId,l=e.linked,r=[],s=0;s<l.length;s++){var c={};c[a]=l[s]||e.id,e.modelId&&(c.modelId=e.modelId),r.push(c)}t.getModel(o).opaqueComponentsByObjectData(r)}t.render()}),o}},G=function(e,t){if(1===e.getModelCount())e.getDefaultModel().getLinkGraph(function(n){var a=Z(e,n);t&&t(a)});else if(e.getModelCount()>1){var n=[],a=function(){if(n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var a=Z(e,n);t(a)}};e.getModels().forEach(function(e){var t=e.getMetaData();e._manifest.Features.HasLinkRelation?e.getLinkGraph(function(e){n.push({data:e,meta:t}),a()}):"integrateModel"===t.modelType?e.getFiles(function(e){e.forEach(function(e){return e.name=e.fileName}),n.push({data:e,meta:t}),a()}):(n.push({meta:t}),a())})}},Q=function(t,n,a,i,o){if(t){var l=new e.Bimface.UI.Tree.TreeNodeConfig;l.isChecked=!1,l.hasCheckbox=!1,l.selection=!0;var r=new e.Bimface.UI.Tree.TreeNode(l);return r.modelId=o,r.viewToken=n,r.isIntegrateModel=a,a&&(r.fileId=i),r.setData(t.id,t.name),r}},X=function(t,n,a,i){var o=new e.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var l=new e.Bimface.UI.Tree.TreeNode(o);if(l.setData(t.fileId,t.fileName),l.modelId=i,t.drawingSheets&&t.drawingSheets.length>0)for(var r=0;r<t.drawingSheets.length;r++)l.addChildNode(Q(t.drawingSheets[r].viewInfo,n,a,t.fileId,i));else l.disabled();return l},Y=function(t){var n=new e.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1;var a=new e.Bimface.UI.Tree.TreeNode(n);if(a.setData(t.modelId,t.modelName),t.fileList&&t.fileList.length>0)for(var i=0;i<t.fileList.length;i++)a.addChildNode(X(t.fileList[i],t.viewToken,!0,t.modelId));return a.expand(),a},J=function(){var t=new e.Bimface.UI.Tree.TreeNodeConfig;return t.isChecked=!1,t.hasCheckbox=!1,t.selection=!1,t.className="bf-tree bf-tree-empty",new e.Bimface.UI.Tree.TreeNode(t)},K=function(t,n,a,i){if(n&&0!=n.length){for(var o=J(),l=new e.Bimface.UI.Tree.Tree(o),r=0,s=n.length;r<s;r++){var c="integrateModel"===t._data.modelType?X(n[r],n[r].viewToken,!0):Q(n[r].viewInfo,t._data.viewToken);o.addChildNode(c)}return l}},$=function(t,n){if(n&&0!=n.length){for(var a=J(),i=new e.Bimface.UI.Tree.Tree(a),o=0;o<n.length;o++)"integrateModel"===n[o].modelType?a.addChildNode(Y(n[o])):a.addChildNode(X(n[o],n[o].viewToken,!1));return i}},ee=function(t,n){if(1===t.getModelCount()&&"integrateModel"!==t.getDefaultModel().getMetaData().modelType)t.getDefaultModel().getAllDrawingsheets(function(a){if((a=a.drawingList||a)&&a.length>0){a=e.Web.Lang.Utility.ClientHelper.sortByName(a,"viewInfo.name");var i=K(t,a);n&&n(i)}else n&&n()});else if(1===t.getModelCount()&&"integrateModel"===t.getDefaultModel().getMetaData().modelType)t.getDefaultModel().getFiles(function(a){var i=0,o=0;a.forEach(function(l){var r=l.fileId.toString();i++,t.getDefaultModel().getDrawingsheets(r,function(r){if(o++,r=r.drawingList||r,r&&(r=e.Web.Lang.Utility.ClientHelper.sortByName(r,"viewInfo.name"),l.drawingSheets=r),o==i){var s=K(t,a);n&&n(s)}})})});else if(t.getModelCount()>1){var a=[],i=0,o=0;t.getModels().forEach(function(t){var l={viewToken:t.viewToken};a.push(l);var r=t.getMetaData();if(l.modelType=r.modelType,l.databagId=r.databagId,"singleModel"===r.modelType){var s=t.modelId.toString();l.fileId=s,l.fileName=r.name,l.fileType=r.fileType;t._manifest.Features.HasDrawing&&(i++,t.getDrawingsheets(s,function(t){if(o++,t=t.drawingList||t,t&&(t=e.Web.Lang.Utility.ClientHelper.sortByName(t,"viewInfo.name"),l.drawingSheets=t),o==i){var r=$(0,a);n&&n(r)}}))}else if("integrateModel"===r.modelType){l.modelId=t.modelId.toString(),l.modelName=r.name,l.fileList=[];var c=t._manifest;c.Features.HasDrawing&&t.getFiles(function(r){l.fileList=r,r.forEach(function(l){var r=l.fileId.toString();i++,t.getDrawingsheets(r,function(t){if(o++,t=t.drawingList||t,t&&(t=e.Web.Lang.Utility.ClientHelper.sortByName(t,"viewInfo.name"),l.drawingSheets=t),o==i){var r=$(0,a);n&&n(r)}})})})}})}},te=function(t,n,a,i){var o=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),l=t.getViewer();if(o||i||t.getPanel("ModelTree").hide(),a){l.getModels().forEach(function(e){e.clearSelectedComponents()});var r=l.getModel(n.modelId);r.addSelectedComponentsById(n.selectData),r.zoomToSelectedComponents(),l.render()}else l.getModels().forEach(function(e){e.clearSelectedComponents()}),o||c(t),l.render()},ne=function t(n,a,i,o){if(a){var l=new e.Bimface.UI.Tree.TreeNodeConfig;l.isChecked=!1,l.hasCheckbox=!1,l.selection=!1,l.className="bf-tree","assembly"!=i&&"group"!=i&&"instances"!=i||(l.selection=!0);var r=new e.Bimface.UI.Tree.TreeNode(l);if(r.type=i,r.modelId=o,"instances"==i)r.setData(a.id,a.id),r.selectData=a.elements;else if(r.setData(a.id,a.name),a.instances){var s=[];a.instances.forEach(function(e){s.push.apply(s,e.elements)}),r.selectData=s}var c,d,f,u;if(a.types&&a.types.length>0&&(c=a.types),d="assemblys"==i?"assembly":"group",a.instances&&a.instances.length>0&&(f=a.instances,u="instances"),c)for(var m=0;m<c.length;m++){var p=t(n,c[m],d,o);p.addEventListener("SelectionChanged",function(e,t,a){te(n,e,t,a)}),r.addChildNode(p)}if(f)for(var m=0;m<f.length;m++){var g=t(n,f[m],u,o);g.addEventListener("SelectionChanged",function(e,t,a){te(n,e,t,a)}),r.addChildNode(g)}return"groups"!=i&&"assemblys"!=i||c||r.disabled(),"group"!=i&&"assembly"!=i||f||r.disabled(),r}},ae=function(t,n,a){t.getViewer();if(n&&0!=n.length){var i=new e.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1,i.className="bf-tree bf-tree-empty";var o=new e.Bimface.UI.Tree.TreeNode(i);o.expand();var l=new e.Bimface.UI.Tree.Tree(o);return oe(t,n,o,!0),l}},ie=function(t,n){var a=new e.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree bf-tree-empty";var i=new e.Bimface.UI.Tree.TreeNode(a);i.expand();for(var o=new e.Bimface.UI.Tree.Tree(i),l=0;l<n.length;l++){var r=n[l].data,a=new e.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree";var s=new e.Bimface.UI.Tree.TreeNode(a);s.setData(n[l].meta.modelId,n[l].meta.name),s.type="model",i.addChildNode(s),r&&0!=r.length?(s.expand(),oe(t,r,s,!1,n[l].meta.modelId)):s.disabled()}return o},oe=function(t,n,a,i,o){var l=new e.Bimface.UI.Tree.TreeNodeConfig;if(l.isChecked=!1,l.hasCheckbox=!1,l.selection=!1,l.className="bf-tree",n.groups&&n.groups.length>0){var r=new e.Bimface.UI.Tree.TreeNode(l);r.setData("group",BimfaceLanguage.bf_panel_modelTree_group),i&&r.expand(),a.addChildNode(r);for(var s=0,c=n.groups.length;s<c;s++)r.addChildNode(ne(t,n.groups[s],"groups",o))}if(n.assemblies&&n.assemblies.length>0){l.selection=!1;var d=new e.Bimface.UI.Tree.TreeNode(l);d.setData("assembly",BimfaceLanguage.bf_panel_modelTree_assembly),i&&d.expand(),a.addChildNode(d);for(var s=0,c=n.assemblies.length;s<c;s++)d.addChildNode(ne(t,n.assemblies[s],"assemblys",o))}},le=function(e,t){var n=e.getViewer();if(1===n.getModelCount())n.getDefaultModel().getModelSet(function(n){if(n){var a=ae(e,n);t&&t(a)}else t&&t()});else if(n.getModelCount()>1){var a=[],i=function(){if(a.length===n.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var i=ie(e,a);t(i)}};n.getModels().forEach(function(e){var t=e.getMetaData();e._manifest.Features.HasGroup?e.getModelSet(function(e){a.push({data:e,meta:t}),i()},function(e){a.push({error:e,meta:t}),i()}):(a.push({meta:t}),i())})}},re=0,se=[],ce=function t(n,a){if(n){var i=new e.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1,n.type||(i.selection=!0);var o=new e.Bimface.UI.Tree.TreeNode(i);if(o.setData(n.name,n.name),n.type||(o.network=n.network,o.fileId=P),o.modelId=a,n.items&&n.items.length>0)for(var l=0,r=n.items.length;l<r;l++)o.addChildNode(t(n.items[l],a));else"fileId"===n.type&&o.disabled();return o}},de=function(t,n,a){if(a&&0!=a.length){var i=new e.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1;var o;o=new e.Bimface.UI.Tree.TreeNode(i),o.expand();var l=new e.Bimface.UI.Tree.Tree(o);if(1===n.getModelCount())for(var r=0,s=a.length;r<s;r++){P=a[r].id;var c=ce(a[r]);c.addEventListener("SelectionChanged",function(e,a,i){fe(t,n,e,e,a,i)}),o.addChildNode(c)}else if(n.getModelCount()>1)for(var r=0;r<a.length;r++)if("integrateModel"===a[r].modelType){var i=new e.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1;var d=new e.Bimface.UI.Tree.TreeNode(i);d.setData(a[r].modelId,a[r].modelName),o.addChildNode(d);for(var f=e.Web.Lang.Utility.ClientHelper.sortByName(a[r].fileList,"fileName"),u=0;u<f.length;u++){var m=f[u].mepData;if(m){P=m.id;var c=ce(m,a[r].modelId);c.addEventListener("SelectionChanged",function(e,a,i){fe(t,n,e,e,a,i)}),d.addChildNode(c)}else{var c=new e.Bimface.UI.Tree.TreeNode(i);c.setData(f[u].fileName,f[u].fileName),c.disabled(),d.addChildNode(c)}}}else{var m=a[r].mepData;if(m){P=void 0;var c=ce(m,a[r].fileId);c.addEventListener("SelectionChanged",function(e,a,i){fe(t,n,e,e,a,i)}),o.addChildNode(c)}else{var c=new e.Bimface.UI.Tree.TreeNode(i);c.setData(a[r].fileName,a[r].fileName),c.disabled(),o.addChildNode(c)}}return l}},fe=function(t,n,a,i,o){var l=[],r=a.modelId;if(a.fileId){var s=n.getModel(r).getMetaData().config;if(s&&s["integrate-with-links"]){var c=void 0;se.map(function(e){if(e.fileId==a.fileId)return void(c=e.linkedBy)}),c.map(function(e){a.network.map(function(t){var n=e+"."+t;l.push(n)})})}else a.network.map(function(e){var t=a.fileId+"."+e;l.push(t)})}else l=a.network;if(e.Web.Lang.Utility.ClientHelper.getIsDesktop()||o||t.getPanel("ModelTree").hide(),i){n.getModels().forEach(function(e){e.clearSelectedComponents()});var d=n.getModel(r);d.addSelectedComponentsById(l),d.zoomToSelectedComponents(1)}else n.getModels().forEach(function(e){e.clearSelectedComponents()});n.render()},ue=function(e,t,n,a){var i=e.reduce(function(e,t,n){return e[t.systemCategory]=e[t.systemCategory]||{},e[t.systemCategory][t.systemType]=e[t.systemCategory][t.systemType]||[],e[t.systemCategory][t.systemType].push({name:t.name,network:Object.keys(t.network)}),e},{}),o=[];for(var l in i){o.push({type:"systemCategory",name:l,items:[]});for(var r in i[l])o[o.length-1].items.push({type:"systemType",name:r,items:i[l][r]})}var s=[];t?s.push({type:"fileId",id:t,name:n,items:o}):s=o,a&&a(s)},me=function t(n){return n=e.Web.Lang.Utility.ClientHelper.sortByName(n,"name"),n.map(function(a){a.items&&a.items.length>0&&("systemType"==a.type?n=e.Web.Lang.Utility.ClientHelper.sortByRules(a.items,"name"):t(a.items))}),n},pe=function(e,t,n,a){var i=[];e.getMepSystem(t,function(e){e.systems?ue(e.systems,t,n,function(e){a&&a(e)}):(re--,a&&a(i))},function(){re--,a&&a(i)})},ge=function(e,t,n,a){if(1===t.getModelCount()){var i=t.getDefaultModel();if("integrateModel"==n){var o=[];i.getFiles(function(n){re=n.length,n.forEach(function(n){var l=n.fileId.toString(),r=n.fileName.toString();se.push({fileId:l,linkedBy:n.linkedBy}),pe(i,l,r,function(n){if(0!=n.length&&o.push(n[0]),o.length==re){var i=me(o),l=de(e,t,i);a&&a(l)}})})})}else pe(i,"","",function(n){var i=me(n),o=de(e,t,i);a&&a(o)})}else if(t.getModelCount()>1){var l=[];re=0;var r=0;t.getModels().forEach(function(n){var i={viewToken:n.viewToken};l.push(i);var o=n.getMetaData();if(i.modelType=o.modelType,i.databagId=o.databagId,"singleModel"===o.modelType){var s=n.modelId.toString();i.fileId=s,i.fileName=o.name,i.fileType=o.fileType;n._manifest.Features.HasMEPSystem&&(re++,pe(n,s,o.name,function(n){if(0!=n.length&&(r++,i.mepData=n[0]),r==re){var o=de(e,t,l);a&&a(o)}}))}else if("integrateModel"===o.modelType){i.modelId=n.modelId.toString(),i.modelName=o.name,i.fileList=[];var c=n._manifest;c.Features.HasDrawing&&n.getFiles(function(o){i.fileList=o,o.forEach(function(i){var o=i.fileId.toString(),s=i.fileName.toString();re++,pe(n,o,s,function(n){if(0!=n.length&&(r++,i.mepData=n[0]),r==re){var o=de(e,t,l);a&&a(o)}})})})}})}};!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=function(t,n){var a=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=(t.getViewer(),t.getRootElement(),new e.Bimface.UI.Panel.PanelConfig);i.title="楼层平面图",i.id="DrawingPanel",i.css=a?{right:"10px",top:"10px",width:"400px",height:"420px"}:{left:"0",top:"2.68em",width:"100%",bottom:0,paddingTop:0};var o=new e.Bimface.UI.Panel.Panel(i);return a||o.element.addClass("view-panel"),o.setHeader(n.name),o};t.DrawingPanel=n}();var he=function(e){var t=e.getViewer(),n=e.getPanel("AreaPanel"),a=e.getPanel("DrawingPanel");c(e),n&&(n.close(),e.removePanel("AreaPanel")),a&&a.hide(),t.hideAllRooms(),t.getModels().forEach(function(e){e.clearIsolation(),e.opaqueAllComponents(),e.clearSelectedComponents()})};void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(void 0!==a&&null!==a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t});var be=Object.freeze({Release:"Release",Debug:"Debug"}),ve=Object.freeze({Normal:"Normal",DrawingView:"drawingView"}),ye=Object.freeze({BIMFACE:"BIMFACE",Local:"Local"}),Ce=Object.freeze({zh_CN:"zh_CN",en_GB:"en_GB",sv_SE:"sv_SE"}),Be=Object.freeze({Normal:"Normal",Bake:"Bake"}),we=function(){if(window.hostConfig)for(var e in window.hostConfig)l[e]=window.hostConfig[e];return{staticHost:l.staticHost+"/api",APIHost:l.APIHost,language:"zh_CN",viewToken:null,configuration:be.Release,dataEnvType:l.dataEnvType||"BIMFACE",viewType:ve.Normal,visualStyle:Be.Bake,version:""}};window.BimfaceSDKLoaderConfig=we,window.BimfaceEnvOption=ye,window.BimfaceLanguageOption=Ce,window.BimfaceConfigrationOption=be,window.BimfaceViewTypeOption=ve;var Le=function(t,n,a){var i=t.getViewer(),o=a.viewToken||i._data.viewToken,l=t.getRootElement(),r=a.isIntegrateModel;t.fileId=a.fileId;var s=a.modelId;t.subViewer?"Local"==BimfaceLoaderConfig.dataEnvType?t.subViewer.addModel(BimfaceLoaderConfig.MetaData,a.id,r&&a.fileId):(t.getPanel("DrawingPanel").setTitleContent(a.name),t.subViewer.load(o,a.id,a.fileId)):(BimfaceLoaderConfig.viewToken=o,BimfaceLoaderConfig.viewType=ve.DrawingView,BimfaceSDKLoader.load(BimfaceLoaderConfig,function(c){var d,f,u=function(e,t){var n,a=function(n){if(0!=n.length){for(var a=0;a<n.length;a++){var i=n[a].areas,o=n[a].height,l=n[a].elevation;if(i&&i.length>0)for(var r=0;r<i.length;r++)if(e==i[r].id)return void t(i[r],l,o);var s=n[a].rooms;if(s&&s.length>0)for(var c=0;c<s.length;c++)if(e==s[c].id)return void t(s[c],l,o)}t()}};n?a(n):i.getModel(s).getAreas(function(e){n=e,a(n)})},m=i.getViewer(),p=!0,g=function(){if(d)d.show();else{var t=new e.Bimface.UI.Tips.TipsConfig;t.element=l,t.timeOut=3e3,t.html=BimfaceLanguage.bf_panel_modelTree_componentNotFound,d=new e.Bimface.UI.Tips.Tips(t)}p=!1};m.registerEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,g);var h=e.Bimface.Viewer.Viewer3DEvent;i.addEventListener(h.MissingDrawingElement,function(){if(f)f.show();else{var t=new e.Bimface.UI.Tips.TipsConfig;t.element=l,t.timeOut=3e3,t.html=BimfaceLanguage.bf_panel_modelTree_entityNotFound,f=new e.Bimface.UI.Tips.Tips(t)}});var b=new e.Bimface.Viewer.ViewerDrawingConfig;b.domElement=n.container;var v=new e.Bimface.Viewer.ViewerDrawing(b);"Local"==BimfaceLoaderConfig.dataEnvType?(c.fileId=a.fileId||"",BimfaceLoaderConfig.MetaData=c,v.addModel(c,a.id,r&&c.fileId)):v.load(o,a.id,a.fileId),v.addEventListener("ComponentsSelectionChanged",function(n){if(n&&n.length>0){var a=n[0],o=v.toModelId(a);if(2==n.length){var l=v.toLinkRevitId(n[0],n[1]),c=l instanceof Object?l.fileId:t.fileId,d=l instanceof Object?l.revitId:o;o=c+"_"+d}else r&&(o=t.fileId+"_"+o);var f=t.getPlugin("SectionBox"),m=t.getPanel("SectionPanel");u(o,function(n,a,l){if(i.getModels().forEach(function(e){e.showAllComponents()}),n){n.boundary&&i.setArea(n.boundary,a);var c=i.getWorldBox(a-20,a+1500);if(f)m&&m.hideBox();else{var d=new e.Bimface.Plugins.Section.SectionBoxConfig;d.viewer=i,d.id="SectionBox",f=new e.Bimface.Plugins.Section.SectionBox(d),t.addPlugin(f)}f.setBox(c),f.hideBox(),i.setView(e.Bimface.Viewer.ViewOption.Top)}else r&&(o=o.replace("_",".")),f&&(f.reset(),
f.hideBox()),m&&m.hideBox(),i.clearAllRooms(),i.getModel(s).setSelectedComponentsById([o]),p?(i.getModel(s).isolateComponentsById([o],e.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),i.getModel(s).zoomToSelectedComponents()):(i.getModels().forEach(function(e){e.clearIsolation()}),p=!0);i.render()})}});var y=function(t){if(t.elementId){var n=t.elementId,a=v.fromRevitId(n),o=v.fromLinkRevitId(t.fileId,n);if(!(a||o&&o.ids)){var l=e.Bimface.Viewer.Viewer3DEvent;return void i.getEventManager().fireEvent(l.MissingDrawingElement)}o instanceof Object?v.zoomToObjectWithBlock(o.blockId,o.ids):a&&v.zoomToObject(a)}};n.addEventListener("Sizable",function(){v.resize()}),n.addEventListener("Hide",function(){m.unregisterEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,g),i.removeEventListener("ComponentsSelectionChanged",y),n.close(),t.removePanel("DrawingPanel"),delete t.subViewer}),i.addEventListener("ComponentsSelectionChanged",y),t.subViewer=v}))},Me=function(t,n){var a=t.getRootElement(),i=t.getPanel("DrawingPanel");if(i)i.show();else{var i=new e.Bimface.Application.UI.Panel.DrawingPanel(t,n);a.appendChild(i.element),i.bringToFront(),t.addPanel(i)}Le(t,i,n)};!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(n,a){var i="component",o=n.getViewer(),l=(n.getRootElement(),o._manifest),r=o._data.modelType,s=t.create("div","bf-tree-header"),d=t.create("div","bf-tree-footer"),f=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),u=[],m=void 0,p=void 0,g=void 0,h=(o._data.workerType,void 0);if(f&&(h={component:{panel:!1,tree:null},modelGroup:{panel:!1,tree:null},mepSystem:{panel:!1,tree:null},file:{panel:!1,tree:null},links:{panel:!1,tree:null},area:{panel:!1,tree:null},drawing:{panel:!1,tree:null}}),l.Features.HasComponentStructure&&u.push({id:"component",name:BimfaceLanguage.bf_panel_modelTree_components}),(l.Features.HasGroup||l.Features.HasAssemble)&&u.push({id:"modelGroup",name:BimfaceLanguage.bf_panel_modelTree_modelGroup}),l.Features.HasMEPSystem&&u.push({id:"mepSystem",name:BimfaceLanguage.bf_panel_modelTree_mep}),l.Features.HasFileList&&u.push({id:"file",name:BimfaceLanguage.bf_panel_modelTree_files}),(l.Features.HasRoom||l.Features.HasArea)&&u.push({id:"area",name:BimfaceLanguage.bf_panel_modelTree_rooms1}),l.Features.HasDrawing&&u.push({id:"drawing",name:BimfaceLanguage.bf_panel_modelTree_drawings}),f){var b,v,y=t.create("div","bf-tree-tab");if(s.appendChild(y),u.length<5)b=u;else{var C=t.create("div","bf-tree-select"),B=t.create("div","bf-tree-slot");s.appendChild(B),s.appendChild(C),b=u.slice(0,3),v=u.slice(3);var w=new e.Bimface.UI.Select.SelectConfig;w.className="bf-select bf-select-tree",w.options=v,w.element=C,p=new e.Bimface.UI.Select.Select(w),B.innerHTML=v[0].name,B.setAttribute("id",v[0].id),B.setAttribute("title",v[0].name),s.querySelectorAll(".bf-select-option")[0].style.display="none";var L=s.querySelector(".bf-select-current"),M=t.create("i","gld-bf-arrow-right");L.appendChild(M)}var T=new e.Bimface.UI.Tabs.TabsConfig,S=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],x=b.length>7?6:b.length-1;T.className="bf-tabs bf-tabs-tree "+S[x],T.options=b,T.element=y,m=new e.Bimface.UI.Tabs.Tabs(T),g=new e.Bimface.UI.Panel.PanelConfig,g.title=BimfaceLanguage.bf_btn_modelTree,g.id="ModelTree",g.css={left:"10px",top:"10px",height:"430px",minWidth:"300px",minHeight:"140px"},g.className="bf-panel bf-modelTree-panel"}else{var T=new e.Bimface.UI.Tabs.TabsConfig,S=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],x=u.length>7?6:u.length-1;T.className="bf-tabs bf-tabs-tree-mobile "+S[x],T.options=u,T.element=s,m=new e.Bimface.UI.Tabs.Tabs(T),g=new e.Bimface.UI.Panel.PanelConfig,g.title=BimfaceLanguage.bf_btn_modelTree,g.id="ModelTree",g.css={left:0,top:0,width:"100%",height:"100%"}}var k;l.Features.HasLinkRelation&&(k=t.create("label","bf-tree-label bf-checkbox"),k.innerHTML='\n        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_modelTree_fileLink+'</span>\n        <input type="checkbox" class="bf-checkbox-input" name="hover" id="linksModeInput">\n        <span class="bf-checkbox-display"></span>',d.appendChild(k),k.addEventListener("change",function(){I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading");n.getToolbar("MainToolbar");c(n),he(n),o.getModels().forEach(function(e){e.showAllComponents()}),o.render();var e=document.querySelector("#linksModeInput");N(e&&e.checked?"links":"file")}));var I=new e.Bimface.UI.Panel.Panel(g);I.setContainerHeader(s),I.setContainerFooter(d);var E=I.container;I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),f||I.addClass("tree-panel"),I.addEventListener("Hide",function(){a.show(),f||"area"!=i&&"component"!=i&&he(n);var e=n.getPanel("AreaPropertyPanel");e&&e.hide(),o.render()}),f?h.component.panel||_(o,function(e){"component"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),h.component.tree=e,n.tree=h.component.tree,h.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),E.appendChild(e.element))}):_(o,function(e){"component"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),E.innerHTML="",n.tree=e,E.appendChild(e.element))});var N=function(e){i=e;var t=document.querySelectorAll(".tree-panel");switch(f&&(t.forEach(function(e){e.style.display="none"}),I.hideTips(),o.getModels().forEach(function(e){e.showAllComponents()})),e){case"component":f?h.component.panel?(document.querySelector("#componentPanel").style.display="block",n.tree=h.component.tree,A("componentPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),_(o,function(e){"component"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),e&&(h.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),h.component.tree=e,n.tree=h.component.tree,E.appendChild(e.element)))})):_(o,function(e){"component"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),n.tree=e,e&&(E.innerHTML="",E.appendChild(e.element)))});break;case"modelGroup":f?h.modelGroup.panel?(document.querySelector("#modelGroupPanel").style.display="block",n.tree=h.modelGroup.tree,A("modelGroupPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),le(n,function(e){"modelGroup"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noData),e&&(h.modelGroup.panel=!0,e.element.setAttribute("id","modelGroupPanel"),e.element.addClass("tree-panel"),h.modelGroup.tree=e,n.tree=h.modelGroup.tree,E.appendChild(e.element)))})):le(n,function(e){"modelGroup"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noData),n.tree=e,e&&E.appendChild(e.element))});break;case"mepSystem":f?h.mepSystem.panel?(document.querySelector("#mepSystemPanel").style.display="block",n.tree=h.mepSystem.tree,A("mepSystemPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),ge(n,o,r,function(e){"mepSystem"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),e&&(h.mepSystem.panel=!0,e.element.setAttribute("id","mepSystemPanel"),e.element.addClass("tree-panel"),h.mepSystem.tree=e,n.tree=h.mepSystem.tree,E.appendChild(e.element)))})):ge(n,o,r,function(e){"mepSystem"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),n.tree=e,e&&E.appendChild(e.element))});break;case"area":f?h.area.panel?(document.querySelector("#areaPanel").style.display="block",n.tree=h.area.tree,A("areaPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),W(n,function(e){"area"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(h.area.panel=!0,e.element.setAttribute("id","areaPanel"),e.element.addClass("tree-panel"),h.area.tree=e,n.tree=h.area.tree,E.appendChild(e.element)))})):W(n,function(e){"area"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(n.tree=e,E.appendChild(e.element)))});break;case"file":var a=document.querySelector("#linksModeInput");f?h.file.panel?a&&a.checked&&h.links.panel?(document.querySelector("#linksPanel").style.display="block",n.tree=h.links.tree,A("linksPanel")):(document.querySelector("#filePanel").style.display="block",n.tree=h.file.tree,A("filePanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),R(o,function(e){"file"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(h.file.panel=!0,e.element.setAttribute("id","filePanel"),e.element.addClass("tree-panel"),h.file.tree=e,n.tree=h.file.tree,E.appendChild(e.element)))})):R(o,function(e){"file"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),n.tree=e,e&&E.appendChild(e.element))});break;case"links":f?h.links.panel?(document.querySelector("#linksPanel").style.display="block",n.tree=h.links.tree,A("linksPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),G(o,function(e){"links"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(h.links.panel=!0,e.element.setAttribute("id","linksPanel"),e.element.addClass("tree-panel"),h.links.tree=e,n.tree=h.links.tree,E.appendChild(e.element)))})):G(o,function(e){"links"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),n.tree=e,e&&E.appendChild(e.element))});break;case"drawing":f?h.drawing.panel?(document.querySelector("#drawingPanel").style.display="block",n.tree=h.drawing.tree,A("drawingPanel")):(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),ee(o,function(e){"drawing"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),e&&(h.drawing.panel=!0,e.element.setAttribute("id","drawingPanel"),e.element.addClass("tree-panel"),h.drawing.tree=e,n.tree=h.drawing.tree,E.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,t){if(t)Me(n,e);else{var a=n.getPanel("DrawingPanel");a&&n.subViewer&&n.subViewer.isInitialized&&a.hide()}})))})):ee(o,function(e){"drawing"==i&&(I.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),n.tree=e,e&&(E.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,t){if(t)Me(n,e);else{var a=n.getPanel("DrawingPanel");a&&n.subViewer&&n.subViewer.isInitialized&&a.hide()}})))})}o.render()};m.addEventListener("Change",function(e){B&&B.removeClass("active"),U(e)}),p&&p.addEventListener("Change",function(e){P(e)}),B&&B.addEventListener("click",function(e){m.setCurrentOption(""),U(e.target),B.addClass("active")});var P=function(e){m.setCurrentOption(""),B.innerHTML=e.name,B.setAttribute("id",e.id),B.setAttribute("title",e.name),B.addClass("active");var n=s.querySelectorAll(".bf-select-option");n[0].style.display="block",n.forEach(function(t){t.id==e.id?t.style.display="none":t.style.display="block"});var a=s.querySelector(".bf-select-current"),i=t.create("i","gld-bf-arrow-right");a.appendChild(i),U(e)},U=function(e){f||(I.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),I.clear()),c(n),he(n);var t=n.getPanel("AreaPropertyPanel");t&&("area"!=e.id?t.element.style.display="none":t.element.style.display="block"),k&&("file"==e.id?(k.style.display="block",I.container.style.height="calc(100% - 30px)"):(k.style.display="none",I.container.style.height="100%")),N(e.id)},A=function(e){var t=[],n=document.querySelectorAll("#"+e+" .bf-unchecked"),a=document.querySelectorAll("#"+e+" .gld-bf-transparent"),i=document.querySelectorAll("#"+e+" .bf-selected"),l=document.querySelector("#treeRootNode .bf-unchecked"),r=document.querySelector("#treeRootNode .gld-bf-transparent");if("componentPanel"==e)l?o.hideAllComponents():n.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-unchecked")||t.push(e)}),r?o.transparentAllComponents():a.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".gld-bf-transparent")||t.push(e)}),i.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-selected")||t.push(e)});else var t=[].concat(_toConsumableArray(i),_toConsumableArray(n),_toConsumableArray(a));t.forEach(function(e){e.click(),e.click()})};return I.addEventListener("Show",function(){if(n.tree&&n.tree._selectionNode&&"area"==i){var e=n.tree._selectionNode;e.eventManager.fireEvent("SelectionChanged",e,!0,!0)}A(i+"Panel")}),I};n.ModelTreePanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=(e.Bimface.Viewer.Viewer3D,e.Bimface.UI.Control.ControlEvent),l=new e.Bimface.UI.Button.ButtonConfig;l.id="ModelTree",l.title=BimfaceLanguage.bf_btn_modelTree,l.className="bf-button gld-bf-tree";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){n.hide();var a=t.getPanel("ModelTree");if(a){a.show();var o=t.tree;o._selectionNode}else{var l=new e.Bimface.Application.UI.Panel.ModelTreePanel(t,n);i.appendChild(l.element),t.addPanel(l)}}),r};t.ModelTree=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=(e.Bimface.Viewer.Viewer3D,e.Bimface.UI.Control.ControlEvent),l=new e.Bimface.UI.Button.ButtonConfig;l.id="MobileModelTree",l.title="构件树",l.className="bf-button gld-bf-tree";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){n.hide();var t=new e.Bimface.Application.UI.Panel.ModelTreePanel(a,i,n,!0);i.appendChild(t.element)}),r};t.MobileModelTree=n}();var Te={dev:"dev",build:"build"},Se=Te.build;Se||(Se=Te.dev);var xe=Se;!function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a="dev"==xe,i=function(t){var i=t.getViewer(),o=new e.Bimface.UI.Panel.PanelConfig,r=this,s=t.state;a=a?i.isSupportSSAO():a,this.viewer=i;var c;c=i._data.dataEnvType==ye.Local?i._data.sdkPath:l.staticHost,o.title=BimfaceLanguage.bf_btn_settings,o.id="Setting",o.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},o.enableSizable=!1,o.className="bf-panel bf-settings-panel";var d={1:{type:"multiple",direction:"0deg",colors:[{color:new e.Web.Graphics.Color(246,250,255,1),stop:"10%"},{color:new e.Web.Graphics.Color(214,224,235,1),stop:"70%"}]},2:{type:"skybox",skyBoxType:"CloudySky"},3:{type:"skybox",skyBoxType:"DarkNight"},4:{type:"single",color:new e.Web.Graphics.Color(92,92,92,1)},5:{type:"single",color:new e.Web.Graphics.Color(39,39,39,1)},6:{type:"single",color:new e.Web.Graphics.Color(50,71,91,1)}},f=new e.Bimface.UI.Panel.Panel(o),u=n.create("form","bf-setting"),m=n.create("div","bf-setting-foot"),p=[{id:"default",name:BimfaceLanguage.bf_panel_settings_interaction,title:BimfaceLanguage.bf_panel_settings_interaction},{id:"effect",name:BimfaceLanguage.bf_panel_settings_effect,title:BimfaceLanguage.bf_panel_settings_effect}],g=new e.Bimface.UI.Tabs.TabsConfig;g.className="bf-setting-tabs",g.default="default",g.options=p;var h=new e.Bimface.UI.Tabs.Tabs(g),b='<ul class="bf-setting-tab-default bf-show">\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_contextMenu+'</span>\n          <div class="bf-setting-value contextMenu">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(s.menu?"checked":"")+' data-value=\'true\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_on+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(s.menu?"":"checked")+' data-value=\'false\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_off+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_orbitBtn+'</span>\n          <div class="bf-setting-value setMouseBehavior">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(s.hobby?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_leftOrbit+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(s.hobby?"":"checked")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_rightOrbit+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_hover+'</span>\n          <div class="bf-setting-value mouseHover">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="hover" '+(s.hover?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_hoverEffect+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_zoomDir+'</span>\n          <div class="bf-setting-value mouseScroll">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="scroll" '+(s.scroll?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_reverseDir+'</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n\n        <ul class="bf-setting-tab-effect bf-scroll-bar">\n      \n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_border+'</span>\n          <div class="bf-setting-value setBorderLine">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="borderline" '+(s.borderLine?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_displayBorder+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_shadow+'：</span>\n          <div class="bf-setting-value enableShadow">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="shadow" '+(s.shadow?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableShadow+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li '+(a?"":"bf-setting-none")+'" style="display:none">\n          <span class="bf-setting-name">SSAO：</span>\n          <div class="bf-setting-value enableSSAO">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="SSAO" '+(s.SSAO?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_setting_ssao+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_exposure+'</span>\n          <div class="bf-setting-value bf-setting-range" id="exposure"></div>\n        </li>\n\n        <li class="bf-li-more">\n          <div class="bf-panel-more">\n            <span>'+BimfaceLanguage.bf_panel_settings_moreOpt+'</span>\n            <i class="bf-arrow"></i>\n          </div>\n        </li>\n        <div class="bf-more-list">\n          <li class="bf-setting-li">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_bgColor+'</span>\n            <div class="bf-color">\n              <div class="bf-color-item '+(1==s.backgroundColor?"bf-color-select":"")+'" data-value="1">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)"></span>\n              </div>\n              <div class="bf-color-item '+(2==s.backgroundColor?"bf-color-select":"")+'" data-value="2">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)">\n                  <img src="'+c+'/resources/SkyBox/thumbnails/CloudySky.png"/>\n                </span>\n              </div>\n              <div class="bf-color-item '+(3==s.backgroundColor?"bf-color-select":"")+'" data-value="3">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)">\n                  <img src="'+c+'/resources/SkyBox/thumbnails/DarkNight.png"/>\n                </span>\n              </div>\n              <div class="bf-color-item '+(4==s.backgroundColor?"bf-color-select":"")+'" data-value="4">\n                <span class="bf-color-node" style="background:#5c5c5c;"></span>\n              </div>\n              <div class="bf-color-item '+(5==s.backgroundColor?"bf-color-select":"")+'" data-value="5">\n                <span class="bf-color-node" style="background:#272727;"></span>\n              </div>\n              <div class="bf-color-item '+(6==s.backgroundColor?"bf-color-select":"")+'" data-value="6">\n                <span class="bf-color-node" style="background:#32475b;"></span>\n              </div>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li checkbox">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_ambientLight+'</span>\n            <div class="bf-setting-value ambientLight">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="ambientLight" '+(s.ambientLight?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableAbientLight+'</span>\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-thumbnail bf-setting-margin bf-enable-list '+(s.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_iblSel+'</span>\n            <div class="bf-thumbnail-value IBL-thumbnail">\n              <label class="'+("Gray"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Gray">\n                <img  src="'+c+'/resources/IBL/thumbnails/Gray.png" />\n              </label>\n              <label class="'+("HarborSunRise"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="HarborSunRise">\n                <img src="'+c+'/resources/IBL/thumbnails/HarborSunRise.png" />\n              </label>\n              <label class="'+("ParkingLot"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="ParkingLot">\n                <img src="'+c+'/resources/IBL/thumbnails/ParkingLot.png" />\n              </label>\n              <label class="'+("RiverSide"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="RiverSide">\n                <img src="'+c+'/resources/IBL/thumbnails/RiverSide.png" />\n              </label>\n              <label class="'+("Sunrise"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Sunrise">\n                <img src="'+c+'/resources/IBL/thumbnails/Sunrise.png" />\n              </label>\n              <label class="'+("SunsetGrass"==s.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="SunsetGrass">\n                <img src="'+c+'/resources/IBL/thumbnails/SunsetGrass.png" />\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li bf-setting-margin bf-enable-list '+(s.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name"></span>\n            <div class="bf-setting-value IBLBackground">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="enableIBLBackground" '+(s.enableIBLBackground?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_iblBgDisplay+"</span>\n              </label>\n            </div>\n          </li>\n        </div>\n        </ul>",v='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";u.innerHTML=b,m.innerHTML=v,h.addEventListener("Change",function(e){"default"==e.id?(f.body.querySelector(".bf-setting-tab-default").addClass("bf-show"),f.body.querySelector(".bf-setting-tab-effect").removeClass("bf-show")):(f.body.querySelector(".bf-setting-tab-default").removeClass("bf-show"),f.body.querySelector(".bf-setting-tab-effect").addClass("bf-show"))});for(var y=u.querySelectorAll(".contextMenu .bf-radio-input"),C=0,B=y.length;C<B;C++)y[C].addEventListener("change",function(){r.viewer.toggleContextMenuDisplay()});for(var w=u.querySelectorAll(".setMouseBehavior .bf-radio-input"),L=0,M=w.length;L<M;L++)!function(e,t){w[e].addEventListener("change",function(){var t=e;i.setUseLeftHandedInput(!t)})}(L);var T=u.querySelector(".mouseHover .bf-checkbox-input");T.addEventListener("change",function(){var e=i.isEnableHover();i.enableHover(!e)});var S=u.querySelector(".mouseScroll .bf-checkbox-input");S.addEventListener("change",function(){i.setReverseWheelDirection(this.checked)});var x=u.querySelector(".setBorderLine .bf-checkbox-input");x.addEventListener("change",function(){i.setBorderLineEnabled(this.checked),i.render()});var k=[{id:"low",name:BimfaceLanguage.bf_panel_settings_bestAppear},{id:"high",name:BimfaceLanguage.bf_panel_settings_bestPerform}],I=new e.Bimface.UI.Select.SelectConfig;I.className="bf-select bf-select-mode",I.options=k;var _=u.querySelector(".enableShadow .bf-checkbox-input");_.addEventListener("change",function(){for(var e=i.lightManager.getAllDirectionalLights(),t=0;t<e.length;t++)e[t].enableShadow(this.checked);i.render()}),_.checked=4==CLOUD.GlobalData.LightPreset;var E=u.querySelector(".enableSSAO .bf-checkbox-input");E.addEventListener("change",function(){i.enableSSAO(this.checked),i.render()});var N=new e.Web.Lang.Utility.Dom.range({element:u.querySelector("#exposure"),min:-1,max:1,step:.1,cur:s.exposure,change:function(e){i.setExposureShift(e),i.render()}}),P=u.querySelector(".bf-panel-more"),U=u.querySelector(".bf-more-list");P.addEventListener("click",function(){P.toggleClass("bf-show-more"),U.toggleClass("bf-show")});var A=new e.Bimface.Plugins.SkyBox.SkyBoxManagerConfig;A.viewer=i;for(var V=new e.Bimface.Plugins.SkyBox.SkyBoxManager(A),z=u.querySelectorAll(".bf-color .bf-color-item"),D=0,H=z.length;D<H;D++)!function(e,t){z[e].addEventListener("click",function(){for(var n=this.getAttribute("data-value"),a=d[n],o=a.type,l=0;l<t;l++)z[l].removeClass("bf-color-select");if(z[e].addClass("bf-color-select"),"single"==o){V.enableSkyBox(!1);var r=a.color;i.setBackgroundColor(r)}else if("multiple"==o){V.enableSkyBox(!1);var s=a.direction,c=a.colors;i.setBackgroundColors(c,s)}else i._opt.skyBoxType=a.skyBoxType,V.enableSkyBox(!0),a.skyBoxType&&V.setStyle(a.skyBoxType)})}(D,H);var W=u.querySelector(".IBL-thumbnail"),F=W.querySelectorAll(".bf-thumbnail-item"),O=u.querySelector(".ambientLight .bf-checkbox-input"),R=u.querySelectorAll(".bf-enable-list");O.addEventListener("change",function(){for(var t=this.checked,n=0;n<R.length;n++)R[n].toggleClass("bf-setting-disabled",!t);if(t){var a=u.querySelector(".IBL-thumbnail .selected");i.setLightingMode(e.Bimface.Viewer.LightingMode.IBL);var o;a?o=a.getAttribute("id"):(F[0].addClass("selected"),o=F[0].id),i.loadIBLScene(o,q.checked)}else{i.enableIBLBackground(!1),i.setLightingMode(e.Bimface.Viewer.LightingMode.Phong);var a=u.querySelector(".IBL-thumbnail .selected");a&&a.removeClass("selected"),q.checked=!1,i._opt.enableSky&&V.enableSkyBox(!0),i.render()}}),W.addEventListener("click",function(t){if(i.isEnableIBLBackground()&&"IMG"==t.target.nodeName)for(var n=t.target.parentNode,a=n.id,o=0,l=F.length;o<l;o++)F[o].removeClass("selected"),F[o]==n&&(n.addClass("selected"),i.setLightingMode(e.Bimface.Viewer.LightingMode.IBL),i.loadIBLScene(a,q.checked))});var q=u.querySelector(".IBLBackground .bf-checkbox-input");return q.addEventListener("change",function(){if(!i.isEnableIBLBackground())return void(this.checked=!1);var e=this.checked;i.enableIBLBackground(e),!e&&i._opt.enableSkyBox&&V.enableSkyBox(!0),i.render()}),m.querySelector(".reset").addEventListener("click",function(){h.setCurrentOption("default"),y[s.menu?0:1].checked=!0,i.toggleContextMenuDisplay(s.menu),w[0].click(),T.checked=s.hover,i.enableHover(s.hover),S.checked=s.scroll,i.setReverseWheelDirection(s.scroll),x.checked=s.borderLine,i.setBorderLineEnabled(s.borderLine);for(var e=i.getDefaultModel().isShadowDafault(),t=i.lightManager.getAllDirectionalLights(),n=0;n<t.length;n++)t[n].enableShadow(e);_.checked=e,i.enableSSAO(!1),E.checked=!1,N.setProgress(s.exposure),i.setExposureShift(s.exposure),P.removeClass("bf-show-more"),U.removeClass("bf-show"),z[0].click(),O.checked!=s.ambientLight&&O.click();for(var n=0,a=F.length;n<a;n++)F[n].removeClass("selected"),F[n].id==s.IBLName&&F[n].addClass("selected");q.checked=s.enableIBLBackground,i.loadIBLScene(s.IBLName,s.enableIBLBackground),i.render()}),f.setContainerHeader(h.element),f.container.appendChild(u),f.container.appendChild(m),f};t.SettingPanel=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o="Viewer3D"==a.viewerType,l="ViewerDrawing"==a.viewerType,r=e.Bimface.UI.Control.ControlEvent;if(!o&&!l)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="Setting",s.title=BimfaceLanguage.bf_btn_settings,s.className="bf-button gld-bf-settings";var c=new e.Bimface.UI.Button.ToggleButton(s);return c.addEventListener(r.StateChange,function(n){var l=t.getPanel("Setting");if(n?l?l.show():(l=o&&new e.Bimface.Application.UI.Panel.SettingPanel(t)||new e.Bimface.Application.UI.Panel.PrintModePanel(t),l.addEventListener("Hide",function(){c.setCheckedState(!1)}),i.appendChild(l.element),l.bringToFront(),t.addPanel(l)):l.hide(),o){var r=e.Bimface.Viewer.Viewer3DEvent;a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:n})}}),c};t.Setting=n}();var ke=function(t,n){t.num||(t.num=0);var a=!1,i=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),o=i.create("div","bf-route-form"),l=i.create("div","bf-route-info"),r=i.create("div","bf-route-info-row"),s=i.create("span","bf-route-info-label");s.innerText=BimfaceLanguage.bf_panel_nav_name;var c=i.create("input","bf-route-info-input");c.value=t._walkthrough.getName(),r.appendChild(s),r.appendChild(c);var d=i.create("div","bf-route-info-input"),f=i.create("div","bf-route-info-row"),u=i.create("span","bf-route-info-label");u.innerText=BimfaceLanguage.bf_panel_nav_time;var m=i.create("input","bf-route-info-time");m.setAttribute("type","number"),m.value=t._walkthrough.walkthroughTime,m.setAttribute("min","1"),m.setAttribute("max","120");var p=i.create("span","bf-route-info-timespan");p.innerHTML=BimfaceLanguage.bf_panel_nav_second,d.appendChild(m),d.appendChild(p),f.appendChild(u),f.appendChild(d),l.appendChild(r),l.appendChild(f)
;var g=i.create("div","bf-route-title"),h=i.create("span","bf-route-add");h.innerHTML='<i class="bf-icon-add"></i><span>'+BimfaceLanguage.bf_panel_nav_addKeyframe+"</span>";var b=i.create("span","bf-route-clear");b.innerText=BimfaceLanguage.bf_panel_nav_clearKeyframe,g.appendChild(h),g.appendChild(b);var v=i.create("div","bf-route-panel-tips");v.innerText=BimfaceLanguage.bf_panel_nav_addHere;var y=i.create("ul","bf-route-list bf-scroll-bar"),C=i.create("div","bf-route-foot"),B=i.create("div","bf-route-control bf-route-disabled");B.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",C.appendChild(B),o.appendChild(l),o.appendChild(g),o.appendChild(v),o.appendChild(y),o.appendChild(C),o.saveWalkthrough=function(){if(0===y.childElementCount)return!1;for(var e=[],n=0;n<y.childElementCount;n++)e.push(y.children[n].keyFrame);return t.setKeyFrames(e),""!==m.value&&parseFloat(m.value)>0?t.setWalkthroughTime(parseFloat(m.value)):(m.value=t._walkthrough.walkthroughTime,d.removeClass("bf-route-info-input-invalid")),""!==c.value?t._walkthrough.setName(c.value):(c.value=t._walkthrough.getName(),c.removeClass("bf-route-info-input-invalid")),!0};var w=function(e,t,o){v.style.display="none";var l=i.create("div","bf-route-li"),r=i.create("div","bf-route-box"),s=i.create("span","bf-route-button");s.innerText=BimfaceLanguage.bf_general_delete;var c=i.create("span","bf-route-button bf-route-play");c.innerText=BimfaceLanguage.bf_panel_nav_play;var d=i.create("span","bf-route-name");d.innerText=e,o&&(l.camera=o),l.keyFrame=t,r.appendChild(c),r.appendChild(s),l.appendChild(d),l.appendChild(r),l.addEventListener("click",function(e){var t=e,i=t.target;a||i!=s&&i!=c&&(L?L!==l&&(L.removeClass("bf-selected"),l.addClass("bf-selected"),L=l):(l.addClass("bf-selected"),L=l),n.setCameraStatus(l.camera))}),c.addEventListener("click",function(e){M(l.keyFrame.id)}),s.addEventListener("click",function(e){L==l&&(L=null),y.removeChild(l),y.childElementCount<2&&B.addClass("bf-route-disabled"),0==y.childElementCount&&(v.style.display="block")}),L?(L.after(l),L.removeClass("bf-selected"),L=null):y.appendChild(l),y.childElementCount>=2&&B.removeClass("bf-route-disabled")};!function(){var e=t._walkthrough.getKeyFrames();if(e&&e.length>0)for(var a=0;a<e.length;a++){var i=e[a],o=i.name||""+BimfaceLanguage.bf_panel_nav_keyframe+t.num++,l=n.getCameraStatus();l.position=n.getViewer().drawingToWorld(i.position),l.target=n.getViewer().drawingToWorld(i.target),l.up={x:0,y:0,z:1},w(o,i,l)}}();var L=!1;c.addEventListener("blur",function(){""===c.value?c.addClass("bf-route-info-input-invalid"):c.removeClass("bf-route-info-input-invalid")}),m.addEventListener("blur",function(){""===m.value||Number(m.value)<=0?d.addClass("bf-route-info-input-invalid"):d.removeClass("bf-route-info-input-invalid")}),h.addEventListener("click",function(){if(!a){var e=n.getCameraStatus(),i=""+BimfaceLanguage.bf_panel_nav_keyframe+t.num++,o=t.addKeyFrame(i);w(i,o,e)}}),b.addEventListener("click",function(){a||(t.clearKeyFrames(),y.innerHTML="",L=null,B.addClass("bf-route-disabled"),v.style.display="block")});var M=function(e){o.saveWalkthrough(),t.play(e),y.addClass("bf-route-disabled"),b.addClass("bf-route-disabled"),h.addClass("bf-route-disabled"),m.setAttribute("disabled",!0),c.setAttribute("disabled",!0),B.innerHTML='<i class="bf-icon-stop"></i><span>'+BimfaceLanguage.bf_panel_nav_stop+"</span>",document.querySelector(".bf-routes-return").addClass("bf-routes-disabled"),a=!0};return B.addEventListener("click",function(){this.hasClass("bf-route-disabled")||(a?(y.removeClass("bf-route-disabled"),b.removeClass("bf-route-disabled"),h.removeClass("bf-route-disabled"),m.removeAttribute("disabled"),c.removeAttribute("disabled"),this.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",t.stop(),L=!1):M())}),t.stopCallback(function(){y.removeClass("bf-route-disabled"),b.removeClass("bf-route-disabled"),h.removeClass("bf-route-disabled"),m.removeAttribute("disabled"),c.removeAttribute("disabled"),B.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",L&&L.removeClass("bf-selected"),document.querySelector(".bf-routes-return").removeClass("bf-routes-disabled"),a=!1}),t.setKeyFrameCallback(function(e){var t=e;L&&L.removeClass("bf-selected"),y.children[t].addClass("bf-selected"),L=y.children[t]}),o.stopWalkthrough=function(){a&&B.click()},o},Ie=function t(n,a){function i(e){e.style.display="block"}function o(e){e.style.display="none"}var l=0,r=!1,s=null,c=null,d=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),f=d.create("div","bf-routes-panel"),u=d.create("div","bf-routes-form"),m=d.create("div","bf-routes-title"),p=d.create("span","bf-routes-create");p.innerHTML='<i class="bf-icon-create"></i><span>'+BimfaceLanguage.bf_panel_nav_addWalkthrough+"</span>";var g=d.create("span","bf-routes-return");g.innerText=BimfaceLanguage.bf_panel_nav_walkthroughList;var h=d.create("div","bf-routes-split");m.appendChild(p),m.appendChild(g),f.appendChild(m),f.appendChild(h);var b=d.create("div","bf-routes-panel-tips");b.innerText=BimfaceLanguage.bf_panel_nav_addWalkthroughHere;var v=d.create("ul","bf-routes-list bf-scroll-bar");u.appendChild(b),u.appendChild(v),f.appendChild(u);var y=!1,C=!1,B=null,w=function(){C=!1,B&&"[object Function]"===Object.prototype.toString.call(B)&&B(),B=null},L=null,M=function(t){if(!r){s&&(f.removeChild(s),s=null);var m,h;if(!t||t instanceof MouseEvent){var M=new e.Bimface.Plugins.Walkthrough.WalkthroughConfig;M.viewer=a,m=new e.Bimface.Plugins.Walkthrough.Walkthrough(M),h=BimfaceLanguage.bf_panel_nav_walkthrough1+ ++l,m.setWalkthroughTime(20),c=n.addWalkthrough(h,m),s=ke(m,a),f.appendChild(s),o(u),o(p),i(g),L=!0}else m=t.walkthrough,h=t.walkthrough._walkthrough.getName(),c=t.id;o(b);var T=d.create("div","bf-routes-li"),S=d.create("div","bf-routes-box"),x=d.create("span","bf-routes-button");x.innerText=BimfaceLanguage.bf_general_edit;var k=d.create("span","bf-routes-button");k.innerText=BimfaceLanguage.bf_general_delete;var I=d.create("span","bf-routes-name");I.innerText=h,S.appendChild(x),S.appendChild(k);var _=d.create("div","bf-routes-play"),E=d.create("div","bf-routes-stop");T.appendChild(_),T.appendChild(E),T.appendChild(I),T.appendChild(S),T.setAttribute("walkthroughId",c);var N=function(e){var t=n._walkthroughMap[e],a=t.walkthrough._stopCallback;(!a||a.toString().indexOf("originCb")<0)&&t.walkthrough.stopCallback(function(){a(),o(E),i(_),y?y=!1:(v.removeClass("bf-routes-disabled"),p.removeClass("bf-routes-disabled"),r=!1)})},P=function(){v.querySelector(".bf-selected")&&v.querySelector(".bf-selected").removeClass("bf-selected"),v.querySelector('.bf-routes-li[walkthroughId="'+c+'"]').addClass("bf-selected")},U=function(e,t){var l=function(){if(r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+c+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1}},d=function(){var e=s.querySelector(".bf-route-control");!e.hasClass("bf-route-disabled")&&e.querySelector(".bf-icon-stop")?e.click():n._walkthroughMap[t].walkthrough.bPause&&n._walkthroughMap[t].walkthrough.stop()},m=function(){if(t!==c&&s&&(f.removeChild(s),s=null),!s){c=t;var e=n._walkthroughMap[c];s=ke(e.walkthrough,a),N(t),o(s),f.appendChild(s)}};switch(e){case"play":return function(e){var a=this;if(C)return void(B=function(){a.click()});y=!1,l(),m(),P();var c=s.querySelector(".bf-route-control");if(!c.hasClass("bf-route-disabled")&&c.querySelector(".bf-icon-play"))c.click();else{if(!n._walkthroughMap[t].walkthrough.bPause)return;n._walkthroughMap[t].walkthrough.play()}r=!0,v.addClass("bf-routes-disabled"),p.addClass("bf-routes-disabled"),o(_),i(E)};case"select":return function(e){y=!1,c!==t&&l(),m(),d(),P();var n=s.querySelector(".bf-route-list");n.childElementCount>0&&(C=!0,a.setCameraStatus(n.firstElementChild.camera,w))};case"stop":return function(e){y=!1,r&&(o(E),i(_),n._walkthroughMap[t].walkthrough.pause(),r=!1,v.removeClass("bf-routes-disabled"),p.removeClass("bf-routes-disabled"))};case"edit":return function(e){if(y=!1,!r){m(),d(),P(),o(u),o(p),i(g),i(s),L=!1;var t=s.querySelector(".bf-route-list");t.childElementCount>0&&(C=!0,a.setCameraStatus(t.firstElementChild.camera,w))}};case"delete":return function(e){y=!1,r||(v.removeChild(v.querySelector('.bf-routes-li[walkthroughId="'+t+'"]')),n.removeWalkthrough(t),8===v.childElementCount&&v.removeClass("bf-routes-list-scroll"),0===v.childElementCount&&i(b))}}};_.addEventListener("click",U("play",c)),E.addEventListener("click",U("stop",c)),x.addEventListener("click",U("edit",c)),k.addEventListener("click",U("delete",c)),I.addEventListener("click",U("select",c)),N(c),v.appendChild(T),v.childElementCount>8&&v.addClass("bf-routes-list-scroll"),g.removeClass("bf-routes-disabled"),P()}};return p.addEventListener("click",M),g.addEventListener("click",function(){if(!this.hasClass("bf-routes-disabled")){if(s.saveWalkthrough()){var e=n._walkthroughMap[c];v.querySelector('.bf-routes-li[walkthroughId="'+c+'"]').querySelector(".bf-routes-name").innerHTML=e.walkthrough._walkthrough.getName()}else v.querySelector('.bf-routes-li[walkthroughId="'+c+'"]').querySelector(".bf-routes-box").lastElementChild.click(),L&&l--;o(s),o(g),i(u),i(p)}}),t.loadWalkthrough=function(e){n.setWalkthroughList(e);for(var t in n._walkthroughMap)M(n._walkthroughMap[t])},t.stopWalkthrough=function(){if("none"!==u.style.display&&r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+c+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1,v.removeClass("bf-routes-disabled"),p.removeClass("bf-routes-disabled")}else s&&s.stopWalkthrough()},f};!function(){var t=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel")),n=function(t){var n=t.getViewer(),a=new e.Bimface.UI.Panel.PanelConfig;a.title=BimfaceLanguage.bf_panel_nav_walkthrough,a.id="WalkRoutePanel",a.css={right:"10px",top:"10px",width:"300px",height:"410px"},a.enableSizable=!1;var i=new e.Bimface.UI.Panel.Panel(a),a=new e.Bimface.Plugins.Walkthrough.WalkthroughManagerConfig;a.viewer=n;var o=new e.Bimface.Plugins.Walkthrough.WalkthroughManager(a),l=Ie(o,n);return i.container.appendChild(l),i.addEventListener("Hide",function(){Ie.stopWalkthrough()}),i.loadWalkthrough=Ie.loadWalkthrough,o.id="WalkthroughManager",t.addPlugin(o),i};t.WalkRoutePanel=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){function a(){V.disabled=!0,V.checked=!0,"Walking"==I?(m=1,f.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.ThirdPerson)):(m=3,f.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.ThirdPersonRun)),o()}function i(t){N=!N;var n=t.target,i=M.querySelector(".gravity");if(N){if(S.hasClass("active")){if(document.querySelector(".bf-icon-stop"))return;for(var o=document.querySelectorAll(".bf-routes-stop"),l=0;l<o.length;l++){if("block"==o[l].style.display)return}S.click()}M.addClass("bf-third-person-mode"),i.addClass("bf-walk-disabled"),n.addClass("active"),n.title=BimfaceLanguage.bf_panel_nav_tip_third_person,a()}else V.disabled=!1,M.removeClass("bf-third-person-mode"),i.removeClass("bf-walk-disabled"),n.removeClass("active"),n.title=BimfaceLanguage.bf_panel_nav_tip_first_person,f.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.Walk);f.enableGravity(V.checked)}function o(){var e=p[m];A.innerText=e+"X",f.setFlySpeedRate(parseFloat(e))}function l(){m<p.length-1&&(m++,o())}function r(){m&&(m--,o())}function s(e){var t,n=M.querySelector(".gld-bf-map"),a=document.querySelector(".gld-bf-min-");a&&a.click(),!0===e?(t=!0,u.addClass("walker")):t=!w._checked,t?n.addClass("active"):n.removeClass("active"),w.setCheckedState(t)}function c(){var e=t.getPanel("WalkRoutePanel");e&&h.getWalkthrough(function(t){e.loadWalkthrough(t)})}function d(){var n=this,a=M.querySelectorAll(".bf-walk-label"),i=t.getPanel("WalkRoutePanel");if(n.hasClass("active")){n.removeClass("active"),i&&i.hide();for(var o=0;o<a.length;o++)a[o].removeClass("bf-walk-disabled"),V.disabled=!1,z.disabled=!1}else{if(n.addClass("active"),x.hasClass("active")&&x.click(),i)i.show();else{var l=new e.Bimface.Application.UI.Panel.WalkRoutePanel(t);l.addEventListener("Hide",function(){n.removeClass("active");for(var e=0;e<a.length;e++)a[e].removeClass("bf-walk-disabled"),V.disabled=!1,z.disabled=!1;V.disabled=!1,z.disabled=!1}),u.appendChild(l.element),t.addPanel(l),f._manifest&&f._manifest.Features_ext&&f._manifest.Features_ext.HasWalkthrough&&c()}for(var o=0;o<a.length;o++)a[o].addClass("bf-walk-disabled");V.checked=!1,V.disabled=!0,f.enableGravity(!1),z.checked=!1,z.disabled=!0,f.enableHitDetection(!1)}}var f=t.getViewer(),u=t.getRootElement(),m=0,p=["1","2","4","8","16"],g=(f.getViewer(),e.Bimface.UI.Control.ControlEvent),h=f.getDefaultModel()._getMetaDataManager(),b={zh_CN:"560",en_GB:"594",sv_SE:"615"},v=b[BimfaceLanguage.name],y={element:u,className:"bf-panel bf-walk-panel bf-walkthrough-panel",id:"WalkPanel",css:{left:"50%",bottom:"10px",width:v+"px",minWidth:0,minHeight:0,height:"50px"},title:"",enableSizable:!1},C=t.getToolbar("MainToolbar"),B="",w=C.getControl("Map");w?(B='<div class="bf-button gld-bf-map active"></div>',w.addEventListener(g.StateChange,function(e){if(!e){M.querySelector(".gld-bf-map").removeClass("active")}})):y.css.width=v-50+"px";var L=new e.Bimface.Application.Panel(y),M=n.create("div","bf-person"),T='<div class="bf-walk-button">'+B+'</div>\n                <div class="bf-walk-button">\n                  <div class="bf-button gld-bf-route" title="'+BimfaceLanguage.bf_panel_nav_walkthrough+'"></div>\n                </div>\n                <div class="bf-walk-button">\n                  <div class="bf-button gld-bf-third-person-lg" title="'+BimfaceLanguage.bf_panel_nav_tip_first_person+'"></div>\n                </div>\n               \n                <div  class="bf-walk-button mode-select"></div>\n         \n                      <div class="bf-walk-speed">\n                        <span class="bf-walk-name">'+BimfaceLanguage.bf_panel_nav_speed+'</span>\n                        <span class="gld-bf-minus speedBtn"></span><span class="speedNum">'+p[m]+' X</span>\n                        <span class="gld-bf-add speedBtn"></span>\n                      </div>\n                      <label class="bf-checkbox bf-walk-label gravity">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-gravity" name="gravity">\n                        <span class="bf-checkbox-display "></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <label class="bf-checkbox bf-walk-label">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-collision" name="collision"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_collision+'</span>\n                      </label>\n                      <span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span>";M.innerHTML=T;var S=M.querySelector(".gld-bf-route"),x=M.querySelector(".gld-bf-third-person-lg");M.querySelector(".gld-bf-add").addEventListener("click",l),M.querySelector(".gld-bf-minus").addEventListener("click",r),w&&M.querySelector(".gld-bf-map").addEventListener("click",s),S.addEventListener("click",d),x.addEventListener("click",i),L.container.appendChild(M);var k=[{id:"Walking",name:BimfaceLanguage.bf_panel_nav_walking},{id:"Running",name:BimfaceLanguage.bf_panel_nav_running}],I="Walking",_=new e.Bimface.UI.Select.SelectConfig;_.className="bf-select bf-select-mode",_.options=k,_.position="top";var E=new e.Bimface.UI.Select.Select(_);M.querySelector(".mode-select").appendChild(E.element),E.addEventListener("Change",function(e){I=e.id,a()});var N=!1,P=new e.Bimface.UI.Tips.TipsConfig;P.element=u,P.html="<div>\n                            "+BimfaceLanguage.bf_panel_nav_walkTips1+'\n                            <span class="bf-tips-key">W</span>\n                            <span class="bf-tips-key">A</span>\n                            <span class="bf-tips-key">S</span>\n                            <span class="bf-tips-key">D</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips2+'\n                            <span class="bf-tips-key">Q</span>\n                            <span class="bf-tips-key">E</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips3+"\n                            </div>";var U=new e.Bimface.UI.Tips.Tips(P);CLOUD.EditorConfig.NoKey&&U.hide(),M.querySelector(".bf-walk-exit").addEventListener("click",function(){L.hide();for(var e=t.getToolbars(),n=0;n<e.length;n++)e[n].show()}),L.addEventListener("Close",function(){U.close()}),L.addEventListener("Hide",function(){U.hide(),u.removeClass("walker");var e=t.getPanel("WalkRoutePanel");e&&e.hide()}),L.addEventListener("Show",function(){CLOUD.EditorConfig.NoKey||U.show(),u.addClass("walker"),N&&a(),w&&s(!0)});var A=M.querySelector(".speedNum"),V=M.querySelector(".bf-walk-gravity");V.addEventListener("change",function(){f.enableGravity(this.checked)});var z=M.querySelector(".bf-walk-collision");return z.addEventListener("change",function(){f.enableHitDetection(this.checked)}),w&&s(!0),o(),L};t.WalkPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){function a(){var e=y[v];x.innerText=e+"X",h.setFlySpeedRate(parseFloat(e))}function i(e){e.preventDefault(),e.stopPropagation(),v<y.length-1&&(v++,a())}function o(e){e.preventDefault(),e.stopPropagation(),v&&(v--,a())}function l(e){e.preventDefault(),e.stopPropagation(),C.moveTo(CLOUD.MoveDirection.UP,1)}function r(e){e.preventDefault(),e.stopPropagation(),C.moveTo(CLOUD.MoveDirection.DOWN,1)}function s(){k=S.getBoundingClientRect(),I=[k.left+.5*k.width,k.top+.5*k.height],_=S.querySelector(".ball"),N=C.getCurrentEditor(),P={panelRadius:k.width/2,radiusPow:Math.pow(k.width/2,2),smallRadiusPow:Math.pow((k.width-_.offsetWidth)/2,2),up:[(k.width-_.offsetWidth)/2,0],down:[(k.width-_.offsetWidth)/2,k.height-_.offsetHeight],left:[0,(k.height-_.offsetHeight)/2],right:[k.width-_.offsetWidth,(k.height-_.offsetHeight)/2],refresh:[(k.width-_.offsetWidth)/2,(k.height-_.offsetHeight)/2]}}function c(e){e.preventDefault(),U=e.touches[0],m()}function d(e){e.preventDefault(),U=e.touches[0],m()}function f(e){p("refresh"),u()}function u(){C.moveTo(CLOUD.MoveDirection.FORWARD,1,!1),C.moveTo(CLOUD.MoveDirection.BACK,1,!1),C.moveTo(CLOUD.MoveDirection.UP,1,!1),C.moveTo(CLOUD.MoveDirection.DOWN,1,!1)}function m(){var e=U.pageY-I[1],t=U.pageX-I[0];E=e/t,p(E>0?E>2.2?e>0?"down":"up":e>0?"right":"left":E<-2.2?e>0?"down":"up":e>0?"left":"right")}function p(e){switch(u(),e){case"up":C.moveTo(CLOUD.MoveDirection.FORWARD,1),C.render();break;case"down":C.moveTo(CLOUD.MoveDirection.BACK,1),C.render();break;case"left":N._doRotate({x:-1,y:0});break;case"right":N._doRotate({x:1,y:0})}"refresh"==e?g():g(U)}function g(e){if(e){var t=e.pageX-I[0],n=e.pageY-I[1],a=Math.pow(t,2),i=Math.pow(n,2),o=i+a;if(Math.sqrt(o)+_.offsetWidth/2<P.panelRadius)var l=e.pageY-_.offsetHeight/2-k.top,r=e.pageX-_.offsetWidth/2-k.left;else{var s=Math.sqrt(P.smallRadiusPow*a/o),c=Math.sqrt(P.smallRadiusPow*i/o);r=e.pageX-I[0]>0?P.panelRadius+s-_.offsetWidth/2:P.panelRadius-s-_.offsetWidth/2,l=e.pageY-I[1]>0?P.panelRadius+c-_.offsetWidth/2:P.panelRadius-c-_.offsetWidth/2}_.style.left=r+"px",_.style.top=l+"px"}else _.style.left=P.refresh[0]+"px",_.style.top=P.refresh[1]+"px"}var h=t.getViewer(),b=t.getRootElement(),v=0,y=["1","2","4","8","16"],C=h.getViewer(),B={element:b,className:"bf-panel bf-walk-panel",id:"WalkPanel",css:{minWidth:"auto",minHeight:"auto",bottom:"0.12em",width:"100%",height:"3.5em"},title:"",enableSizable:!1},w=new e.Bimface.Application.Panel(B),L=n.create("div","bf-quit");L.innerHTML='<span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span><span class='close'></span>",b.appendChild(L),w.addEventListener("Show",function(){L.style.display="block"});var M=n.create("div","bf-person"),T='<div class="person-btns">\n\n                      <span class="gld-bf-minus speedBtn"></span>\n                      <span class="speedNum">'+y[v]+' X</span>\n                      <span class="gld-bf-add speedBtn"></span>\n                      <label class="bf-checkbox bf-walk-gravity">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-input" name="gravity"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <div class=\'jump\'>\n\n                        <span class="bf-button gld-bf-up  arrow-up"></span>\n                        <span class="bf-button gld-bf-down  arrow-down"></span>\n                      </div>\n                    </div>',S=n.create("div","controllerPanel");M.innerHTML=T,S.innerHTML='<div class="ball">\n\n                    </div>',S.addEventListener("touchstart",c),S.addEventListener("touchmove",d),S.addEventListener("touchend",f),M.querySelector(".gld-bf-add").addEventListener("click",i),M.querySelector(".gld-bf-minus").addEventListener("click",o),M.querySelector(".arrow-up").addEventListener("touchstart",l),M.querySelector(".arrow-down").addEventListener("touchstart",r),M.querySelector(".arrow-up").addEventListener("touchend",u),M.querySelector(".arrow-down").addEventListener("touchend",u),w.container.appendChild(M),w.element.appendChild(S),L.addEventListener("click",function(){w.hide(),L.style.display="none";for(var e=t.getToolbars(),n=0;n<e.length;n++)e[n].show()});var x=M.querySelector(".speedNum");M.querySelector(".bf-walk-input").addEventListener("change",function(){h.enableGravity(this.checked)});var k,I,_,E,N,P,U;return s(),window.onresize=function(){s()},w};t.WalkMobilePanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=a instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var c=new e.Bimface.UI.Button.ButtonConfig;c.id="Walk",c.title=BimfaceLanguage.bf_btn_nav,c.className="bf-button gld-bf-firstperson";var d,f,u=new e.Bimface.UI.Button.ToggleButton(c);a.getViewer();return u.addEventListener(l.StateChange,function(){if(a.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:c.id,isChecked:u.isChecked()}),u.isChecked()){var o=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),l=n.getControl("RectangleSelect");l&&l.setCheckedState(!1),a.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.Select);var m=n.getControl("Measure");m&&m.setCheckedState(!1),s(t);var p=n.getControl("RectangleSelect");p&&p.setCheckedState(!1);var g=n.getControl("Property");g&&g.setCheckedState(!1);var h=n.getControl("Information");h&&h.setCheckedState(!1);var b=n.getControl("Setting");b&&b.setCheckedState(!1),t.modelTreePanel&&t.modelTreePanel.hide();for(var v=t.getToolbars(),y=t.getPanels(),C=0;C<y.length;C++)"WalkPanel"!=y[C].id&&"MapPanel"!=y[C].id&&y[C].isDisplay()&&y[C].hide();for(var B=0;B<v.length;B++)v[B].hide();if(f=!!document.querySelector(".bf-house canvas"),a.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.Walk),a.hideViewHouse(),a.getModels().forEach(function(e){e.setSelectedComponentsById()}),a.render(),d)return void d.show();d=o?new e.Bimface.Application.UI.Panel.WalkPanel(t):new e.Bimface.Application.UI.Panel.WalkMobilePanel(t),d.addEventListener("Hide",function(){u.setCheckedState(!1)}),i.appendChild(d.element),d.bringToFront(),t.addPanel(d)}else{for(var v=t.getToolbars(),B=0;B<v.length;B++)v[B].show();a.setNavigationMode(e.Bimface.Viewer.NavigationMode3D.PickWithRect),f&&a.showViewHouse(),d.hide()}}),u};t.Walk=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="Interactive",l.title="交互",l.inheritTitle=!0;var r=new e.Bimface.UI.Button.ComboBox(l),s=new e.Bimface.UI.Button.ButtonConfig;s.id="OrbitPoint",s.title="绕构件旋转",s.className="bf-button gld-bf-orbit";var c=new e.Bimface.UI.Button.ComboBoxOptionButton(s),d=new e.Bimface.UI.Button.ButtonConfig;d.id="OrbitCamera",d.title="绕相机旋转",d.className="bf-button gld-bf-pan";var f=new e.Bimface.UI.Button.ComboBoxOptionButton(d),u=new e.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-zoom";var m=new e.Bimface.UI.Button.ComboBoxOptionButton(u);return r.addControl(c),r.addControl(f),r.addControl(m),r.addEventListener(o.Change,function(e){}),r.addEventListener(o.Click,function(e){var t=n.getControl("ViewButton");t&&t.recover()}),r};t.Interactive=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(n){var a=n.getViewer(),i=new e.Bimface.UI.Panel.PanelConfig;i.title="",i.id="MapPanel",i.css={left:"12px",bottom:"10px",width:"300px",height:"240px"},i.className="bf-panel bf-map bf-map-panel",i.enableSizable=!1;var o=new e.Bimface.UI.Panel.Panel(i),l=e.Bimface.Plugins.Map.MapEvents,r=t.create("div","bf-map-header"),s=t.create("div","bf-map-move"),d=t.create("div","bf-map-foot"),f=t.create("div","bf-map-container"),u=t.create("i","bf-map-fit-panel-min gld-bimface gld-bf-fitpanel"),p=t.create("i","bf-map-screen gld-bimface gld-bf-max-"),g=t.create("div","bf-map-right");d.innerHTML='<div class="bf-map-left"><i class="gld-bimface gld-bf-information"></i><span>'+BimfaceLanguage.bf_panel_map_cut+"</span></div>",d.appendChild(g);var h=new e.Bimface.Plugins.Map.MapConfig;h.viewer=a,h.domElement=f,h.width=298,h.height=198,h.id="Map";var b=new e.Bimface.Plugins.Map.Map(h);n.addPlugin(b);var v=b.getFloorList(),y=new e.Bimface.UI.Select.SelectConfig;y.className="bf-select bf-select-map";var C=b.getDefaultFloorPlane(),B=v.getObjectByAttribute("name",C);0!=B&&(y.default=B.id),y.options=v,y.element=r,y.prefix=BimfaceLanguage.bf_panel_map_level;var w=new e.Bimface.UI.Select.Select(y);w.addEventListener("Change",function(e){b.showFloorById(e.id)}),p.addEventListener("click",function(){o.showAsFull(p.hasClass("gld-bf-max-")),_&&_.hide()}),u.addEventListener("click",function(){b.clearZoomAndPan(),u.getCss().display="none"});var L=function(e){e.getToolbar("MainToolbar");c(e),e.tree&&e.tree.clear(!0),a.restoreDefault()},M=new e.Bimface.UI.Button.ButtonConfig;M.id="mapIsolate",M.title=BimfaceLanguage.bf_panel_map_isolation,M.className="bf-map-button bf-map-isolate";var T=new e.Bimface.UI.Button.Button(M);T.setHtml(BimfaceLanguage.bf_panel_map_isolation),T.addEventListener("Click",function(){L(n);var t=b.getBoundingBox();a.isolateByBox(t,e.Bimface.Viewer.IsolateOption.HideOthers),a.zoomToBoundingBox(t),b.clear(),_.hide(),a.render()});var S=new e.Bimface.UI.Button.ButtonConfig;S.id="mapSection",S.title=BimfaceLanguage.bf_panel_map_section,S.className="bf-map-button bf-map-section";var x=new e.Bimface.UI.Button.Button(S);x.setHtml(BimfaceLanguage.bf_panel_map_section),x.addEventListener("Click",function(){var e=b.getBoundingBox();c(n),m(n,e),b.clear(),_.hide(),a.render()});var k=new e.Bimface.UI.Button.ButtonConfig;k.id="mapCancel",k.title=BimfaceLanguage.bf_general_cancel,k.className="bf-map-button bf-map-cancel";var I=new e.Bimface.UI.Button.Button(k);I.setHtml(BimfaceLanguage.bf_general_cancel),I.addEventListener("Click",function(){b.clear(),_.hide()});var _;b.addEventListener(l.Zoom,function(e){1==e.zoomFactor?u.getCss().display="none":u.getCss().display="block"}),b.addEventListener(l.MouseHoveredGrid,function(e){g.innerHTML=""}),b.addEventListener(l.FloorPlaneChanged,function(e){w._currentElement.innerText=BimfaceLanguage.bf_panel_map_level+e}),b.addEventListener("MinimapRectChanged",function(e){E(e)}),b.addEventListener("MinimapRectDestroyed",function(e){_&&_.hide()}),r.appendChild(p),r.appendChild(u),r.appendChild(s),o.container.appendChild(r),o.container.appendChild(f),o.container.appendChild(d),o.drag=new e.Web.Lang.Utility.Dom.drag({element:o.element,bBoxDetection:!0,handle:s,record:function(t,n){e.Bimface.UI.Panel.PanelPositions[i.className]={left:t,top:n}}}),o.showAsFull=function(e){e?(p.removeClass("gld-bf-max-"),p.addClass("gld-bf-min-"),o.addClass("bf-map-big"),o.addClass("bf-map-big-panel"),o.element.style.left="50%",o.element.style.top="50%",o.element.style.bottom="initial",u.removeClass("bf-map-fit-panel-min"),u.addClass("bf-map-fit-panel-max"),b.resize(528,420,!0)):(p.removeClass("gld-bf-min-"),p.addClass("gld-bf-max-"),o.removeClass("bf-map-big"),o.removeClass("bf-map-big-panel"),o.element.style.left="12px",o.element.style.top="initial",o.element.style.bottom="10px",u.removeClass("bf-map-fit-panel-max"),u.addClass("bf-map-fit-panel-min"),b.resize(298,198,!1)),u.getCss().display="none"};var E=function(t){if(_)_.show();else{var n=new e.Bimface.UI.Toolbar.ToolbarConfig;n.className="bf-map-toolbar",_=new e.Bimface.UI.Toolbar.Toolbar(n),_.addControls([T,x,I]),_.element.style.zIndex=11,f.appendChild(_.element)}var a={width:f.offsetWidth,height:f.offsetHeight},i={width:_.element.offsetWidth,height:_.element.offsetHeight};t.x+t.width<i.width?_.element.style.left=t.x+"px":_.element.style.left=t.x+t.width-i.width+"px",a.height<t.y+t.height+i.height?_.element.style.top=t.y+t.height-i.height-6+"px":_.element.style.top=t.y+t.height+6+"px"};return o};n.MapPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=e.Bimface.UI.Control.ControlEvent,l=new e.Bimface.UI.Button.ButtonConfig;l.id="Map",l.title=BimfaceLanguage.bf_btn_map,l.className="bf-button gld-bf-map";var r,s=new e.Bimface.UI.Button.ToggleButton(l);if("ViewerDrawing"==a.viewerType)s.addEventListener(o.StateChange,function(e){e?a.enableMiniMap(!0):a.enableMiniMap(!1)});else{var c=a instanceof e.Bimface.Viewer.Viewer3D,d=e.Bimface.Viewer.Viewer3DEvent;if(!c)return void console.log("The API is not supported on this viewer.");s.addEventListener(o.StateChange,function(n){if(r=t.getPanel("MapPanel"))if(n)r.show();else{r.hide();var o=t.getPlugin("Map");o.clearZoomAndPan()}else r=new e.Bimface.Application.UI.Panel.MapPanel(t),r.addEventListener("Hide",function(){s.setCheckedState(!1)}),i.appendChild(r.element),r.bringToFront(),t.addPanel(r),a.render();a.getEventManager().fireEvent(d.ButtonOnToolbarClicked,{id:l.id,isChecked:n})})}return s};t.Map=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=(t.getRootElement(),a instanceof e.Bimface.Viewer.Viewer3D),o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionDirection",l.title="剖切方向",l.className="bf-button gld-bf-axial";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){var e=this.hasClass("gld-bf-axial");r.toggleClassName("gld-bf-axial"),r.toggleClassName("gld-bf-axial-");var n=t.getPlugin("SectionPlane");n&&(n.setDirection(e?"Reverse":"Forward"),n.setProgress(50)),a.render()}),r};t.SectionDirection=n}(),function(){
var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionRecalculation",l.title=BimfaceLanguage.bf_tip_section_fitBox,l.className="bf-button gld-bf-fittobox";var r=new e.Bimface.UI.Button.Button(l);return r.addEventListener(o.Click,function(){var e=t.getPlugin("SectionBox");e&&e.fitToModel(),a.render()}),r};t.SectionRecalculation=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=function(t){var n=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=new e.Bimface.UI.Panel.PanelConfig;a.title=BimfaceLanguage.bf_panel_explode,a.css=n?{right:"10px",bottom:"60px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},a.enableSizable=!1,a.className="bf-panel bf-explode-panel";var i=new e.Bimface.UI.Panel.Panel(a);if(i.setHtml('<div class="bf-explode-range" id="dispersionRange"></div>'),!n){var o=t.getRootElement(),l=o.offsetWidth,r=o.offsetHeight;i.element.style.fontSize=100*Math.min(r,l,414)/750+"px",i.element.addClass("explode-panel");i.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>"}return i};t.ExplodePanel=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Web.Lang.Utility.ClientHelper.getIsIphone(),function(t,n){window.viewer=t.getViewer();var a,i=t.getRootElement(),o=viewer instanceof e.Bimface.Viewer.Viewer3D,l=e.Bimface.UI.Control.ControlEvent,r=e.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var s=new e.Bimface.UI.Button.ButtonConfig;s.id="Explode",s.title=BimfaceLanguage.bf_btn_explode,s.className="bf-button gld-bf-explode";var d,f=new e.Bimface.UI.Button.ToggleButton(s);return f.addEventListener(l.StateChange,function(o){if(o){var l=n.getControl("Measure");l&&l.setCheckedState(!1),c(t);var u=n.getControl("SectionBox");u&&u.setCheckedState(!1);var m=n.getControl("SectionPlane");m&&m.setCheckedState(!1),viewer.setExplosionExtent(0),viewer.render(),d=new e.Bimface.Application.UI.Panel.ExplodePanel(t),d.addEventListener("Hide",function(){f.setCheckedState(!1)}),i.appendChild(d.element),a=new e.Web.Lang.Utility.Dom.range({element:d.element.querySelector("#dispersionRange"),min:0,cur:0,max:3,step:.1,isShowProgress:!1,defaultColor:"#555555",currentColor:"#999999",input:function(e){viewer.setExplosionExtent(e),viewer.render()}}),t.addPanel(d)}else t.removePanel(d.id),d.close(),viewer.setExplosionExtent(0),viewer.render();viewer.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:o})}),f});t.Explode=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Drag",t.title=BimfaceLanguage.bf_tip_roomEdit_dragNode,t.className="bf-button gld-bf-room-dragnode",new e.Bimface.UI.Button.ToggleButton(t)};t.RoomEditingDrag=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Add",t.title=BimfaceLanguage.bf_tip_roomEdit_addNode,t.className="bf-button gld-bf-room-addnode",new e.Bimface.UI.Button.ToggleButton(t)};t.RoomEditingAdd=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Delete",t.title=BimfaceLanguage.bf_tip_roomEdit_deleteNode,t.className="bf-button gld-bf-room-deletenode",new e.Bimface.UI.Button.ToggleButton(t)};t.RoomEditingDelete=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Height",t.title=BimfaceLanguage.bf_tip_roomEdit_editHeight,t.className="bf-button gld-bf-room-height",new e.Bimface.UI.Button.ToggleButton(t)};t.RoomEditingHeight=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Translation",t.title=BimfaceLanguage.bf_general_move,t.className="bf-button gld-bf-translation",new e.Bimface.UI.Button.ToggleButton(t)};t.ModelEditingTranslate=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Rotation",t.title=BimfaceLanguage.bf_general_rotate,t.className="bf-button gld-bf-rotation",new e.Bimface.UI.Button.ToggleButton(t)};t.ModelEditingRotate=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(){var t=new e.Bimface.UI.Button.ButtonConfig;return t.id="Scaling",t.title=BimfaceLanguage.bf_general_zoom,t.className="bf-button gld-bf-scaling",new e.Bimface.UI.Button.ToggleButton(t)};t.ModelEditingScale=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){var a=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=new e.Bimface.UI.Panel.PanelConfig;i.title=BimfaceLanguage.bf_btn_layers,i.className="bf-panel bf-layers-panel",i.id="LayersPanel",i.css=a?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var o=new e.Bimface.UI.Panel.Panel(i);o.element.addClass("layers-panel");var l=t.getLayers();this.layers=l;var r=0;l.map(function(e){e.visible||r++});var s=n.create("ul","bf-layers bf-scroll-bar"),c=n.create("div","bf-allLayers"),d=void 0;r==l.length?(d="gld-bf-hide",c.addClass("disable")):d="gld-bf-show",c.innerHTML="<span title='显示' class='eyes "+d+"'></span><span   class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",c.addEventListener("click",function(){var e=this.hasClass("disable");e?(t.showAllLayers(),f(!0)):(t.hideAllLayers(),f(!1)),this.toggleClass("disable");var n=this.querySelector(".eyes");n.setAttribute("title",e?"显示":"隐藏"),n.toggleClass("gld-bf-show"),n.toggleClass("gld-bf-hide")});var f=function(e){for(var t=s.querySelectorAll(".bf-layer"),n=0,a=t.length;n<a;++n){var i=t[n],o=i.querySelector(".eyes");e?i.removeClass("disable"):i.addClass("disable"),i.setAttribute("visible",e),o.addClass(e?"gld-bf-show":"gld-bf-hide"),o.removeClass(e?"gld-bf-hide":"gld-bf-show"),o.setAttribute("title",e?"显示":"隐藏")}};l=e.Web.Lang.Utility.ClientHelper.sortByName(l);for(var u=0,m=l.length;u<m;++u){var p,g,h=n.create("li","bf-layer"),b=l[u],v=t.getColor(b.color);b.visible?(p="gld-bf-show",g="显示"):(p="gld-bf-hide",g="隐藏",h.addClass("disable")),h.innerHTML="<span title='"+g+"' class='eyes "+p+"'></span><span class='color'style='background:"+v+"'></span><span   class='name'>"+b.name+"</span>",h.setAttribute("layer-id",b.id),h.setAttribute("visible",b.visible),h.addEventListener("click",function(){this.toggleClass("disable");var e=this.querySelector(".eyes");e.toggleClass("gld-bf-show"),e.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),a=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var i=c.querySelector(".eyes");n?(t.showLayer(a),c.removeClass("disable"),i.addClass("gld-bf-show"),i.removeClass("gld-bf-hide"),i.setAttribute("title","显示")):(0==s.querySelectorAll(".gld-bf-show").length&&(c.addClass("disable"),i.removeClass("gld-bf-show"),i.addClass("gld-bf-hide"),i.setAttribute("title","隐藏")),t.hideLayer(a))}),s.appendChild(h)}return o.container.appendChild(c),o.container.appendChild(s),t.changeLayers(l),o.element.setCss({border:"solid 1px #333333"}),this.update=function(e){for(var n=0,a=this.layers.length;n<a;++n){var i=this.layers[n];i.id==e.id&&(i.visible=e.visible)}t.changeLayers(this.layers),t.update()},o};t.LayersPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=t.getRootElement(),o=e.Bimface.UI.Control.ControlEvent,l=new e.Bimface.UI.Button.ButtonConfig;l.id="Layers",l.title=BimfaceLanguage.bf_btn_layers,l.className="bf-button gld-bf-layers";var r,s=new e.Bimface.UI.Button.ToggleButton(l);return s.addEventListener(o.StateChange,function(n){r=t.getPanel("LayersPanel"),r?n?r.show():r.hide():(r=new e.Bimface.Application.UI.Panel.LayersPanel(a),i.appendChild(r.element),r.bringToFront(),t.addPanel(r),r.addEventListener("Hide",function(){s.setCheckedState(!1)}))}),s};t.Layers=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){function a(e,n){var a=d.getObjectByAttribute("id",e),i=a.frames.getObjectByAttribute("id",n),o=i.bbox,l=t.getToolbar("LeftSubToolbar");l&&l.getControl("LayoutList").setSelectedUiById(0==e&&"Model"||e),r.zoomToBoundingBox([o.slice(0,2),o.slice(2,4)])}function i(n,a){var i=d.getObjectByAttribute("id",n),o=i.frames.getObjectByAttribute("id",a),l=t.getPanel("DrawingFramePanel"),c=r._viewMetaData||r._data,f=c.dataEnvType,u=new e.Bimface.UI.Panel.PanelConfig;u.title=o.name,u.className="bf-panel bf-drawingFrame-panel",u.id="DrawingFramePanel",u.css={left:"0",top:"0",width:"100%",height:"100%"},l=new e.Bimface.UI.Panel.Panel(u),l.element.addClass("frame-panel"),s.appendChild(l.element),l.bringToFront();var m=new e.Bimface.Application.WebApplicationDrawingConfig;m.Buttons.removeByValue("Sheets"),m.domElement=l.element.querySelector(".bf-panel-container");var p=new e.Bimface.Application.WebApplicationDrawing(m);"Local"==f?p.getViewer().addModel(c,null,null,a):p.loadFrame(c.viewToken,a),t.addPanel(l),l.addEventListener("Hide",function(){p.getViewer().destroy(!0),l.destroy(),t.removePanel("DrawingFramePanel")})}function o(e){d=e;for(var t=n.create("ul","bf-sheets bf-scroll-bar"),o=0,l=d.length;o<l;o++){var r=n.create("li","bf-sheet"),s=d[o],c=n.create("span","bf-sheet-title");n.create("div","bf-sheet-frames");c.innerHTML="<span >"+s.name+"</span>",r.setAttribute("sheet-id",s.id),r.appendChild(c);for(var u=0,m=s.frames.length;u<m;u++){var p=s.frames[u],g=n.create("div","bf-sheet-row");g.setAttribute("frame-id",p.id),g.innerHTML='<div title="'+p.name+'"  class="bf-sheet-frameName">'+p.name+'</div><span title="'+BimfaceLanguage.bf_panel_viewSheet+'" class="bf-sheet-icon gld-bf-export bf-button"></span><div  title="'+p.number+'" class="bf-sheet-frameNumber">'+p.number+"</div>",r.appendChild(g)}t.appendChild(r)}t.addEventListener("click",function(e){var t=e.target,n=void 0,o=void 0;n=t.parentElement.parentElement.getAttribute("sheet-id"),o=t.parentElement.getAttribute("frame-id"),"bf-sheet-icon gld-bf-export bf-button"==t.className?i(n,o):"bf-sheet-row"==t.parentElement.className&&a(n,o)}),f.container.appendChild(t),f.element.setCss({border:"solid 1px #333333"})}var l=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),r=t.getViewer(),s=t.getRootElement(),c=new e.Bimface.UI.Panel.PanelConfig;c.title=BimfaceLanguage.bf_btn_sheets,c.className="bf-panel bf-sheets-panel",c.id="SheetsPanel",c.css=l?{left:"10px",bottom:"70px",width:"320px",height:"230px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var d=void 0,f=new e.Bimface.UI.Panel.Panel(c);return f.element.addClass("sheets-panel"),r.getDrawingFrame(function(e){o(e.data||[])}),f};t.SheetsPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=(t.getViewer(),t.getRootElement()),i=e.Bimface.UI.Control.ControlEvent,o=new e.Bimface.UI.Button.ButtonConfig;o.id="Sheets",o.title=BimfaceLanguage.bf_btn_sheets,o.className="bf-button gld-bf-split-drawings";var l,r=new e.Bimface.UI.Button.ToggleButton(o);return r.addEventListener(i.StateChange,function(n){l=t.getPanel("SheetsPanel"),l?n?l.show():l.hide():(l=new e.Bimface.Application.UI.Panel.SheetsPanel(t),a.appendChild(l.element),l.bringToFront(),t.addPanel(l),l.addEventListener("Hide",function(){r.setCheckedState(!1)}))}),r};t.Sheets=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),n=function(t,n){var a=t.getViewer(),i=a instanceof e.Bimface.Viewer.Viewer3D,o=e.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var l=new e.Bimface.UI.Button.ButtonConfig;l.id="SectionBoxReverse",l.title=BimfaceLanguage.bf_panel_section_reverse,l.className="bf-button gld-bf-reverse-lg";var r=new e.Bimface.UI.Button.ToggleButton(l);return r.addEventListener(o.StateChange,function(e){var n=t.getPlugin("SectionBox");n&&(e?n.changeClipDirection(!0):n.changeClipDirection(!1)),a.render()}),r};t.SectionBoxReverse=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=function(){var t={id:"MainToolbar",title:"主菜单",className:"bf-toolbar bf-toolbar-bottom",buttons:["Home","Person","OrbitButton","RectangleSelect","Measure","Section","Annotation","Property","Information","Setting","FullScreen"]},n=new e.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},n,t)};t.MainToolbarConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=function(){var t={id:"SectionToolbar",title:"剖切",className:"bf-section-box",buttons:["SectionBoxVisiable","SectionBoxReverse","SectionRecalculation","SectionReset"]},n=new e.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},n,t)};t.SectionToolbarConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=function(){var t={id:"FamilyTypes",title:"FamilyTypes",className:"bf-toolbar bf-toolbar bf-toolbar-select",buttons:["FamilyList"]},n=new e.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},n,t)};t.FamilyListConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=function(){var t={id:"ModelTree",title:"ModelTree",className:"bf-toolbar bf-toolbar bf-tree-toolbar",buttons:["ModelTree"]},n=new e.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},n,t)};t.ModelTree=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=function(){var t={id:"FamilyTypes",title:"FamilyTypes",className:"bf-toolbar bf-toolbar bf-toolbar-select",buttons:["FamilyList"]},n=new e.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},n,t)};t.LeftSubToolbarConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Toolbar"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Button"),a=function(t,a){for(var i=new e.Bimface.UI.Toolbar.Toolbar(t),o=0,l=t.buttons.length;o<l;o++)if(n[t.buttons[o]]){var r=n[t.buttons[o]](a,i);i.addControl(r)}return i};t.Toolbar=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Menu"),n=function(t,n,a){var i=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=!!e.Bimface.Viewer.ViewerDrawingSet&&t.getViewer()instanceof e.Bimface.Viewer.ViewerDrawingSet,l=o?t.getActiveViewer():t.getViewer(),r=!!e.Bimface.Viewer.Viewer3D&&l instanceof e.Bimface.Viewer.Viewer3D,s=r?t.getRootElement():l.getDomElement(),c=e.Bimface.UI.Control.ControlEvent,d=null,f=new e.Bimface.UI.Menu.MenuConfig;f.element=s;var m=new e.Bimface.UI.Menu.Menu(f),p=function(){m&&(m.destroy(),m=null),s.removeEventListener("mousedown",Y),J.removeEventListener("mousedown",Y)};if(r){var g=void 0,h=!0;for(var b in n){var v=n[b];if(g||1!==v.length){if(v.length>1||1===v.length&&g&&g.id!==v[0]){g=void 0,d=void 0,h=!1;break}}else g={modelId:b,id:v[0]},d=a[v[0]],h=!1}var y,C=t.getToolbar("MainToolbar");C&&(y=C.getControl("Property")||C.getControl("MobileProperty"));var B=new e.Bimface.UI.Menu.MenuItemConfig;B.id="showProperty";var w=new e.Bimface.UI.Menu.MenuItem(B);w.setText(BimfaceLanguage.bf_btn_props),w.addEventListener(c.Click,function(){!y||y.isChecked()||w.isDisabled||y.setCheckedState(!0),p()});var L=new e.Bimface.UI.Menu.MenuItemConfig;L.id="areaProperty";var M=new e.Bimface.UI.Menu.MenuItem(L);M.setText(BimfaceLanguage.bf_tip_props_rooms),M.addEventListener(c.Click,function(){var n=t.getPanel("AreaPropertyPanel");n||(n=new e.Bimface.Application.UI.Panel.AreaPanel(t),n.addEventListener("Close",function(){t.removePanel(n.id)}),n.addEventListener("Hide",function(){n.close()}),E(l,n,d,g),s.appendChild(n.element),n.initPosition(),t.addPanel(n)),p()});var T=new e.Bimface.UI.Menu.MenuItemConfig;T.id="areaEdit";var S=new e.Bimface.UI.Menu.MenuItem(T);S.setText(BimfaceLanguage.bf_contextmenu_roomEdit),S.addEventListener(c.Click,function(){if(p(),i){var n=t.getPlugin("RoomEditorToolbar");if(n){n.roomId=g.id;var a=n.switchToolbar.getControls();n.uncheckOthers("Drag",a),n.roomEditor.activateByRoomId(g.id),n.roomEditor.onEnter()}else{var o=new e.Bimface.Plugins.SpatialRelation.RoomEditorToolbarConfig;o.viewer=l,o.roomId=g.id,n=new e.Bimface.Plugins.SpatialRelation.RoomEditorToolbar(o),t.addPlugin(n)}n.show()}});var x=function(e){l.getModels().forEach(e);var t=l._getExternalComponentModel();t&&e(t)},k=new e.Bimface.UI.Menu.MenuItemConfig;k.id="HideComponents";var I=new e.Bimface.UI.Menu.MenuItem(k);I.setText(BimfaceLanguage.bf_contextmenu_hide),I.addEventListener(c.Click,function(){x(function(e){var t=n[e.modelId];e.hideComponentsById(t),e.setSelectedComponentsById()}),l.render(),p()});var _=new e.Bimface.UI.Menu.MenuItemConfig;_.id="SetComponentsOpacityssddd";var N=new e.Bimface.UI.Menu.MenuItem(_);N.setText(BimfaceLanguage.bf_contextmenu_transparent),N.addEventListener(c.Click,function(){x(function(t){var a=n[t.modelId];t.setComponentsOpacity(a,e.Bimface.Viewer.OpacityOption.Translucent),t.setSelectedComponentsById()}),l.render(),p()});var P=new e.Bimface.UI.Menu.MenuConfig;P.id="IsolateMenu",P.isSubMenu=i&&!0||!1,P.text=BimfaceLanguage.bf_contextmenu_isolate,P.className="bf-sub-menu";var U=new e.Bimface.UI.Menu.Menu(P),A=new e.Bimface.UI.Menu.MenuItemConfig;A.id="HideOthers";var V=new e.Bimface.UI.Menu.MenuItem(A);V.setText(BimfaceLanguage.bf_contextmenu_isolate_hidden),V.addEventListener(c.Click,function(){x(function(t){var a=n[t.modelId];t.isolateComponentsById(a,e.Bimface.Viewer.IsolateOption.HideOthers),t.setSelectedComponentsById()}),l.render(),p()});var z=new e.Bimface.UI.Menu.MenuItemConfig;z.id="MakeOthersTranslucent";var D=new e.Bimface.UI.Menu.MenuItem(z);D.setText(BimfaceLanguage.bf_contextmenu_isolate_translucent),D.addEventListener(c.Click,function(){x(function(t){var a=n[t.modelId];t.isolateComponentsById(a,e.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),t.setSelectedComponentsById()}),l.render(),p()}),U.addControl(V),U.addControl(D);var H=new e.Bimface.UI.Menu.Spacer,W=new e.Bimface.UI.Menu.Spacer,F=new e.Bimface.UI.Menu.MenuItemConfig;F.id="ShowAll";var O=new e.Bimface.UI.Menu.MenuItem(F);O.setText(BimfaceLanguage.bf_contextmenu_showAll),O.addEventListener(c.Click,function(){u(t),t.tree&&"areaPanel"!=t.tree.element.id&&"drawingPanel"!=t.tree.element.id&&t.tree.clear(!0),x(function(e){e.activateAllComponents(),e.clearIsolation(),e.clearSelectedComponents(),e.showAllComponents(),e.opaqueAllComponents()}),l.render(),p();var e=t.getPlugin("SectionPlane");e&&e.coordinateSystem.update(!0)}),!d||"room"!=d.toLocaleLowerCase()&&"area"!=d.toLocaleLowerCase()?h?(m.addControl(O),m.oneOption=!0):(y&&(m.addControl(w),m.addControl(H)),m.addControl(I),m.addControl(N),m.addControl(U),m.addControl(W),m.addControl(O),"ExternalComponent"==d&&w.disabled()):(m.addControl(M),m.addControl(S),m.addControl(H),m.addControl(O),!i&&S.disabled(),m.oneOption=!0)}else{var R=n;if(R.length>0){var q=new e.Bimface.UI.Menu.MenuItemConfig;q.id="hideElement";var j=new e.Bimface.UI.Menu.MenuItem(q);j.setText(BimfaceLanguage.bf_contextmenu_hideElement),j.addEventListener(c.Click,function(){l.hideElementsById(R),l.clearSelection(),p()}),m.addControl(j),m.addControl(new e.Bimface.UI.Menu.Spacer);var Z=new e.Bimface.UI.Menu.MenuItemConfig;Z.id="hideLayer";var G=new e.Bimface.UI.Menu.MenuItem(Z);G.setText(BimfaceLanguage.bf_contextmenu_hideLayer),G.addEventListener(c.Click,function(){var e=l.getLayerIdFromElementId(R[0]);l.hideLayer(e),X(e),l.clearSelection(),p()}),m.addControl(G),m.addControl(new e.Bimface.UI.Menu.Spacer)}var F=new e.Bimface.UI.Menu.MenuItemConfig;F.id="showAll";var O=new e.Bimface.UI.Menu.MenuItem(F);O.setText(BimfaceLanguage.bf_contextmenu_showAll),O.addEventListener(c.Click,function(){Q(!0),l.showAllLayers(),l.showAllElements(),p()}),m.addControl(O);var Q=function(e){var t=document.querySelector(".bf-allLayers");if(t){t.removeClass("disable");var n=t.querySelector(".eyes");n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏");for(var a=t.nextSibling,i=a.querySelectorAll(".bf-layer"),o=0,l=i.length;o<l;++o){var r=i[o],n=r.querySelector(".eyes");e?r.removeClass("disable"):r.addClass("disable"),r.setAttribute("visible",e),n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏")}}},X=function(e){var t=document.querySelector(".bf-layers");if(t)for(var n=t.querySelectorAll(".bf-layer"),a=0,i=n.length;a<i;++a){var o=n[a];if(o.getAttribute("layer-id")==e){o.setAttribute("visible",!1),o.toggleClass("disable");var l=o.querySelector(".eyes");if(l.toggleClass("gld-bf-show"),l.toggleClass("gld-bf-hide"),l.setAttribute("title","隐藏"),0==t.querySelectorAll(".gld-bf-show").length){var r=document.querySelector(".eyes");document.querySelector(".bf-allLayers").addClass("disable"),r.removeClass("gld-bf-show"),r.addClass("gld-bf-hide"),r.setAttribute("title","隐藏")}break}}}}var Y=function(){p()};s.addEventListener("mousedown",Y);var J=r?l.getDomElement():l.getRootElement();return J.addEventListener("mousedown",Y),m};t.ContextMenu=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom")),a=e.Bimface.Data.StatisticsDataManager.getInstance(),i=function(t){var i,o=e.Web.Lang.Utility.ClientHelper.getIsDesktop();if(o)i=n.create("div","bf-container"),t.EnableFamilyList&&!t.Toolbars.includes("FamilyList")&&t.Toolbars.push("FamilyList"),!t.EnableFamilyList&&t.Toolbars.includes("FamilyList")&&t.Toolbars.removeByValue("FamilyList");else{t.Toolbars=["FamilyList","MainToolbar"],t.Buttons=["Home","ViewButton","Measure","Section","Explode"],t.enableViewHouse=!1,i=n.create("div","bf-container  bf-mobile bf-mobile-rfa");var l=t.domElement.offsetWidth,r=t.domElement.offsetHeight;i.style.fontSize=90*Math.min(l,r,414)/750+"px"}var s=this,c=t;s.toolbars=[],s._rootElement=i,t.domElement.appendChild(i),c.domElement=i,this.getViewer=function(){return d},this.getEventManager=function(){return u},this.getToolbars=function(){return s.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),s.UI.getToolbar(e)},this.render=function(){this.getViewer().render()},this.addView=function(e){d.addView(e)},this.getAnnotationManager=function(){return s.getPlugin("Annotation")},this._mainToolbarAdaptive=function(){var e=s.getToolbars();if(e&&e.length>=2&&!!s.getToolbar("MainToolbar")){var t=s.getToolbar("MainToolbar");s._rootElement.offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}},this.addEventListener=e.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=e.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new e.Bimface.Viewer.Viewer3D(c),f=e.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(f.ViewAdded,function(e){var t=d.getViewer(),n=t.getNumOfElements(),i=t.getNumOfTriangles(),o={eventId:"加载",loadModel:"normal",type:"rfa",elements:n,triangles:i};a.send("Glodon.Bimface.Application.WebApplicationRfa","ViewAdded",o),d.getFamilyTypes(function(e){d.getDefaultModel().showFamilyTypeById(e[0].id),d.render()}),s.UI.init(),s._mainToolbarAdaptive(),window.addEventListener("resize",function(e){s._mainToolbarAdaptive()})}),d.addEventListener(f.AddView,function(n){if(1===n){var a=new e.Bimface.Application.UI.UIConfig;a=Object.assign(a,t),a.element=i,a.viewer=d,s.UI=new e.Bimface.Application.UI.UI(a)}}),d.addEventListener(f.RemoveView,function(e){0==e&&(s.UI.destroy(),s.UI=null)})};t.WebApplicationRfa=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={Toolbars:["MainToolbar","LeftSubToolbar"],Buttons:["Home","RectZoom","FullScreen"]},n=e.Bimface.Viewer.Viewer2DConfig();return Object.assign({},t,n)};t.WebApplication2DConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=Object.freeze({Loaded:"Loaded",Error:"Error"});t.WebApplication2DEvent=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(t){var n=new e.Bimface.UI.Toolbar.ToolbarConfig,a=Object.assign({},n,t);return new e.Bimface.UI.Toolbar.Toolbar(a)},a=function(e){for(var t=[],a=0,i=e.length;a<i;a++)t.push(n(e[a]));this._Toolbars=t};a.prototype.getToolbar=function(e){return this._Toolbars.getObjectByAttribute("id",e)},t.Toolbar=n,t.Toolbars=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(t){var n=new e.Bimface.UI.Button.ButtonConfig,a=Object.assign({type:"Button"},n,t),i=(e.Bimface.UI.Control.ControlEvent,new e.Bimface.UI.Button[a.type](a));for(var o in a.handles)i.addEventListener(o,a.handles[o]);return a.html&&i.setHtml(a.html),i},a=function(e){for(var t=[],a=0,i=e.length;a<i;a++){var o=n(e[a]);if("ComboBox"==e[a].type){var l=e[a].options;for(var r in l)o.addControl(n(l[r]))}t.push(o)}this._Buttons=t};a.prototype.getButtons=function(e){return this._Buttons},a.prototype.getButton=function(e){return this._Buttons.getObjectByAttribute("id",e)},t.Button=n,t.Buttons=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(t){var n=new e.Bimface.UI.Panel.PanelConfig,a=Object.assign({},n.css,t.css),i=Object.assign({},n,t);return i.css=a,new e.Bimface.UI.Panel.Panel(i)};t.Panel=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(t,n,a,i,o){var l=new e.Bimface.UI.Tree.TreeNodeConfig;l.hasCheckbox=i,l.isChecked=!0,l.selection=o;var r=new e.Bimface.UI.Tree.TreeNode(l);return r.element.setAttribute("data-filter",a),r.setTitle(""),r.setData(t,n),r};t.Tree=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom")),a=e.Bimface.Data.StatisticsDataManager.getInstance(),i=function(t){var i,o=e.Web.Lang.Utility.ClientHelper.getIsDesktop();if(o)i=n.create("div","bf-container");else{t.Toolbars=["LeftSubToolbar"],t.Buttons=[],t.enableViewHouse=!1,i=n.create("div","bf-container  bf-mobile bf-mobile-dwg");var l=t.domElement.offsetHeight;i.style.fontSize=75*l/1340+"px"}var r=this,s=t,c=(e.Bimface.Viewer.NavigationMode2D,e.Bimface.Viewer.Viewer2DEvent);t.domElement.appendChild(i),s.domElement=i;var d=new e.Bimface.Viewer.Viewer2D(s);this.load=function(e){d.load(e)},this.getViewer=function(){return d},this.getToolbars=function(){return b},this.getToolbar=function(e){return b.getToolbar(e)},this._panels={};var f={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:i,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:i,className:"bf-toolbar bf-toolbar-select"}},u={Home:{id:"Home",title:"适应屏幕",className:"bf-button gld-bf-home",handles:{Click:function(){d.home()}}},RectZoom:{id:"RectZoom",title:"框选",type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var t=v.getControl("RectZoom");d.rectZoom(),d.addEventListener(e.Bimface.Viewer.Viewer2DEvent.ViewZooming,function(){d.setNavigationMode(e.Bimface.Viewer.NavigationMode2D.Pan),t.setCheckedState(!1),d._opt.enableZoomRect=!1})}}},Information:{id:"Information",title:"关于BIMFACE",className:"bf-button gld-bf-information",type:"ToggleButton",handles:{Click:function(){if(this.hasClass("bf-checked"))if(r._panels.InformationPanel)r._panels.InformationPanel.show();else{var t=new e.Bimface.Application.Panel(m.Information)
;t.setHtml('<div class="bf-info"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANEAAAAfCAYAAAB52CgrAAAABGdBTUEAALGPC/xhBQAAFJlJREFUeAHlXAt8VcWZn5lzbyAQIIRAoSISEnyBVq1u17oqspqg5WeLq65WixV8oNQVpGopdqtWVizUoi1QFJDCyq9VKau7KyGAPBStRayPtVLzIKBSH0A0JCHJvWdm/9+5Z86dc+85ed5AKPPLZGa++WbmO+fMf75vvjPn8q/s3jDCbrJPZUaQ3KpiPD5MSB7RZNtSasSI/LLdHx4YyBrVWZrupIL9jSnZhymR46P3772lV4OKNDQ1nGfSbcFraoqKt5m0oHywbGrXgZHj3tP8A6pK/4HH+SBdTk1VlFXsLyjZmUrv6rJSiudVrb/UspUIG6tntnr1o+PHHQir13T01Qf50xDzNK2DaRztXuWc17a3PWSguZCNWI/2sr3t28KPMU4AXwGifx61pXGS5zPI96dkMT2Hceg6oog8vbZdlCaM1RhpaoqN54z/C2PqAt2cMzWfSTXZZs7Dc8jgmV5dsS9PgoaGYyEI2iQCV+w55E5VTCbBaIk5/Iu6wXWcC8XV6UypqQb/H/PKS5eeXtRj+WZ+ET3YwODIxtkVTLELNQNX4nHk76RyfnnpWZLxYYrLXynFBmsenXLODnEmLur/QelDB0aW/ARyK13XlWl+1dqT8ipLL2eKD8M9/EHgWJwtbGgSX0XdE4H1IOIe90IyB/EWxB6ImQi0AI1uT0eQoxD8OxD7Ib6O8nm4l3Z7+gjjRV80ka9HvBdxVBhfe+jo83bItyi1DehTQLsP8bjUug6WbfQ5TGCw+Yqp1QDl1rCOuMWnK8m+jRk4Blc8E9e9E+3QJiQQgKQagWlwFTTUjWiTzThf4OdWV71T0fT0GLXJ03b+ekjE2aMA739hvdiSWueUOeunbLWEWeIO8H6SygM571cxiYejZg0oL1vkPrBUtoyW88o3nCptthnAnyO5XIOL2JM2AACEe9KDFqq0OpcAWYci+zbiHYiZAhD1PgJ90yrcnjALzAQgCt9AvNLJdfIf5CCNQPNoBWJGAOSKdJKbOgk9d0Qag4CVKQBR3xZibgTLHfAAICk1DRMWtKRGIi4NIPCNwYSoIhpjcpZSYjYm7mq08zSSU+UCCPSrUV9GNOQnYYxlGGkBCp5GIh4AiQFI14VoJLr4X6LtdNwGdJTUSM5Yic4BJLaEW+ImbhsaibM/o8FeaKgJDhuTtw6oKI3cr9Qt93eROdK/cv1pTMY3YEzHvLQYXwSL+E6uYms8eV0AgWcy7nZLZscStCny2jH2LvIViJ3RpjG0fxr3k9I2Bdx/AvP1Kcw/Qvn3KbSOFJejkfN83MYNSN9C/NQtByWtXf9naDQ7peGdKH/PoH2E/JuIcYPWkez7aPTXhBZIAxKqYNNxkdBADoDShkgCyXuuBoBS2X1AYurrur4NQCIQmkDSTZOpUilA4vlCRO6RdhwPOnnPaeI+VrEuCiDdmGkgDdxVdkY8Fl+P0fK1YBjvRMHi52PxWIWL+C7uqaOBSA7NE5Tiemlilbh1jUgnYOKXBvEeBtoMjJGquc6AjOM6IxPaX45+rzbk/zXy96JPAlLGAsYR6Ow+o0PaDszAOJ0FkNclDZAIGkhk2in2CuORH5IJFwwg3YiAxHcirmGCzyMTDkKbN0YzOinqJmH1zcYFkFr1ArVpzbQDzy9d0+5lr6GZcYDkmnaCz5QyDjNIpW/ElZoIIK28SilSxRkJ+RXrvh6PyY3ozAOQ7him8jSmrFXQ4v9BJlxrAHLbjdftkc7rzGQ1+ml3Fvd8ABrdbDTcbORnGvmOZKcbjZbhGmGSZxZAbv/9kdJ1UChHnI5xMgYg6jTCo9Y0yuggbJsNLyx5ofqjlwbxJlmJh/8zXQcLcK+0xTLBlc9Gz+7R9zVpNfVuamjeDQEXa35LqP0S9gy2jtqedqr6WFlv1kbtch6TL2peSt/dE7sQCU1GJ0AT3sVEEufcthVke167s6K9+lTJpnq//DGZlcsLf7VfVDVwIV7SfaWmGz57eRSA9N6zndwgF5WX96hhVaN5VDyYOoYuSyUOwhpdzISaACB58oq42qd5UtJhRnmLkT/cWdqP9XYHfR3ptYi7EHsiXgCQnYvn/Rry7Qpol40G5xuNOgtIo6u0LI2lwzbIK3UhU2lExez5vs7gRKiuXD9+f1Ex2fEf++paLhxCdeikNZvuRwEeswKYNyOh6bw9Esp/QZW3wVRSPcpsO4kiy5pBsoHH2WPEGg6OAI8nP/ZgtTISnVyjdsMbyHapuL0GqQ/wWg5Re2jmxtp1swCk73YUSAMqN5xToyqvxKSYqGLp3kFnLM439eqd92RT/YErlC3PgGb6vpYBnkXaEz2ty0aaZeTrjfxhy+KaCDwEIh0exgT8BPSnQLjNJdLkJ7OsvYG8ktoSqEa/tI/pqoB1ywtt3gt6LdqQSU5QMGsnglLygja07RQLvM034OoCvHbB3XIAiEn7WwDNmCAOAhCzopNZPP4Yl/bgmqKStYyLCQBmUxA/0TAhrt5YsW5VR0w7AhBMxjLIkxvWP7T4puze+eP3fvXsBrj/bwOADsIkXR7K370qyK2uzWHaQL/gijcPqe3mx+MeeoueS2tL0stg0oaFQTq6sh6INIBa3gNl9uLwAJw9EiZbivvbP44HIMXG+msSJRNAmKi0yjmhq4CkAYR71SYAaXmQ3nE0AAnPhTThXYbcj0BbwGeChTbhoX3GraNVnjx1x3RwQHQkAKTveitAUh0FkO4/00BqI4A2aw2k5TDSowFI10Peoa7Me5CuMuSnLL0A1uEaPMMTdOFYTMWRBJC+4RpIOF3g00hwLPzQMeFCNBDWRc+EMzWQ7lenmQJSOwD0LTLh9PgBqQMkuL6XB9QdURKeBS2s9xhC/ALax7eXQPkd1GunEL0mudvgP+ayES6yXmPCMXGf11dv25JuUmDAcZ1RVkT43hv0ZtGdYO5Zz2LDzUY8bh2UQllcSNMGZiqnV2Xsy/pH0M9ak59Jvt0sk2wKssFm+G9Nt6V6V+f3FZXsyKvaUMCi1lxz99hs9yYb3hcISP0r1uH9C04RhDgbMIFoj8SCnA2dBRCcjAukiDxrCgWvnZ6IJvlI53GP2EmuEOQ9XBIi0MOgX+bWTcK9ewDg+jyE9++aHGF280mYVJNxE0brK7VwggH5EE+bKo3HbK3qyUj+dR1rXC+taBazJfUzTvcD73EZk6wvThT8Y5LGV/PaQ6uwfGFfbp+JfcVEp47zL4QQl2g+J1XxE5VtT4J8p2m6xZyzcxupTIB29rhx+QDev/TVPFn8YCXyFbqsUx+QNDElDQJSZwFEQ0jJpio7/k09HBwMfxCW/SHKuzWtm6TmHudxACNQo4L+Cu7VNsh8HiK5kachzkI85kIED3cJVsmbgIa7TSC16U4AQNAAvSQdqbBjpyohVpIX3gSS2Q9uPI4J8Z04GkPqvxbl9xXjK5C/3AKA9hUWv2HyS9t+UkTErTIuZ5hA0jyCs0Gom88iYjKO/Cw1gaR5UlMNJLy7OtnzMaUwmUB6qWrjWeSFa9GJoOCFy8m/qRUTzhuFAIR3Rn9hNiezabVXEZy5F/J8FlzVbiqZajtw3xcFtcQ4F4N+tltXh5ROEbQUSBv9j8twO9rPQd8HW2pwhOvOh4xPZFAGsnjmQyGoKF6Ith9ILoAgFM7FOae4oRTkw8oSM4OA5AEI5+4w8B/pQuAevhP7nsfwwuCczwuL0zQHWKIypp4UUXFzGJDgMjqOdwBIo9R7Gz+u3IOXUI4nisRJCYqtr15/muDyDLyfm002ZVAQFts+enjPbZv52fGg+lSaBhBOg9yHLv+UWh9Q/nYArTOka/HMluB5+PY5bofmS8/F4KlpZSAyR8m8JkuBPJX0/ujniN01nAzBKGYyvAgQUfADKUFr4b8BoDQuA0jol1Y+cosmNFACQL4mBCR8X0Q0MgcCAmSLMRNIaTypQEpjCCC8x0c1968srYSp+QdUmy83E9wwL62I3Koa2VBoz38P6AIkvtXK4YtCDs+mNTEBlFZ5+AhknqUBHsA6B/SxrhjNSB9186EJniuaqTlg0C+Mp6H8GOih7+ZCOzt6Kw65IKIrSAIJk8ag+69OwYOGs6kjcbMm+WuMUhJIjUBQBKsuVilHAxlMySwBKa+ilB0oGtcqkFScBcpmAglmUm2y9/BcTeG4/wWQrmC2SgcSVz9SjXwpi/L5vJnB7FSn+HviW7P68ss+HVxS76eHlDjAylUuaaAQjjDyQ6igPV4mAjmE6KM83K60YGqhFeDZm8qhVuScwifWpTptfg8+krEAcQji9xEXI3bHsAVCLc+gYO/jPu2JWBG4kY2gJM8tKCpedMCgmVmYbk9Db1yExiSQE/Ch3G7Ycv2U4KTSEwEbFJ6bs6ZnY130UBMbj1X7Bl2F4y6f41O9PjDjyjSN0n6fbCn4cvCFuzTNEtbdjEsMlwgSpwMKikoWatniIloVETGf/LZkkX0jiz3ZdNuwNBBIOGkAk3QQgDOaNcM8sayJ2Me9gH2Zo1lJA7ULQBic94j+jsdi16AHT944E23Z67yIe/1amPyZoGNBJBPnO25f2NWmm2RqRf9hsVjsd6j7msvnJJCNPkybh8ICl057azIXHZevydsN8h9AruWZliNix50bkOzX4nN2V677JxA2JYnJ3IGiEvIorUhS2pRL488rX7vOVqw42ZpvFQfrP0DZA5Et7bnJiYuJKMTc6sqy88HzErWLyNgIuLzpAerQLLiYTN/11BRe4rnCdWVYagIJi4TNIuoRaLznMTaCysMxoolYEhYi/4OOAIh6kQ3217hg/4wJdimVKQgmaU+00ikc2X/3Yni9WK3GRCtPFac53jwFtNNjy3IujE6qS12klqHup4iDEAsRr0IkwB0TwV1Z3Wt1vweSqkOHCjtxw/hWrPqr8bKVvD2BgQAEP/HxzucZgRwMALLgYpezLCmHB7OEUwlIzOJXYC79GDuGnwBAPTQ3Jj4+MOT4PIT9Z3s1kO4D78pmQZG9gn7Walp3SHFtx0OO6wxZ5hh5J6ueGZWF/dxNVICamppaj2tqBG2+QSdQHjMhCaIWPqjr2rvhAsh5N+V8b582nAcgxq5Jq0wQPAABjCeH8LRKJiDxCD5+4/wN8hqaEY2Prxl56ffavAcKGk3Zs7shkGZAVNorUSgDIN5MZJP/mxuq8f5ZDSQKXAkT1Mp82vukBmhqHAJOBPpoz9O4qYx/b+WIc0HdAUDwZngGhXGXDxeA9JDuLwOFODg0VydSAhK3ZjmftSjvY7FOdNjxppjoA9Da0TBuL2laiOjc5lOxODks+B+JxxtvQeEBh+D+A/i+RH+LUNRaiF7adiuta8qbybzAj3w4PyqCG3B1JjturS/8CFDChCMNRAAKDOLnjgkXooHgoGjSJlxnNFDg0F1JdDUSNN6LXTlMG/r+N/D0dvleBxA2pbZp/m3umbi355p0OHhuUZvGJBZgsyJh0pFpR4E+2vtmIpv2n1zoOujxdfmoSyPY/zwXEexiqAFPjcOLvCPsSoZ+WJonrR5JMxCMJw5hX1RXs0hzD//vhTXWZzf3jRwSoPtueP8hg2p3fVjzVHZz3fXQPjP1nhZOjk/McWVUPRux+SVA2FuaDrh5csLJ8eqAirKvYMO+3FRjPAunIrpZwMmQ38AT+kJSLCwBVq+nkuXDm8MEz8GIcJR4IVgLsXguvK4/87h0Ztc7ZNKRk8kLACF9tLcchCkukbTR5W7eTP5mFOh1SQ7a1hm0rsr65m2mBolYgo/Az05NxYXQBtMJFo/TJnGDW/QlDY3qbaUah2oiLn71W7v448IW2fgg7iF4ts9O1jWW1cZxdi6WPDsHwGytr/r4wZ7SvgcA9rxzAMr23KyexV/oxkgtyUdg1bsdmmqYJgMsjyO/nsoDK0qLpJI54HkQxSyiUeCNOFKT+J7eKXeHfzhaNUXavpX5FckaaLEyJ9ThFJVMsjx3wPeRegeQTSGiN9SRdkrTUCZPSn4uyjcjWoj00d5ozJH/M3lQrgX9z6CdiUgTm/ZlPvMQ5UyFJqOj0418xrL4MRq5DCYd/fqJb1VpywgEIFhiO4UtcbQ/Plco8SRcxG+Et004EeA9861sBKC+0Z7F1QUXmRiiY0RLIxaO2Qf9dhsGUdjsA7QzBXc8R6aJEC5Ct6jhL+Msx7OWVL77cLhEwwSmBecuYzzvozuD1qEs5kQVGj7jNsaj9fZIqf0tNgj4wRtFoO6KcACdahPznK4YJwJ7Nwdnz5bhEOckHOL8BQbxNFJLV6QB5J5EeA53y7K5XGQpcRt+tBDKI6mREv34vHCv675DAQQGgCTHjrOlkQibHLc53hklNZJuD/lPwY97OUCSeMkHuqeRNE/3SglA6jmuaC/Ith8h2f4V4x7njr0H6aoMy0Gm4bVun/TR3lTMl9qUMZaifCPiNxDJO7gYfGRevorYGe1ML7Dp14McDYQ0jn7pRTBpOwo0zpVI6R1djAidCHRi4Rlnr5IKpNY6RcPgs3Dw3zpA4nwKYGR0YwDI8MK1BCDdmGSz49wAkq5JpgFASlZ2q5wJIHKm4O/IBDK3dEj76E5XdDTF/HgHE5WcJpch0hyjA6rbEL3gTu7vgLAOUZtZxEexs2EwOvip0cl9yJOT41yXdglSip0OuM4d3kaLJqs27fBwaXUKDmEA0twEJKV+AxPrCeBlO25WoBeO6gJNON2PkSaABI1Epp1QgbIRkLRpJ5nsdqYd4GJooDBvpHHRXZvV94dWfNLeXRFmo1O9ktpBA2BukCPpPMR5iIeCeDpIwzvhZMA4ZM5djLgIMZ6syUhO8QHlpT/2dYXvQcYWFi8M+xmpIVUbT2i2Y9f52wg6oDkQL+LyNR1XYVu5OQuds3ON6lYAM7nscv7x/qKS32resHRA+dqZ/naqbmzhuAVatjBZ3J/7Cuv2iNDJq3ko7T6ovfuLLl2eKhBWN/r8YYhLX4NJ8GkqT2fK6D8H7U9BrETftGfokoBxCtBxP8S3MY4GVOBY4CVX91hEakPydTTQvVqJ8fRC4evHvfbhIPZB9JSIj6nthX0Y56//Dy5GPw14sZShAAAAAElFTkSuQmCC" /><p>Powered by BIMFACE</p><a target="_blank" href="https://bimface.com">https://bimface.com</a></div>'),r._panels.InformationPanel=t,t.addEventListener("Hide",function(){C.getButton("Information").setCheckedState(!1)})}else r._panels.InformationPanel.hide()}}},FullScreen:{id:"FullScreen",title:"全屏",className:"bf-button gld-bf-maximize",handles:{Click:function(){var t=this.hasClass("gld-bf-maximize");d.enableFullScreen(t),e.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=v.getControl("FullScreen");e.getTitle();e.toggleClassName("gld-bf-maximize"),e.toggleClassName("gld-bf-minimize"),t?e.setTitle("全屏"):e.setTitle("取消全屏")})}}}},m={Information:{element:i,title:"BIMFACE",css:{left:"50%",top:"50%",width:"330px",height:"278px",transform:"translate(-50%,-50%)",zIndex:999},enableSizable:!1}};if(!t.Toolbars||0==t.Toolbars.length)return!1;for(var p=[],g=0,h=t.Toolbars.length;g<h;g++)p.push(f[t.Toolbars[g]]);var b=new e.Bimface.Application.Toolbars(p),v=b.getToolbar("MainToolbar");if(v){for(var y=[],g=0,h=t.Buttons.length;g<h;g++)y.push(u[t.Buttons[g]]);var C=new e.Bimface.Application.Buttons(y);v.addControls(C.getButtons())}var B=b.getToolbar("LeftSubToolbar");B&&d.addEventListener(c.Loaded,function(t){for(var n=t.getViews(),a={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){d.showViewById(e.id)}}},i=0,o=n.length;i<o;i++){var l=n[i];a.options[l.name]={type:"ComboBoxOptionButton",title:l.name,id:l.id,className:"bf-button",html:'<span class="bf-button-name">'+l.name+"</span>"}}var a=new e.Bimface.Application.Buttons([a]),r=a.getButtons()[0];d.addEventListener(c.ViewChanged,function(e){r.setSelectedControlById(e)}),B.addControls(a.getButtons())}),d.addEventListener(c.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"2d"};a.send("Glodon.Bimface.Application.WebApplication2D","Loaded",e)})};t.WebApplication2D=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n="Glodon.Bimface.Application.WebApplicationDemo",a=e.Bimface.Data.StatisticsDataManager.getInstance(),i=function(t,i){var o;if("dwgView"==t.viewType){var l=new e.Bimface.Application.WebApplication2DConfig;l.domElement=i;var r=e.Bimface.Application.WebApplication2DEvent;o=new e.Bimface.Application.WebApplication2D(l),o.load(t.viewToken),o.getViewer().addEventListener(r.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};a.send(n,"Loaded",e)})}else if("rfaView"==t.viewType){var l=new e.Bimface.Application.WebApplicationRfaConfig;l.domElement=i;var r=e.Bimface.Application.WebApplicationRfaEvent;o=new e.Bimface.Application.WebApplicationRfa(l),o.addView(t.viewToken),o.addEventListener(r.ViewAdded,function(){var e=o.getViewer().getViewer(),t=e.getNumOfElements(),i=e.getNumOfTriangles(),l={eventId:"加载",loadModel:"normal",type:"demo",elements:t,triangles:i};a.send(n,"ViewAdded",l),o.render()})}else if("drawingView"==t.viewType){var l=new e.Bimface.Application.WebApplicationDrawingConfig;l.domElement=i,l.drawingUrl=t.drawingUrl,l.viewToken=t.viewToken;var r=e.Bimface.Application.WebApplicationDrawingEvent;o=new e.Bimface.Application.WebApplicationDrawing(l),o.load(t.viewToken),o.addEventListener(r.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};a.send(n,"Loaded",e)})}else if("pdfView"===t.viewType){var s=new e.Bimface.Application.WebApplicationPDFConfig;s.domElement=i,o=new e.Bimface.Application.WebApplicationPDF(s);var c=o.getViewer();c.addView(t.viewToken)}else if("gisView"===t.viewType){var d=new e.Bimface.Application.WebApplicationGISConfig;d.domElement=i,o=new e.Bimface.Application.WebApplicationGIS(d),o.addScene(t.viewToken)}else{var l=new e.Bimface.Application.WebApplication3DConfig;l.domElement=i;var f=this.getQueryString("renderMode");switch(f){case"fullVolume":l.renderMode="fullVolume";break;case"incremental":l.renderMode="incremental";break;default:l.renderMode="auto"}var r=e.Bimface.Application.WebApplication3DEvent;o=new e.Bimface.Application.WebApplication3D(l),o.addView(t.viewToken),o.addEventListener(r.ViewAdded,function(){var e=o.getViewer().getViewer(),t=e.getNumOfElements(),i=e.getNumOfTriangles(),l={eventId:"加载",loadModel:"normal",type:"demo",elements:t,triangles:i};a.send(n,"ViewAdded",l)})}this._application=o};i.prototype={hideBimfaceInfo:function(){this._application.getToolbar("MainToolbar").getControl("Information").hide()},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}},t.WebApplicationDemo=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={Toolbars:["MainToolbar","LeftSubToolbar","SearchToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Map","Layers","Sheets","Setting","FullScreen"],defaultDisplayMode:null},n=e.Bimface.Viewer.ViewerDrawingConfig(),a=Object.assign({},t,n);return a.staticPath="/api/Glodon",a};t.WebApplicationDrawingConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",Hover:"Hover",DrawingMeasure:"DrawingMeasure",ZoomFactorChanged:"ZoomFactorChanged"});t.WebApplicationDrawingEvent=n}(),function(){var t=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application")),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),e.Bimface.Data.StatisticsDataManager.getInstance()),a=function(t){function a(t){o.contextMenu&&o.contextMenu.element&&o.contextMenu.destroy();var n=t.clientPosition,a=t.containerBox,i=o.getSelectedIds(),r=new e.Bimface.Application.UI.Menu.ContextMenu(l,i),s={},c=r.element.getBoundingClientRect();a.width-n.x>2*c.width?(s.x=n.x,r.element.removeClass("bf-menu-left"),r.element.addClass("bf-menu-right")):(s.x=n.x-c.width,r.element.addClass("bf-menu-left"),r.element.removeClass("bf-menu-right")),a.height-n.y>c.height?s.y=n.y:s.y=n.y-c.height,s.x+=2,s.y+=2,r.setPosition(s),o.contextMenu=r}var i=e.Web.Lang.Utility.ClientHelper.getIsDesktop();this._plugins=[],this.isMeasureEventAdded=!1;var o,l=this,r=t,s=(e.Bimface.UI.Control.ControlEvent,e.Bimface.Viewer.ViewerDrawingEvent);i||(t.Buttons=["Home","DrawingMeasure","Layers"],t.Toolbars=["MainToolbar","LeftSubToolbar"]);var c=new e.Web.Lang.EventManager;this.getEventManager=function(){return c},o=new e.Bimface.Viewer.ViewerDrawing(r),o.addEventListener(s.ViewChanged,function(e){l.getEventManager().fireEvent(s.ViewChanged,e)}),o.addEventListener(s.ContextMenu,a),this.addEventListener=function(e,t){this.getEventManager().addEvent(e,t)},this.removeEventListener=function(e,t){this.getEventManager().removeEvent(e,t)},this.loadFrame=function(e,t){o.loadFrame(e,t)},this.getRenderInfo=function(e,t){o.getRenderInfo(e,t)},o.addEventListener(s.Loaded,function(a){var i={eventId:"加载",loadModel:"normal",type:"drawing"};if(n.send("Glodon.Bimface.Application.WebApplicationDrawing","Loaded",i),!l.UI){var r=o.getDomElement(),s=new e.Bimface.Application.UI.UIConfig;s=Object.assign(s,t),s.element=r,s.viewer=o,l.UI=new e.Bimface.Application.UI.UI(s),l.UI.init(),window.addEventListener("resize",function(e){l._mainToolbarAdaptive()})}l._mainToolbarAdaptive()}),this.getViewer=function(){return o},this.getDrawingFrame=function(e){o.getDrawingFrame(e)},this.load=function(e,t){o.load(e,t)},this.getAxisInfo=function(e){o.getAxisInfo(e)},this.getToolbars=function(){return this.UI.getToolbars()},this.getPlugin=function(e){return this.UI.getPlugin(e)},this.getToolbar=function(e){return this.UI.getToolbar(e)},this._mainToolbarAdaptive=function(){var e=this.getToolbars();if(e&&e.length>=2&&!!l.getToolbar("MainToolbar")){var t=l.getToolbar("MainToolbar");o.getDomElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};t.WebApplicationDrawing=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={mainToolbar:{create:!0,items:{Pan:{create:!0},ZoomOut:{create:!0},ZoomIn:{create:!0},FullScreen:{create:!0}}},pageController:{create:!0}},n=new e.Bimface.Viewer.ViewerPDFConfig,a=Object.assign({},t,n);return a.staticPath="/api/Glodon",a};t.WebApplicationPDFConfig=n}(),function(){var t=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application")),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom")),a=(e.Bimface.Data.StatisticsDataManager.getInstance(),function(t){var a=this,i=t,o=e.Bimface.Viewer.ViewerPDFEvent,l=void 0,r=[],s=new e.Web.Lang.EventManager;this.getEventManager=function(){return s},l=new e.Bimface.Viewer.ViewerPDF(i),this.addEventListener=function(e,t){this.getEventManager().addEvent(e,t)},this.removeEventListener=function(e,t){this.getEventManager().removeEvent(e,t)},this.getViewer=function(){return l},this.load=function(e){l.load(e)},this.getToolbars=function(){return r},this.getToolbar=function(e){return r.getToolbar(e)},this.destroy=function(){if(l.destroy(),r&&r._Toolbars&&r._Toolbars.length>0)for(var e=0,t=r._Toolbars.length;e<t;e++)r._Toolbars[e].destroy()};var c=function(){if(r&&r._Toolbars&&r._Toolbars.length>0)for(var i=0,s=r._Toolbars.length;i<s;i++)r._Toolbars[i].destroy();var c=l.getDomElement().querySelector(".bf-pdf-outer"),d=n.create("div","bf-pdf-message");d.style.display="none",c.appendChild(d);var f=void 0,u=function(e){f&&(clearTimeout(f),f=void 0),d.innerHTML=e,d.removeClass("bf-pdf-message-hide"),d.style.opacity=1,d.style.display="block",f=setTimeout(function(){var e=function e(){d.style.display="none",d.removeEventListener("transitionend",e)};d.addClass("bf-pdf-message-hide"),d.addEventListener("transitionend",e),d.style.opacity=0,f=void 0},1500)};l.enableFullScreen=function(t){t?e.Web.Lang.Utility.FullScreen.fullScreen(c):e.Web.Lang.Utility.FullScreen.exitFullScreen()};var m={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:c,className:"bf-toolbar bf-toolbar-bottom"},PageController:{id:"PageController",title:"PageController",element:c,className:"bf-toolbar bf-toolbar-select"}},p={Pan:{id:"Pan",title:BimfaceLanguage.bf_btn_pan,className:"bf-button gld-bf-drag",type:"ToggleButton",handles:{Click:function(){var e=a.getToolbar("MainToolbar").getControl("Pan");e._checked?(e.setCheckedState(!0),l.setDragMode()):(e.setCheckedState(!1),l.setTextMode())}}},ZoomIn:{id:"ZoomIn",title:BimfaceLanguage.bf_btn_zoomIn,className:"bf-button gld-bf-zoom-in",handles:{Click:function(){a.getToolbar("MainToolbar").getControl("ZoomIn")._enabled&&l.zoomIn()}}},ZoomOut:{id:"ZoomOut",title:BimfaceLanguage.bf_btn_zoomOut,className:"bf-button gld-bf-zoom-out",handles:{Click:function(){a.getToolbar("MainToolbar").getControl("ZoomOut")._enabled&&l.zoomOut()}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var t=this.hasClass("gld-bf-maximize");t?l.fullScreen():l.exitFullScreen(),e.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=h.getControl("FullScreen");e.toggleClassName("gld-bf-maximize"),e.toggleClassName("gld-bf-minimize"),t?e.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):e.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Previous:{id:"Previous",title:BimfaceLanguage.bf_btn_previousPage,className:"bf-button gld-bf-previous",handles:{Click:function(){a.getToolbar("PageController").getControl("Previous")._enabled&&l.previousPage()}}},Next:{id:"Next",title:BimfaceLanguage.bf_btn_nextPage,className:"bf-button gld-bf-next",handles:{Click:function(){a.getToolbar("PageController").getControl("Next")._enabled&&l.nextPage()}}}},g=[];t.mainToolbar&&t.mainToolbar.create&&g.push(m.MainToolbar),t.pageController&&t.pageController.create&&g.push(m.PageController),r=new e.Bimface.Application.Toolbars(g);var h=r.getToolbar("MainToolbar");if(h){var b=[];for(var v in t.mainToolbar.items){t.mainToolbar.items[v].create&&b.push(p[v])}var y=new e.Bimface.Application.Buttons(b);h.addControls(y.getButtons());var C=h.getControl("ZoomIn"),B=h.getControl("ZoomOut");l.addEventListener(o.ViewZoomed,function(e){C&&(Math.abs(e.zoom-e.max)<.001?C.disabled():C.enabled()),B&&(Math.abs(e.zoom-e.min)<.001?B.disabled():B.enabled());var t=Math.round(100*e.zoom)+"%";u(t)});var w=h.getControl("Pan");w&&(w.element.style.marginLeft=0)}var L=r.getToolbar("PageController");if(L){var M=new e.Bimface.Application.Button(p.Previous);M.element.style.marginLeft=0,M.disabled(),L.addControl(M);var T=n.create("input","bf-page-input");T.type="number",L.element.appendChild(T),T.value=1;var S=n.create("span","bf-page-count");L.element.appendChild(S);var x=l.getPageCount();S.innerHTML=x;var k=new e.Bimface.Application.Button(p.Next);L.addControl(k),1===x&&k.disabled(),l.addEventListener(o.ViewMoved,function(e){var t=e.pageNo;t>=e.max?(k.disabled(),t=e.max):k.enabled(),t<=e.min?(M.disabled(),t=e.min):M.enabled(),T.value=t});var I=function(){var e=parseInt(T.value);!isNaN(e)&&e>=1&&e<=l.getPageCount()?l.turnToPage(e):T.value=l.getCurrentPageNo()};T.addEventListener("keyup",function(e){13===e.keyCode&&I()}),T.addEventListener("blur",I)}u("100%")};this._mainToolbarAdaptive=function(){var e=a.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!a.getToolbar("MainToolbar")){var t=a.getToolbar("MainToolbar");l.getDomElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}},l.addEventListener(o.ViewLoaded,function(){c(),a._mainToolbarAdaptive(),window.addEventListener("resize",function(e){a._mainToolbarAdaptive()})})});t.WebApplicationPDF=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(){var t={Toolbars:["MainToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Layers","Annotation","FullScreen","Setting"],defaultDisplayMode:null},n=e.Bimface.Viewer.ViewerDrawingSetConfig(),a=Object.assign({},t,n);return a.staticPath="/api/Glodon",a};t.WebApplicationDrawingSetConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",ActiveViewChanged:"ActiveViewChanged",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",AddDrawing:"AddDrawing",Hover:"Hover",ZoomFactorChanged:"ZoomFactorChanged",DrawingMeasure:"DrawingMeasure"});t.WebApplicationDrawingSetEvent=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t,a){var i,o=this,l=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),r=e.Bimface.Viewer.Viewer3DEvent,s=[];if(t.sets.forEach(function(e){s.push(e.viewerDrawing),e.active&&(i=e.fileName)}),d)return d.show(),s.forEach(function(e){e.getViewer().addEventListener(r.ComponentsSelectionChanged,showLayers)}),d;var c=new e.Bimface.UI.Panel.PanelConfig;c.title=BimfaceLanguage.bf_btn_layers,c.className="bf-panel bf-layers-panell",c.id="layersSet",c.css=l?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var d=new e.Bimface.UI.Panel.Panel(c);d.element.addClass("layers-panel");var f=0,u=[],m=n.create("ul","bf-layers bf-scroll-bar");s.forEach(function(t){var a=t.getLayers();o.layers=a,a.map(function(e){e.visible||f++}),a=e.Web.Lang.Utility.ClientHelper.sortByName(a),u.push(a);for(var l=0,r=a.length;l<r;++l){var s,c,d=n.create("li","bf-layer"),g=a[l],h=t.getColor(g.color);g.visible?(s="gld-bf-show",c="显示"):(s="gld-bf-hide",c="隐藏",d.addClass("disable"));var b=t._viewMetaData.name,v=b.split(".dwg")[0];b=b==i?"":v+" | ",d.innerHTML="<span title='"+c+"' class='eyes "+s+"'></span>\n                        <span class='color'style='background:"+h+"'></span>\n                        <span class='name'>"+b+g.name+"</span>",d.setAttribute("layer-id",g.id),d.setAttribute("visible",g.visible),d.addEventListener("click",function(){this.toggleClass("disable");var e=this.querySelector(".eyes");e.toggleClass("gld-bf-show"),e.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),a=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var i=p.querySelector(".eyes");n?(t.showLayer(a),p.removeClass("disable"),i.addClass("gld-bf-show"),i.removeClass("gld-bf-hide"),i.setAttribute("title","显示")):(0==m.querySelectorAll(".gld-bf-show").length&&(p.addClass("disable"),i.removeClass("gld-bf-show"),i.addClass("gld-bf-hide"),i.setAttribute("title","隐藏")),t.hideLayer(a))}),m.appendChild(d)}t.changeLayers(a)});var p=n.create("div","bf-allLayers"),g=void 0;f==u.length?(g="gld-bf-hide",p.addClass("disable")):g="gld-bf-show",p.innerHTML="<span title='显示' class='eyes "+g+"'></span><span class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",p.addEventListener("click",function(){var e=this.hasClass("disable");e?s.forEach(function(e){e.showAllLayers(),h(!0)}):s.forEach(function(e){e.hideAllLayers(),h(!1)}),this.toggleClass("disable");var t=this.querySelector(".eyes");t.setAttribute("title",e?"显示":"隐藏"),t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide")});var h=function(e){for(var t=document.querySelectorAll(".bf-layer"),n=0,a=t.length;n<a;++n){var i=t[n],o=i.querySelector(".eyes");e?i.removeClass("disable"):i.addClass("disable"),i.setAttribute("visible",e),o.addClass(e?"gld-bf-show":"gld-bf-hide"),o.removeClass(e?"gld-bf-hide":"gld-bf-show"),o.setAttribute("title",e?"显示":"隐藏")}};return d.container.appendChild(p),d.container.appendChild(m),d.element.setCss({border:"solid 1px #333333"}),d.addEventListener("Hide",function(){a.setCheckedState(!1)}),d};t.LayersSetPanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),a=function(n,a){var i,o=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),l=t.create("div","bf-tab-container"),s=t.create("ul","bf-measure-tab");s.addEventListener("click",function(e){s.hasClass("tab-open")?(s.removeClass("tab-open"),i.element.removeClass("tab-open")):(s.addClass("tab-open"),i.element.addClass("tab-open"))},!0);var c=t.create("div","bf-tab-body"),d=t.create("div","bf-tab-foot");d.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_clearAll+"<div>",d.addEventListener("click",function(){n.clear()});var f=t.create("span","bf-clear-all gld-bf-measure-settings");f.addEventListener("click",function(e){h(),e.preventDefault(),e.stopPropagation()}),d.appendChild(f);var u=t.create("div","bf-measure-tabface");u.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                            <i class="gld-bimface gld-bf-distance"></i>\n                        </li>',u.addEventListener("click",function(e){s.hasClass("tab-open")?(s.removeClass("tab-open"),i.element.removeClass("tab-open")):(s.addClass("tab-open"),i.element.addClass("tab-open"))}),l.appendChild(s),l.appendChild(c),l.appendChild(d);var m=t.create("div","bf-setting-container"),p=t.create("div","bf-setting-body"),g=t.create("div","bf-setting-foot");m.appendChild(p),m.appendChild(g);var h=function(t){v(!1);var a,o=n.getScale(),l=n.getPrecision(),r=n.getUnits();a='<ul class="bf-measure-setting">\n                  <li class="bf-measure-scale">\n                      <span >'+BimfaceLanguage.bf_panel_measure_scale+' :</span>\n                      <div class="scaleWrap">\n                          1: <input type="number"min="1" max="2000" value ="'+o+'" >\n                          <span>'+BimfaceLanguage.bf_panel_measure_scaleInput+' </span>\n                      </div>\n                  </li>\n                  <li class="bf-measure-lengthUnits">\n                      <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                      <div class = 'unit'></div>\n                      </li>\n                  <li class=\"bf-measure-precision\">\n                      <span >"+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                      <div class = 'unit'></div>\n                  </li>\n\n                </ul>",p.innerHTML=a;var s="";p.querySelector(".scaleWrap input").oninput=function(e){var t=e.target.value;if("."==e.data||"e"==e.data){var n=(t||s).replace(/\./g,"").replace(/e/g,"");e.target.setAttribute("value",n),e.target.value=n}s=e.target.value,!s||s>2e3||s<1?e.target.addClass("error"):e.target.removeClass("error")};var c={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},d=new e.Bimface.Application.Button(c);for(var f in b){var u=b[f],m={type:"ComboBoxOptionButton",title:u,id:f,className:"bf-button",html:'<span class="bf-button-name">'+u+"</span>"};d.addControl(new e.Bimface.Application.Button(m))}d.setSelectedControlById(r.distance),p.querySelector(".bf-measure-lengthUnits .unit").appendChild(d.element),d.element.onclick=function(){C.element.removeClass("bf-expand")};var h={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},C=new e.Bimface.Application.Button(h),B={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var f in B){var u=B[f],m={type:"ComboBoxOptionButton",title:u,id:f.toString(),className:"bf-button",html:'<span class="bf-button-name">'+u+"</span>"};C.addControl(new e.Bimface.Application.Button(m))}C.setSelectedControlById(l.distance),p.querySelector(".bf-measure-precision .unit").appendChild(C.element),C.element.onclick=function(){d.element.removeClass("bf-expand")},g.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",g.querySelector(".save").onclick=function(){var e=C.getCurrentControl().id,t=p.querySelector(".scaleWrap input").value,a=d.getCurrentControl().id;t<1||t>2e3||(n.setScale(t),n.setPrecision({distance:e,area:e,angle:e}),n.setUnits({distance:a,area:a}),v(!0),y(i.data),n.getEventManager().fireEvent("MeasureParamsUpdated"))},g.querySelector(".cancel").onclick=function(){v(!0)}},b={None:BimfaceLanguage.bf_general_none,Meter:"m",Centimeter:"cm",Millimeter:"mm"},v=function(e){if(e){i.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=i.element.querySelector(".bf-close");t.style.display="block",m.style.display="none",l.style.display="block"}else{var t=i.element.querySelector(".bf-close");t.style.display="none",i.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),m.style.display="block",l.style.display="none"}},y=function t(a){i.data=a;var o,l=n.getMeasureType(),r=(n.getPrecision(),n.getScale(),n.getUnits()),d=null,f="None"!=r.distance&&"<span class='units'>"+b[r.distance]+"</span>"||"",m="None"!=r.area&&"<span class='units'>"+b[r.area]+"</span>"||"";s.innerHTML='<li class="bf-measure-tab-item '+(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Distance&&"bf-active")+'" data-type="Distance">\n          <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n        </li>\n        <li class="bf-measure-tab-item '+(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Angle&&"bf-active")+'" data-type="Angle">\n          <i class="gld-bimface gld-bf-angle" title="'+BimfaceLanguage.bf_tip_measure_angle+'"></i>\n        </li>\n        <li class="bf-measure-tab-item '+(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Area&&"bf-active")+'" data-type="Area">\n          <i class="gld-bimface gld-bf-area" title="'+BimfaceLanguage.bf_tip_measure_area+'"></i>\n        </li>'
;for(var p=s.querySelectorAll(".bf-measure-tab-item"),g=0;g<p.length;g++)p[g].addEventListener("click",function(){for(var e=0;e<p.length;e++)p[e].removeClass("bf-active");var a=this.getAttribute("data-type");this.addClass("bf-active"),n.setMeasureType(a);var i=n.getSelectedItem(),o=i&&i.type==a?B(n.drawableManager.mapMeasureInfo[i.getId()]):{};t(o)});if(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Distance){var h=a?a.distance:null,v=a?a.distanceX:null,y=a?a.distanceY:null;o='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">\n                  '+BimfaceLanguage.bf_panel_measure_distance+'：\n                    <span class="bf-measure-value">'+(h?h+f:"--")+'</span>\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  <li class="bf-measure-x">X： '+(v||"--")+'</li>\n                  <li class="bf-measure-y">Y： '+(y||"--")+"</li>\n\n                </ul>",d=p[0],i.element.removeClass("miniStyle")}else if(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Angle){var C=null;a&&(C=a.angle),o='<ul class="bf-measure-info">\n                <li class="bf-measure-distance">\n                '+BimfaceLanguage.bf_panel_measure_angle+'：\n                  <span class="bf-measure-value">'+(C?C+"<span class='units'>°</span>":"--")+'</span>\n                  <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n              </ul>',d=p[1],i.element.addClass("miniStyle")}else if(l==e.Bimface.Plugins.Measure.MeasureTypeOption.Area){var w=null;a&&(w=a.area),m&&(m+="<i class='square'>2</i>"),o='<ul class="bf-measure-info">\n                <li class="bf-measure-distance">\n                '+BimfaceLanguage.bf_panel_measure_area+'：\n                  <span class="bf-measure-value">'+(w?w+m:"--")+'</span>\n                  <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n              </ul>',d=p[2],i.element.addClass("miniStyle")}c.innerHTML=o,c.querySelector(".gld-bf-reset-box").addEventListener("click",function(){n.reset()}),u.innerHTML="",u.appendChild(d.cloneNode(!0))},C=new e.Bimface.UI.Panel.PanelConfig;C.title=BimfaceLanguage.bf_btn_measure,C.id="MeaurePanel",C.className="bf-panel bf-measurement-panel",C.css=o?{right:"10px",bottom:"220px",width:"200px",height:"220px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.7em"};var B=function(e){var t={type:e.type},a=n.getMeasureParams();if("Distance"===e.type){var i=e.end[0]-e.start[0],o=e.end[1]-e.start[1],l=Math.sqrt(i*i+o*o);t.distance=r.formatDistance(l,a),t.distanceX=r.formatDistance(i,a),t.distanceY=r.formatDistance(o,a)}else"Angle"===e.type?t.angle=r.formatArea(e.angle,a):"Area"===e.type&&(t.area=r.formatArea(e.area,a));return t};if(C.enableSizable=!1,n.viewer.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Measuring,function(){y()}),n.viewer.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Measured,function(e){e?y(B(e)):y()}),n.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){if(e.isDataEmpty)return void y();var t=s.querySelectorAll(".bf-measure-tab-item"),a=!0,i=!1,o=void 0;try{for(var l,r=t[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var c=l.value;c.getAttribute("data-type")===e.type?c.addClass("bf-active"):c.removeClass("bf-active")}}catch(e){i=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}n.setMeasureType(e.type),y(B(e))}),n.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){y()}),n.addEventListener(e.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){y(),v(!0)}),i=new e.Bimface.UI.Panel.Panel(C),i.container.appendChild(l),i.container.appendChild(m),i.bringToFront(),!o){var w=a.offsetWidth,L=a.offsetHeight;i.element.style.fontSize=100*Math.min(w,L,414)/750+"px",i.element.addClass("measure-panel");i.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",i.element.appendChild(u)}return y(),i};n.DrawingMeasurePanel=a}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI.Panel"),n=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),a=function(t){var a=new e.Bimface.UI.Panel.PanelConfig,i=this,o=void 0;o="ViewerDrawingSet"==t.viewerType?t:t.getViewer(),this.viewer=o,this.status={print:o.getDisplayMode()},a.title=BimfaceLanguage.bf_btn_settings,a.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},a.id="Setting",a.enableSizable=!1,a.className="bf-panel bf-settings-panel";var l=new e.Bimface.UI.Panel.Panel(a),r=n.create("form","bf-setting"),s=n.create("div","bf-setting-foot"),c='<ul class="bf-setting-tab-default bf-show">\n\n        \n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_displayMode+'</span>\n          <div class="bf-setting-value printmode">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input normal" name=\'menu\' mode="普通模式" '+(0==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_normalMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="白底模式" '+(1==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_whiteBgMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="黑白模式" '+(2==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_monoBgMode+"</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n       ",d='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";r.innerHTML=c,s.innerHTML=d;for(var f=r.querySelectorAll(".printmode .bf-radio-input"),u=0,m=f.length;u<m;u++)!function(e,t){f[e].addEventListener("change",function(){var t=e;o.setDisplayMode(t)})}(u);return s.querySelector(".reset").addEventListener("click",function(){var e=void 0!=o._opt.defaultDisplayMode?o._opt.defaultDisplayMode:i.status.print;f[e].click()}),l.container.appendChild(r),l.container.appendChild(s),l};t.PrintModePanel=a}(),function(){var t=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application")),n=(e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Viewer"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility"),e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Web.Lang.Utility.Dom"),"Glodon.Bimface.Application.WebApplicationDrawingSet"),a=e.Bimface.Data.StatisticsDataManager.getInstance(),i=function(t){function i(){var i={eventId:"加载",loadModel:"normal",type:"DrawingSet"};if(a.send(n,"Loaded",i),c&&c._Toolbars&&c._Toolbars.length>0)for(var o=0,d=c._Toolbars.length;o<d;o++)c._Toolbars[o].destroy();var f,g,h,b,v,y,C={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:p,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:p,className:"bf-toolbar bf-toolbar-select"}},B={Home:{id:"Home",title:BimfaceLanguage.bf_btn_home,className:"bf-button gld-bf-home",handles:{Click:function(){s.getViewer().home()}}},Layers:{id:"Layers",title:BimfaceLanguage.bf_btn_layers,type:"ToggleButton",className:"bf-button gld-bf-layers",handles:{Click:function(){var t=L.getControl("Layers");t._checked?(t.setCheckedState(!0),f?f.show():(f=new e.Bimface.Application.UI.Panel.LayersSetPanel(l,t),r||f.element.addClass("layers-panel"),p.appendChild(f.element),s.addPanel(f))):(t.setCheckedState(!1),f.hide()),t.addEventListener(u.StateChange,function(e){e||f.hide()})}}},PrintMode:{id:"PrintMode",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var t=L.getControl("PrintMode");if(t._checked){if(y)return y.show();y=new e.Bimface.Application.UI.Panel.PrintModePanel(s.getActiveViewer()),y.addEventListener("Hide",function(){t.setCheckedState(!1),y.isShow&&y.hide()}),p.appendChild(y.element)}else y.toggle()}}},DrawingMeasure:{id:"DrawingMeasure",title:BimfaceLanguage.bf_btn_measure,type:"ToggleButton",className:"bf-button gld-bf-measure",handles:{Click:function(){var t=s.getActiveViewer();s.getViewer().getActiveDrawing();if(!h){var n=new e.Bimface.Plugins.Measure.MeasureConfig;n.viewer=t,h=new e.Bimface.Plugins.Measure.Measure(n)}var a=t.getDomElement(),i=L.getControl("DrawingMeasure");if(i._checked){i.setCheckedState(!0);var o=s.getViewer();h.addEventListener("typeChange",function(){s.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return e&&o.verify(e,t,n),!1}}),g=new e.Bimface.Application.UI.Panel.DrawingMeasurePanel(h,a),g.addEventListener("Hide",function(){i.setCheckedState(!1),h.switchOff(),t.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:!1})}),a.appendChild(g.element),h.switchOn(),s.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return o.verify(e,t,n),!1}}else i.setCheckedState(!1),a.removeChild(g.element),g=null,h.switchOff();t.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:i._checked}),i.addEventListener(u.StateChange,function(t){if(!t){h.setMeasureType(e.Bimface.Plugins.Measure.MeasureTypeOption.Distance);var n=s.getActiveViewer();n.getViewer().mouseEditorMgr.activeEditorByName("pick"),n.update(),g.hide()}})}}},RectZoom:{id:"RectZoom",title:BimfaceLanguage.bf_btn_zoom,type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=L.getControl("RectZoom"),t=!1;!e._checked&&t?(l.setNavigationMode("pick"),t=!1):(l.rectZoom(),t=!0,l.addEventListener(m.ViewZoomed,function(){e._checked&&t&&setTimeout(function(){e.setCheckedState(!1),l.isAlignment&&l.startMoving(!0)},200)})),e.addEventListener(u.StateChange,function(e){if(!e&&t){t=!1;var n=L.getControl("DrawingMeasure");n&&n._checked?l.setNavigationMode("measure"):l.isAlignment?l.startMoving(!0):l.setNavigationMode("pick")}})}}},Annotation:{id:"Annotation",title:"批注",className:"bf-button gld-bf-notes",handles:{Click:function(){var t=new e.Bimface.Plugins.Annotation.AnnotationToolbarConfig,n=s.getActiveViewer();t.viewer=n,b=s._annotation=new e.Bimface.Plugins.Annotation.AnnotationToolbar(t),v=e.Bimface.Plugins.Annotation.AnnotationToolbarEvent,L.hide();var a=L.getControl("Measure");a&&a.setCheckedState(!1);var i=L.getControl("DrawingMeasure");i._checked&&i.toggleCheckedState(),b.show(),b.addEventListener(v.Saved,function(){L.show(),n.setNavigationMode("pick")}),b.addEventListener(v.Cancelled,function(){L.show(),n.setNavigationMode("pick")})}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var t=this.hasClass("gld-bf-maximize");l.enableFullScreen(t),e.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=L.getControl("FullScreen");e.getTitle();e.toggleClassName("gld-bf-maximize"),e.toggleClassName("gld-bf-minimize"),t?e.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):e.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Setting:{id:"Setting",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var t=L.getControl("Setting");if(t._checked){if(y)return y.show();y=new e.Bimface.Application.UI.Panel.PrintModePanel(l),y.addEventListener("Hide",function(){t.setCheckedState(!1),y.isShow&&y.hide()}),p.appendChild(y.element)}else y.toggle()}}}};if(document.addEventListener("keydown",function(e){if(27==e.which){var t=L.getControl("DrawingMeasure"),n=L.getControl("RectZoom");t&&(g&&g.data?h.reset():t.setCheckedState(!1)),n&&n.setCheckedState(!1)}}),!t.Toolbars||0==t.Toolbars.length)return!1;for(var w=[],o=0,d=t.Toolbars.length;o<d;o++)w.push(C[t.Toolbars[o]]);c=new e.Bimface.Application.Toolbars(w);var L=c.getToolbar("MainToolbar");if(L){for(var M=[],o=0,d=t.Buttons.length;o<d;o++)M.push(B[t.Buttons[o]]);var T=new e.Bimface.Application.Buttons(M);L.addControls(T.getButtons())}var S=function(t){t&&x.removeControl("Views");var n=s.getActiveViewer(),a=n.getViews(),i={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){var t=void 0,a=void 0;g&&g.hide(),"Model"==e.id?(r||document.querySelector(".gld-bf-measure").setCss({display:"block"}),t=0):(r||document.querySelector(".gld-bf-measure").setCss({display:"none"}),t=e.id),a=s.getViewer().sets;for(var i=0;i<a.length;i++){a[i].viewerDrawing.showViewById(t)}n.update(!0),n.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"LeftSubToolbar"})}}};if(i.options.Model={type:"ComboBoxOptionButton",title:"Model",id:"model",className:"bf-button",html:'<span class="bf-button-name">Model</span>'},a.length)for(var o=0,l=a.length;o<l;o++){var c=a[o];i.options[c.name]={type:"ComboBoxOptionButton",title:c.name,id:c.id||"Model",className:"bf-button",html:'<span class="bf-button-name">'+c.name+"</span>"}}var i=new e.Bimface.Application.Buttons([i]),d=i.getButtons()[0],f=n.getCurrentViewId();n.addEventListener(m.ViewChanged,function(e){0===e&&(e="Model"),d.setSelectedControlById(e)}),x.addControls(i.getButtons()),f?(d._currentControl.setCheckedState(!1),d.setSelectedControlById(f)):d.setSelectedControlById("Model")},x=c.getToolbar("LeftSubToolbar");x&&(S(),l.addEventListener(m.ActiveViewChanged,S)),l.getManifest(function(e){var t=e.Features,n=void 0;(n=!t||t.HasLayout)||x&&x.destroy()}),l.addEventListener(m.ViewChanged,function(){var t=s.getPanel("layersSet");if(t){var n=L.getControl("Layers"),a=t.isShow;a&&t.hide(),t.destroy(),s.removePanel("layersSet"),a?n.setCheckedState(!0):n.setCheckedState(!1),f=new e.Bimface.Application.UI.Panel.LayersSetPanel(l,n),p.appendChild(f.element),s.addPanel(f),a||f.hide()}})}function o(t){var n=s.getActiveViewer();n.contextMenu&&n.contextMenu.element&&n.contextMenu.destroy();var a=t.clientPosition,i=t.containerBox,o=n.getSelectedIds(),l=new e.Bimface.Application.UI.Menu.ContextMenu(s,o),r={},c=l.element.getBoundingClientRect();i.width-a.x>2*c.width?(r.x=a.x,l.element.removeClass("bf-menu-left"),l.element.addClass("bf-menu-right")):(r.x=a.x-c.width,l.element.addClass("bf-menu-left"),l.element.removeClass("bf-menu-right")),i.height-a.y>c.height?r.y=a.y:r.y=a.y-c.height,r.x+=2,r.y+=2,l.setPosition(r),n.contextMenu=l}var l,r=e.Web.Lang.Utility.ClientHelper.getIsDesktop(),s=this,c=[],d=[],f=t,u=e.Bimface.UI.Control.ControlEvent,m=e.Bimface.Viewer.ViewerDrawingSetEvent;l=new e.Bimface.Viewer.ViewerDrawingSet(f);var p=l.getRootElement();l.addEventListener(m.Loaded,function(){i(),s._mainToolbarAdaptive(),window.addEventListener("resize",function(e){s._mainToolbarAdaptive()})}),l.addEventListener(m.ContextMenu,o),this.getViewer=function(){return l},this.getActiveViewer=function(){return l.getActiveDrawing().viewerDrawing},this.addDrawing=function(e,t,n){l.addDrawing(e,t,n)},this.addDrawings=function(e,t){l.addDrawings(e,t)},this.getRenderInfo=function(e,t){l.getRenderInfo(e,t)},this.getToolbars=function(){return c},this.getToolbar=function(e){return c.getToolbar(e)},this.addPanel=function(e){d.push(e)},this.removePanel=function(e){d.removeObjectByAttribute("id",e)},this.getPanel=function(e){return d.getObjectByAttribute("id",e)},this._mainToolbarAdaptive=function(){var e=s.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!s.getToolbar("MainToolbar")){var t=s.getToolbar("MainToolbar");l.getRootElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};t.WebApplicationDrawingSet=i}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application"),n=function(t,n){var a,i=new e.Bimface.Application.WebApplicationDrawingConfig;i.domElement=document.getElementById(n),i.domElementId=n,i.drawingUrl=t.drawingUrl;e.Bimface.Application.WebApplicationDrawingEvent;a=new e.Bimface.Application.WebApplicationDrawing(i),this._application=a};t.ApplicationDrawingDemo=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI"),n=function(){return{Toolbars:["MainToolbar","ModelTree"],Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"],contextMenu:!0,viewer:null,element:null}};t.UIConfig=n}(),function(){var t=e.Web.Lang.Utility.Namespace.ensureNamespace(e,"Bimface.Application.UI"),n=function(t){var n=this,a=t.viewer;this._toolbars=[],this._panels=[],this._plugins=[],this._opt=t,this._objectTypes={},this._contextMenuCb=function(t){a.contextMenu&&a.contextMenu.element&&a.contextMenu.destroy();var i=t.clientPosition,o=t.containerBox,l={};a.getModels().forEach(function(e){l[e.modelId]=e.getSelectedComponents()});var r=a._getExtrudeBodyModel();r&&(l[r.modelId]=r.getSelectedComponents());var s=a._getExternalComponentModel();s&&(l[s.modelId]=s.getSelectedComponents());var c=new e.Bimface.Application.UI.Menu.ContextMenu(n,l,n._objectTypes),d={},f=c.element.getBoundingClientRect();o.width-i.x>2*f.width?(d.x=i.x,c.element.removeClass("bf-menu-left"),c.element.addClass("bf-menu-right")):(d.x=i.x-f.width,c.element.addClass("bf-menu-left"),c.element.removeClass("bf-menu-right")),o.height-i.y>f.height?d.y=i.y:d.y=i.y-f.height,c.setPosition(d),a.contextMenu=c};var i={initialized:!1,menu:!0,hobby:!0,hover:!1,scroll:!1,backgroundColor:1,borderLine:!1,environment:"color",effect:"low",exposure:0,enableIBLBackground:!1,ambientLight:!1,IBLName:"none",SSAO:!1};i.setDefault=function(){var t=(a.getInformation(),a.getLoadIBLScene());i=Object.assign(i,{menu:a.isEnableToggleContextMenuDisplay(),hover:a.isEnableHover(),borderLine:a.isEnableBorderLine(),exposure:a.getExposureShift(),ambientLight:a.isEnableIBLBackground(),IBLName:t.IBLSceneOption,enableIBLBackground:t.withBackground}),e.Web.Lang.Utility.ClientHelper.getIsDesktop()&&!CLOUD.GlobalData.IncrementRender||a.setBorderLineEnabled(!1)},this.state=i};n.prototype={init:function(){if(this.state.initialized)return!1;var t=this,n=this._opt,a=n.viewer,i=a._data,o=n.Toolbars,l=a._manifest;if("ViewerDrawing"==a.viewerType){if(-1!=o.indexOf("MainToolbar")){var r=e.Bimface.UI.Toolbar.ToolbarConfig();r.id="MainToolbar",r.title="主菜单",r.className="bf-toolbar bf-toolbar-bottom",r.element=n.element,r.buttons=[].concat(_toConsumableArray(n.Buttons)),l.Features.HasSplitDrawing||r.buttons.removeByValue("Sheets"),this.addToolbar(r);var s=this.getToolbar("MainToolbar");document.addEventListener("keydown",function(e){if(27==e.which){var n=s.getControl("DrawingMeasure"),a=t.getPlugin("DrawingMeasure"),i=(t.getPanel("MeaurePanel"),s.getControl("RectZoom"));if(a&&n.isChecked()){var o=a.viewerDrawing.mouseEditorMgr.getEditor();1==o.points.length?a.drawableManager.setIsEnableSelection(!0):0==o.points.length&&n.setCheckedState(!1)}i&&i.setCheckedState(!1)}},!0)}if(-1!=o.indexOf("LeftSubToolbar")&&l.Features.HasLayout){var d=e.Bimface.UI.Toolbar.ToolbarConfig();d.id="LeftSubToolbar",d.title="LeftSubToolbar",d.className="bf-toolbar bf-toolbar-select",d.element=n.element,d.buttons=["LayoutList"],this.addToolbar(d)}if(l.Features.HasText&&-1!=o.indexOf("SearchToolbar")){var f=e.Bimface.UI.Toolbar.ToolbarConfig();f.id="SearchToolbar",f.title="",f.className="bf-toolbar bf-toolbar-search",f.element=n.element,f.buttons=[],this.addToolbar(f);var u=this.getToolbar("SearchToolbar"),m=new e.Bimface.Plugins.Search.SearchConfig;m.wrapElement=u.element,m.viewer=a;var g=new e.Bimface.Plugins.Search.Search(m);this.addPlugin(g)}}else{var h,b=l.Features.HasComponentStructure||l.Features.HasFileList||l.Features.HasLinkRelation||l.Features.HasRoom||l.Features.HasArea||l.Features.HasDrawing||l.Features.HasMEPSystem||l.Features.HasGroup||l.Features.HasAssemble;if(l.Metadata.filetype){var v=l.Metadata.FileType;h="rfa"!=v&&"stp"!=v&&"step"!=v}else h=!i.workerType||-1==i.workerType.indexOf("rfa-")&&-1==i.workerType.indexOf("stp-")&&-1==i.workerType.indexOf("step-");if(-1!=o.indexOf("MainToolbar")){var r=e.Bimface.UI.Toolbar.ToolbarConfig();r.id="MainToolbar",r.title="主菜单",r.className="bf-toolbar bf-toolbar-bottom",r.element=n.element,r.buttons=[].concat(_toConsumableArray(n.Buttons)),l.Features.HasComponentProperty||(r.buttons.removeByValue("Property"),r.buttons.removeByValue("MobileProperty")),l.Features.HasMiniMap||r.buttons.removeByValue("Map"),h||r.buttons.removeByValue("Walk"),this.addToolbar(r)}if(b&&-1!=o.indexOf("ModelTree")&&!t._modelTree){var y=e.Bimface.UI.Toolbar.ToolbarConfig();y.id="ModelTree",y.title="目录树",y.className="bf-toolbar bf-toolbar bf-tree-toolbar",y.element=n.element,y.buttons=["ModelTree"],this.addToolbar(y)}if(l.Features.HasFamilyTypeList&&n.EnableFamilyList){var C=e.Bimface.UI.Toolbar.ToolbarConfig();C.id="FamilyTypes",C.title="FamilyTypes",C.className="bf-toolbar bf-toolbar bf-toolbar-select",C.element=n.element,C.buttons=["FamilyList"],this.addToolbar(C)}n.contextMenu&&(a.addEventListener(e.Bimface.Viewer.Viewer3DEvent.ContextMenu,t._contextMenuCb),a.addEventListener(e.Bimface.Viewer.Viewer3DEvent.ComponentsSelectionChanged,function(e){e.objectId&&(t._objectTypes[e.objectId]=e.objectType)})),this.onKeyUp=function(e){if(e&&27==e.keyCode&&!CLOUD.EditorConfig.NoKey){var n=t.getToolbar("MainToolbar"),i=n.getControl("RectangleSelect"),o=n.getControl("Measure"),l=p(t),r=n.getControl("Walk");if(i&&i.isChecked())i.setCheckedState(!1);else if(o&&o.isChecked()){var s=t.getPlugin("Measure");s&&s.getInfo().points.length>0?(s.redo(),0==s.getInfo().points.length&&s.drawableManager.setIsEnableSelection(!0)):o.setCheckedState(!1)}else l.enable?c(t):r&&r.isChecked()&&r.setCheckedState(!1);a.render()}},document.addEventListener("keyup",this.onKeyUp),t.state.setDefault(),t.state.initialized=!0}},addToolbar:function(t){var n=this,a=e.Bimface.Application.UI.Toolbar.Toolbar(t,n);this._toolbars.push(a)},removeToolbar:function(e){return this._toolbars.removeObjectByAttribute("id",e),[].concat(_toConsumableArray(this._toolbars))},getToolbar:function(e){return this._toolbars.getObjectByAttribute("id",e)},getToolbars:function(){return[].concat(_toConsumableArray(this._toolbars))},getViewer:function(){return this._opt.viewer},getRootElement:function(){return this._opt.element},addPanel:function(e){this._panels.push(e)},removePanel:function(e){this._panels.removeObjectByAttribute("id",e)},getPanel:function(e){return this._panels.getObjectByAttribute("id",e)},getPanels:function(e){return[].concat(_toConsumableArray(this._panels))},addPlugin:function(e){this._plugins.push(e)},removePlugin:function(e){this._plugins.removeObjectByAttribute("id",e)},getPlugin:function(e){return this._plugins.getObjectByAttribute("id",e)},getPlugins:function(e){return[].concat(_toConsumableArray(this._plugins))},destroy:function(){"ViewerDrawing"==this._opt.viewer.viewerType||(document.removeEventListener("keyup",this.onKeyUp),this._opt.viewer.removeEventListener(e.Bimface.Viewer.Viewer3DEvent.ContextMenu,this._contextMenuCb));for(var t=0;t<this._toolbars.length;t++)this._toolbars[t].destroy();for(var n=0;n<this._panels.length;n++)this._panels[n].destroy();for(var a=0;a<this._plugins.length;a++)this._plugins[a].exit();this._toolbars=[],this._panels=[],this._plugins=[],this.state.initialized=!1,this._opt.viewer.render&&this._opt.viewer.render(),this._opt=null},updateModelTree:function(){var t=this,n=this._opt,a=n.viewer,i=a._manifest,o=i.Features.HasComponentStructure||i.Features.HasFileList||i.Features.HasLinkRelation||i.Features.HasRoom||i.Features.HasArea||i.Features.HasDrawing||i.Features.HasMEPSystem||i.Features.HasGroup||i.Features.HasAssemble,l=t.getPanel("ModelTree"),r=t.getToolbar("ModelTree");if(l){var s=l.isShow;if(s&&l.hide(),l.destroy(),t.removePanel("ModelTree"),s){r.hide();var c=new e.Bimface.Application.UI.Panel.ModelTreePanel(t,r);t.getRootElement().appendChild(c.element),t.addPanel(c)}}if(!o&&r)r.destroy(),t.removeToolbar("ModelTree");else if(o&&!r){var d=e.Bimface.UI.Toolbar.ToolbarConfig();d.id="ModelTree",d.title="目录树",d.className="bf-toolbar bf-toolbar bf-tree-toolbar",d.element=n.element,d.buttons=["ModelTree"],t.addToolbar(d)}}},t.UI=n}()}();